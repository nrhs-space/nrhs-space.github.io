<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>朝花夕拾</title>
  
  <subtitle>理想现实主义者</subtitle>
  <link href="https://nrhs-space.github.io/atom.xml" rel="self"/>
  
  <link href="https://nrhs-space.github.io/"/>
  <updated>2023-08-01T10:55:19.380Z</updated>
  <id>https://nrhs-space.github.io/</id>
  
  <author>
    <name>不旦枕戈</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>亲爱的花</title>
    <link href="https://nrhs-space.github.io/2023/06/30/Graduation/"/>
    <id>https://nrhs-space.github.io/2023/06/30/Graduation/</id>
    <published>2023-06-30T15:59:59.000Z</published>
    <updated>2023-08-01T10:55:19.380Z</updated>
    
    <content type="html"><![CDATA[<p>亲爱的花：<br>我已经收到了你的来信。谢谢你当年没有选择10年，不然我的毕业季将无从怀念。</p><p>正如你5年前所预见，未来的日子并不平坦，甚至可以说，有些坎坷。不过好的是，都会过去。常说记忆是黑白的胶卷，色彩需要靠自己想象。我已经很久没有想起你提到的人，忽有故人心上过，回首山河已是秋。是啊，太遥远了。自由的风不会为街道停留，而街道也不能追随风的脚步。生命中出现的很多人就像风一样，来了又走… 也正是因为离开的人越来越多，所以留下来的人弥足珍贵。</p><p>在未来，你遇到了更多形形色色的人与事。无论是痛彻心扉，还是欣喜若狂，都使你受益良多。你当年的选择，没有对错，不要害怕。即使曾经无数次感到失落顿挫，但也在无数时刻欣慰庆幸。无论如何，你还是从中找到了为之努力的方向。</p><p>今天你大学毕业，很仓促的离别。很多时候，你已经丧失了热泪盈眶的感受，也不必煽情。如果生活是一场连续剧，那么一切都是时间发展顺序。</p><p>该为5年后写些什么呢。我已经不再担忧你懊恼停滞，也不担心你遇不到风雨。暴风雨不会停歇，在人生的很多阶段没有里程碑，没有相拥着告别，也缺少动人的情节。一觉醒来不会豁然开朗，越过一道坎也不会柳暗花明。你要在暴风雨中起舞。</p><p>回忆是一座深渊，不能久陷。我也真诚的祝愿你，下一个五年能够和我坦然相面。</p><p>To:2028.6<br>From:2023.6.30晚</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic.imgdb.cn/item/64c8e3d71ddac507cc1a8540.jpg.jpg"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic.imgdb.cn/item/64c8e3d51ddac507cc1a81df.jpg"/></div></div><div class="img-wrap"><div class="img-bg"><img class="img" src="https://pic.imgdb.cn/item/64c8e3ee1ddac507cc1ab1c2.png"/></div></div>]]></content>
    
    
    <summary type="html">我已经收到了你的来信。谢谢你当年没有选择10年，不然我的毕业季将无从怀念。</summary>
    
    
    
    <category term="朝花夕拾" scheme="https://nrhs-space.github.io/categories/%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/"/>
    
    
    <category term="朝花夕拾" scheme="https://nrhs-space.github.io/tags/%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/"/>
    
    <category term="大学" scheme="https://nrhs-space.github.io/tags/%E5%A4%A7%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>Always with me</title>
    <link href="https://nrhs-space.github.io/2023/06/01/Always_with_me/"/>
    <id>https://nrhs-space.github.io/2023/06/01/Always_with_me/</id>
    <published>2023-06-01T13:14:05.000Z</published>
    <updated>2023-08-02T11:15:56.589Z</updated>
    
    <content type="html"><![CDATA[<p>“所有的成长，到最后都是一次旅行”</p><p>即使时隔多年，我也还记得宫崎骏先生的这句话。他的作品永远带给我难以语述的感悟。</p><p>每个人都会在《千与千寻》中找到共鸣，无论是爱情，友情还是亲情。我们每一个人都在这一趟旅途中从迷惘懦弱走向勇敢与独立。</p><p>第一次看《千与千寻》是在高中的地理课上。尽管我在高中之后我无数次后悔选择文科，但我仍然庆幸我在高中所遇到的地理老师。她是一个极温柔的女孩子，她在无形中塑造了我整个人生。那天下午阳光透过窗玻璃在黑板上投下长长的矩阵，把她的名字用金光圈了起来，她叫向往，是我见过最诗意的名字……</p><p>在一年前我就弹完了这首曲子。这首曲子如此轻快欢乐，应该带给人无限的爱与希望，但它却是我弹过最为曲折的曲子。我弹了它三次，但每次都会遇到离别与失散。在我弹《The truth that you leave》时，是欢聚；在《Always with me》时，却是离别。</p><p>在没有动态的日子，大家都在各自真实的战场上打怪。从实习以来，我总疑心我的生活陷入了无端的忙碌，我总是忙碌着完成一个又一个的人生打卡点。我很想做点什么，来告慰这一年来的时光，于是终于还是决定，弹完它。</p><p>回忆是一所深渊，不能久陷。爱而不得与怅然若失本就是人生常态。既然相遇是来自于时光的馈赠，那么离别时也一定要微笑着，回忆放心中。</p><div class="video"><video controls preload><source src='http://dpv.videocc.net/6358b82195/f/6358b8219574a7f0d6defe480d6e860f_3.mp4?pid=1690974928464X1688875' type='video/mp4'>Your browser does not support the video tag.</video></div>]]></content>
    
    
    <summary type="html">“所有的成长，到最后都是一次旅行”</summary>
    
    
    
    <category term="吉他" scheme="https://nrhs-space.github.io/categories/%E5%90%89%E4%BB%96/"/>
    
    
    <category term="吉他" scheme="https://nrhs-space.github.io/tags/%E5%90%89%E4%BB%96/"/>
    
    <category term="音乐" scheme="https://nrhs-space.github.io/tags/%E9%9F%B3%E4%B9%90/"/>
    
  </entry>
  
  <entry>
    <title>基于GPS的坐标路径分析系统[待更新]</title>
    <link href="https://nrhs-space.github.io/2022/12/16/local_analyse/"/>
    <id>https://nrhs-space.github.io/2022/12/16/local_analyse/</id>
    <published>2022-12-16T07:05:02.000Z</published>
    <updated>2023-09-19T09:28:59.519Z</updated>
    
    <content type="html"><![CDATA[<h1 id="序"><a href="#序" class="headerlink" title="序"></a>序</h1><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><div class="note primary modern"><p>首先，当然是一部手机啦。安卓版本不应该低于<code>5.0</code>，<code>Termux</code>最新已不支持安卓<code>7.0</code>以下，但Termux <code>73</code>版本前仍然支持安卓<code>5.0</code>。再低，可能兼容性异常。</p></div><p class='p gray'>对于其他配置无关紧要，GPS模块正常即可。同时你得祈祷你的手机厂商不作妖，搞些奇奇怪怪的安全限制</p><div class="note primary modern"><p>一张手机卡/物联卡。野外是不可能有WIFI的，怎么能想着无线网络呢？</p></div><div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><p>一颗聪明好奇的小脑瓜</p></div><h1 id="部署代码"><a href="#部署代码" class="headerlink" title="部署代码"></a>部署代码</h1><div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><p>先试试一键部署</p></div><div class="tip info"><p>你应该明白，这个项目覆盖大量自定义参数。精度要求较高，几乎是没有任何现成的数据源。<br>所谓的“一键部署”，也仅是安装部署源码。所有参数均需自定义。你仍然需要完整的阅读本篇文档，否则，不出意外的话，你的程序是跑不起来的。</p></div><div class="tag link"><a class="link-card" title="Tar恢复包下载" href="https://www.123pan.com/s/DoD8Vv-pm0eh.html"><div class="left"><img src="https://pic.imgdb.cn/item/63bd61cbbe43e0d30e088c6f.png"/></div><div class="right"><p class="text">Tar恢复包下载</p><p class="url">https://www.123pan.com/s/DoD8Vv-pm0eh.html</p></div></a></div><div class="tag link"><a class="link-card" title="核心框架源码预览" href="https://www.aliyundrive.com/s/gykhKbWm7Vs"><div class="left"><img src="https://pic.imgdb.cn/item/63bd61cbbe43e0d30e088c6f.png"/></div><div class="right"><p class="text">核心框架源码预览</p><p class="url">https://www.aliyundrive.com/s/gykhKbWm7Vs</p></div></a></div><ul><li>给予termux获取存储空间的权限</li><li>部署（还原代码）</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">termux-setup-storage  # 如果没有得到权限，再次申请</span><br><span class="line"></span><br><span class="line">cd /data/data/com.termux/files  # 进入虚拟容器文件目录</span><br><span class="line"></span><br><span class="line">tar -zxf 下载源码包绝对路径.tar.gz --recursive-unlink --preserve-permissions  # 还原文件压缩包</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果未修改文件名称且文件在根目录下，则为：</span></span><br><span class="line"></span><br><span class="line">tar -zxf /sdcard/termux-backup.tar.gz --recursive-unlink --preserve-permissions</span><br></pre></td></tr></table></figure><ul><li>重启Termux，查看是否输出:</li></ul><hr><h1 id="一些小细节"><a href="#一些小细节" class="headerlink" title="一些小细节"></a>一些小细节</h1><div class="tip "><p>在开始之前，你应该完整的阅读国光对Termux的 <a href="https://www.sqlsec.com/tags/Termux/">完整概述及基础教程</a></p></div><h2 id="核心Python环境"><a href="#核心Python环境" class="headerlink" title="核心Python环境"></a>核心Python环境</h2><h3 id="Start开始启动"><a href="#Start开始启动" class="headerlink" title="Start开始启动"></a>Start开始启动</h3><p><code>Start.py</code>是程序每天启动的入口函数。它将自动创建数据表，请求数据，开启所有服务并检测。</p><p>在<code>.zshrc</code>文件中，启动窗口将自动运行本文件。</p><p><img src="https://pic.imgdb.cn/item/64fb3d6a661c6c8e54c35819.jpg" alt=""></p><p class='p gray'>启动窗口将会锁定CPU，运行start.py文件，检验SSH是否开启</p><details class="folding-tag" cyan><summary> 查看Start.py </summary>              <div class='content'>              <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 文件函数导入</span></span><br><span class="line"><span class="keyword">from</span> inspect <span class="keyword">import</span> config_sql, check_complate, config_updata, today_tables, creat_sql  </span><br><span class="line"><span class="keyword">from</span> send_message <span class="keyword">import</span> push_message</span><br><span class="line"><span class="keyword">from</span> location <span class="keyword">import</span> get_and_updata</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weather</span>():  <span class="comment"># 获取一次天气信息,api参照https://lbs.amap.com/api/webservice/guide/api/weatherinfo</span></span><br><span class="line">    url = <span class="string">&quot;https://restapi.amap.com/v3/weather/weatherInfo?city=城市代码&amp;key=JSapi Key&quot;</span></span><br><span class="line">    weather = json.loads(requests.get(url).text)</span><br><span class="line">    state = weather[<span class="string">&quot;info&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> state == <span class="string">&quot;OK&quot;</span>:</span><br><span class="line">        city = weather[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;city&quot;</span>]</span><br><span class="line">        wea = weather[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;weather&quot;</span>]</span><br><span class="line">        temperature = weather[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;temperature&quot;</span>]</span><br><span class="line">        winddirection = weather[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;winddirection&quot;</span>]</span><br><span class="line">        windpower = weather[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;windpower&quot;</span>]</span><br><span class="line">        humidity = weather[<span class="string">&quot;lives&quot;</span>][<span class="number">0</span>][<span class="string">&quot;humidity&quot;</span>]</span><br><span class="line">        <span class="comment"># reporttime=weather[&quot;lives&quot;][0][&quot;reporttime&quot;]</span></span><br><span class="line">        <span class="comment"># print(state, city, wea, temperature, winddirection, windpower, humidity)</span></span><br><span class="line">        <span class="comment"># data = city + &quot;&amp;&quot; + wea + &quot;&amp;&quot; + temperature + &quot;&amp;&quot; + winddirection + &quot;&amp;&quot; + windpower + &quot;&amp;&quot; + humidity</span></span><br><span class="line">        data = <span class="string">&quot;今天&#123;&#125;&#123;&#125;天，气温:&#123;&#125;℃，&#123;&#125;风，风力&#123;&#125;级，能见度&#123;&#125;。&quot;</span>.<span class="built_in">format</span>(city, wea, temperature, winddirection, windpower, humidity)</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> config_sql(<span class="string">&quot;start&quot;</span>) == <span class="string">&quot;false&quot;</span>:  <span class="comment"># 获取本地数据库中服务是否已开启</span></span><br><span class="line">    <span class="comment"># 状态未开放时</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;服务正在启动...&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> today_tables() != <span class="string">&quot;OK&quot;</span>:  <span class="comment"># 数据库中无今日表时自动创建</span></span><br><span class="line">        creat_sql()</span><br><span class="line">    check_complate()  <span class="comment"># 完整性检验</span></span><br><span class="line">    get_and_updata(<span class="number">0.01</span>)  <span class="comment"># 初始化,更新一次位置，并设置初始Risk=0.01(此处0.01为初始化，除外不应该带值)</span></span><br><span class="line">    config_updata(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;true&quot;</span>)  <span class="comment"># 更新状态</span></span><br><span class="line">    push_message.main(<span class="string">&quot;start&quot;</span>, <span class="string">&quot;服务已成功开启！\n\n你可以打开APP开始实时查看位置!&amp;\n\n&#123;&#125;&quot;</span>.<span class="built_in">format</span>(get_weather()), <span class="string">&quot;all&quot;</span>)</span><br><span class="line"><span class="comment"># 推送信息</span></span><br></pre></td></tr></table></figure>              </div>            </details><h3 id="Inspect自检程序"><a href="#Inspect自检程序" class="headerlink" title="Inspect自检程序"></a>Inspect自检程序</h3><div class="note primary no-icon flat"><p>此文件主要包含自检的函数，逻辑关系</p></div><p>在执行该py文件时，会检测Apache服务状态，以及Frpc穿透。</p><p>默认使用的是免费的<a href="https://www.afrps.cn/">frpc服务器</a>，有时候服务会存在不稳定。</p><p>所以在自检穿透失败，重启仍然失败时。将使用<a href="https://www.cpolar.com/">cpolar</a>穿透SSH登陆服务，并微信测试号提示。</p><p><img src="https://pic.imgdb.cn/item/64fb3d6a661c6c8e54c35820.jpg" alt="远程SSH"></p><h3 id="Location定位服务"><a href="#Location定位服务" class="headerlink" title="Location定位服务"></a>Location定位服务</h3><div class="note primary no-icon flat"><p>此文件为定位主文件，由Cron自动任务控制执行。在内部，将自动判断是否执行定位。</p></div><p>该文件有两种工作方式，备注模式与记录模式。</p><p>备注模式是在绘制地图边界时使用，将对该位置定位多次，求平均值。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># location.py -i 100 10 循环记录100次，每次间隔10秒。 记录某一个地点，可以定位10次求平均值</span></span><br></pre></td></tr></table></figure><p>记录模式是正常工作状态下，由风控Risk决定是否定位执行，将定位记录，并计算风险。</p><h3 id="GetRisk风险判断"><a href="#GetRisk风险判断" class="headerlink" title="GetRisk风险判断"></a>GetRisk风险判断</h3><div class="note primary no-icon flat"><p>风险计算核心</p></div><p>首先读取数据库，判断(射线法)本次定位点是否在<code>风险预警区域</code>内，如果在，将直接微信报警。</p><p><img src="https://pic.imgdb.cn/item/64fb3d6a661c6c8e54c35846.jpg" alt="求阈值"></p><p>若不在预警预期内，计算本次位置与上次位置相隔距离，以及对风险区域相隔距离。再综合判断电量，时间等因素。计算风险阈值，作为下一次定位时间的依据。</p><p><img src="https://pic.imgdb.cn/item/64fb3d6a661c6c8e54c35835.jpg" alt="风险阈值"></p><p>在距离500m以上时，风险将被视为极小。提醒距离由客户端设置。</p><h3 id="SeedMessage微信提醒"><a href="#SeedMessage微信提醒" class="headerlink" title="SeedMessage微信提醒"></a>SeedMessage微信提醒</h3><blockquote><p>基于微信测试号实现</p></blockquote><p>限制: 不能更改名字，消息无法展示在聊天列表。被收录为订阅号中，但是能添加星标，使其通知栏提示消息。</p><p><a href="https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login">微信测试号地址</a></p><p>SeedMessage文件已经封装，在其中配置APPID(测试号账户)，APPSECRET(密钥)，TEMPLATE_ID(模板ID)</p><p><img src="https://pic.imgdb.cn/item/64fb3d6a661c6c8e54c3580b.jpg" alt="测试号"></p><p>在我封的脚本中，需要配置多个模板ID，以满足不同的通知提醒要求</p><p><img src="https://pic.imgdb.cn/item/64fb3dab661c6c8e54c36195.jpg" alt="模板ID"></p><p>同时支持配置多个用户ID</p><p><img src="https://pic.imgdb.cn/item/64fb3dab661c6c8e54c361a9.jpg" alt="用户ID"></p><p>在调用时，写法如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">push_message.main(<span class="string">&quot;ssh&quot;</span>, <span class="string">&quot;远程访问服务开启&amp;出于未知原因错误，服务异常，等待远程处理......&quot;</span>, <span class="string">&quot;all&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://pic.imgdb.cn/item/64fb3dab661c6c8e54c361ba.jpg" alt="多模板ID"></p><p>其中<code>SSH</code>为选择的通知模板，消息通知解析格式为”<code>标题&amp;内容</code>“，<code>all</code>表示通知列表中所有用户。可以改为特定用户的<code>ID</code>。</p><h4 id="Server酱"><a href="#Server酱" class="headerlink" title="Server酱"></a>Server酱</h4><blockquote><p>聊天列表可见，免费版本调用上限5次/日</p></blockquote><p><a href="https://sct.ftqq.com/">参考Server文档</a></p><h3 id="Downline服务下线"><a href="#Downline服务下线" class="headerlink" title="Downline服务下线"></a>Downline服务下线</h3><p>通俗易懂，下线服务。</p><hr><h2 id="前端Web与PHP服务"><a href="#前端Web与PHP服务" class="headerlink" title="前端Web与PHP服务"></a>前端Web与PHP服务</h2><div class="note primary modern"><p>前端地图由<a href="https://lbs.amap.com/">高德地图开发平台</a>完成，在此之前，你应该对<a href="https://lbs.amap.com/demo/list/jsapi-v2">高德JS API 2.0示例</a>，以及<a href="https://lbs.amap.com/api/jsapi-v2/summary/">基础开发文档</a>有了解</p></div><div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><p>PHP服务由Apache2构建；不推荐在Termux上使用Nginx，因为我没run起来，奇奇怪怪的问题有点多。</p></div><div class="note primary flat"><p>Apache2及相关PHP安装参照<a href="https://www.sqlsec.com/2018/05/termux.html#Apache">国光的安装文档</a></p></div><h3 id="基础地图绘制-JS"><a href="#基础地图绘制-JS" class="headerlink" title="基础地图绘制-JS"></a>基础地图绘制-JS</h3><h3 id="3D立体模型-JS"><a href="#3D立体模型-JS" class="headerlink" title="3D立体模型-JS"></a>3D立体模型-JS</h3><h3 id="路径-折线-绘制-JS"><a href="#路径-折线-绘制-JS" class="headerlink" title="路径(折线)绘制-JS"></a>路径(折线)绘制-JS</h3><h3 id="风险区域绘制-PHP"><a href="#风险区域绘制-PHP" class="headerlink" title="风险区域绘制-PHP"></a>风险区域绘制-PHP</h3><h3 id="风险区域控制-PHP"><a href="#风险区域控制-PHP" class="headerlink" title="风险区域控制-PHP"></a>风险区域控制-PHP</h3><h3 id="标记点-图标-JS"><a href="#标记点-图标-JS" class="headerlink" title="标记点(图标)-JS"></a>标记点(图标)-JS</h3><h3 id="即时位置展示-PHP"><a href="#即时位置展示-PHP" class="headerlink" title="即时位置展示-PHP"></a>即时位置展示-PHP</h3><h3 id="TermuxAPI构建-PHP"><a href="#TermuxAPI构建-PHP" class="headerlink" title="TermuxAPI构建-PHP"></a>TermuxAPI构建-PHP</h3><h3 id="加密方法-SHA256-PHP"><a href="#加密方法-SHA256-PHP" class="headerlink" title="加密方法(SHA256)-PHP"></a>加密方法(SHA256)-PHP</h3><h3 id="Device设备信息-PHP"><a href="#Device设备信息-PHP" class="headerlink" title="Device设备信息-PHP"></a>Device设备信息-PHP</h3><hr><h2 id="内网Frpc穿透服务"><a href="#内网Frpc穿透服务" class="headerlink" title="内网Frpc穿透服务"></a>内网Frpc穿透服务</h2><h3 id="普通80穿透"><a href="#普通80穿透" class="headerlink" title="普通80穿透"></a>普通80穿透</h3><h3 id="异常SSH穿透"><a href="#异常SSH穿透" class="headerlink" title="异常SSH穿透"></a>异常SSH穿透</h3><hr><h2 id="手机APP控制操作"><a href="#手机APP控制操作" class="headerlink" title="手机APP控制操作"></a>手机APP控制操作</h2><h3 id="浏览器基础"><a href="#浏览器基础" class="headerlink" title="浏览器基础"></a>浏览器基础</h3><h3 id="API调用模板"><a href="#API调用模板" class="headerlink" title="API调用模板"></a>API调用模板</h3><hr><h2 id="基础Termux服务"><a href="#基础Termux服务" class="headerlink" title="基础Termux服务"></a>基础Termux服务</h2><h3 id="cron定时任务执行"><a href="#cron定时任务执行" class="headerlink" title="cron定时任务执行"></a>cron定时任务执行</h3><blockquote><p>由于安卓中特殊的环境，无法通过linux自带的crontab等工具直接实现定时任务</p></blockquote><p>对于此，官方解决办法是Termux:tasker+Tasker实现，即通过第三方软件执行定时任务，拉起termux，执行脚本</p><p>但是我觉得此办法比较臃肿，最重要的是，Tasker并不免费。</p><p>高德地图在关于后台定位中，通过在cpu休眠前点亮屏幕。使得CPU不能休眠，后台存活，但这办法比较耗电，不优雅。</p><p>Termux有CPU唤醒锁的设置，首先在系统设置中，把Termux能开的都开上，例如后台不限制，电源不限制…..</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">termux-wake-lock 锁定CPU唤醒</span><br><span class="line"></span><br><span class="line">termux-wake-unlock 解锁CPU唤醒</span><br></pre></td></tr></table></figure><p>使用<a href="https://www.cnblogs.com/gdjlc/p/11432526.html">APScheduler</a>python任务管理器，实现定时执行</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> apscheduler.schedulers.blocking <span class="keyword">import</span> BlockingScheduler</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">job</span>(<span class="params">text</span>):</span><br><span class="line">    t = time.strftime(<span class="string">&#x27;%Y-%m-%d %H:%M:%S&#x27;</span>, time.localtime(time.time()))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125; --- &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(text, t))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">scheduler = BlockingScheduler()</span><br><span class="line"><span class="comment"># 每隔 1分钟 运行一次 job 方法</span></span><br><span class="line">scheduler.add_job(job, <span class="string">&#x27;interval&#x27;</span>, minutes=<span class="number">1</span>, args=[<span class="string">&#x27;job1&#x27;</span>])</span><br><span class="line">scheduler.start()</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">要替换已删除的配置文件而不清除软件包，您可以执行以下操作：</span><br><span class="line"></span><br><span class="line">sudo apt-get -o DPkg::Options::=&quot;--force-confmiss&quot; --reinstall install apache2</span><br><span class="line">要完全删除apache2配置文件，您应该</span><br><span class="line"></span><br><span class="line">sudo apt-get purge apache2</span><br><span class="line">然后，您可以按照通常的方式重新安装</span><br><span class="line"></span><br><span class="line">sudo apt-get install apache2</span><br><span class="line">需要清除才能删除所有配置文件-如果删除配置文件但仅删除软件包，则将记住此信息，默认情况下不会重新安装丢失的配置文件。</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Termux-server服务管理"><a href="#Termux-server服务管理" class="headerlink" title="Termux-server服务管理"></a>Termux-server服务管理</h3><hr><h1 id="启动服务"><a href="#启动服务" class="headerlink" title="启动服务"></a>启动服务</h1><h1 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h1>]]></content>
    
    
    <summary type="html">什么？旧手机一直在吃灰？换盆又觉得亏？为什么不试试花师傅倾力打造的“自动化放牛系统”呢。</summary>
    
    
    
    <category term="自动化" scheme="https://nrhs-space.github.io/categories/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    
    <category term="Python" scheme="https://nrhs-space.github.io/tags/Python/"/>
    
    <category term="linux" scheme="https://nrhs-space.github.io/tags/linux/"/>
    
    <category term="Termux" scheme="https://nrhs-space.github.io/tags/Termux/"/>
    
    <category term="PHP" scheme="https://nrhs-space.github.io/tags/PHP/"/>
    
    <category term="地图" scheme="https://nrhs-space.github.io/tags/%E5%9C%B0%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>NovelAI——AI绘图+QQ机器人</title>
    <link href="https://nrhs-space.github.io/2022/11/26/AI_piant/"/>
    <id>https://nrhs-space.github.io/2022/11/26/AI_piant/</id>
    <published>2022-11-26T10:18:47.000Z</published>
    <updated>2023-04-15T13:45:25.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NovelAi安装"><a href="#NovelAi安装" class="headerlink" title="NovelAi安装"></a>NovelAi安装</h1><blockquote><p>NovelAI下载压缩包，启动就行。它自带前后端，本地输入标签就可AI绘图，不再赘述</p></blockquote><div class="tag link"><a class="link-card" title="原部署教程" href="https://rentry.org/sdg_FAQ#naifu-novelai-model-backend-frontend"><div class="left"><img src="https://s1.ax1x.com/2022/11/27/zNj7DS.png"/></div><div class="right"><p class="text">原部署教程</p><p class="url">https://rentry.org/sdg_FAQ#naifu-novelai-model-backend-frontend</p></div></a></div><p>值得一提的是，使用<a href="https://tags.novelai.dev/">标签超市</a>里面的标签画出来的图片更优雅。</p><p>可参考此<a href="https://www.iculture.cc/knowledge/pig=27083">文档</a>。</p><div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><ol><li>需要使用python3.8及以上</li><li>电脑太差不行，显存4G以上</li></ol></div><h1 id="QQ机器人"><a href="#QQ机器人" class="headerlink" title="QQ机器人"></a>QQ机器人</h1><blockquote><p>QQ机器人框架极多，例如小栗子等等</p></blockquote><p>但由于我注册不上小栗子，而且好像这个框架需要付费，所以我不再折腾它了</p><p>由于我们想实现的仅仅只是几个关键词读取，推送回去几条消息而已，我们自己写完全可以实现</p><p><code>Go-cqhttp</code>可以模拟登陆一个<code>QQ手表版</code>，以此实现读取所有的QQ消息，并可以通过CQ码等发送消息出去。</p><div class="btns circle grid3">            <a class="button" href='https://docs.go-cqhttp.org/' title='官方文档'><img src='https://s1.ax1x.com/2022/11/27/zNj7DS.png'>官方文档</a><a class="button" href='https://github.com/Mrs4s/go-cqhttp/releases' title='GitHub项目'><img src='https://s1.ax1x.com/2022/11/27/zNj7DS.png'>GitHub项目</a><a class="button" href='https://docs.go-cqhttp.org/guide/quick_start.html#%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B' title='快速开始'><img src='https://s1.ax1x.com/2022/11/27/zNj7DS.png'>快速开始</a>          </div><h2 id="安装-树莓派"><a href="#安装-树莓派" class="headerlink" title="安装(树莓派)"></a>安装(树莓派)</h2><div class="note primary modern"><p>版本很多，请一定下载符合自己系统的版本</p></div><p>在<a href="https://github.com/Mrs4s/go-cqhttp/releases">release</a>中下载符合自己系统版本的包</p><p><code>GO-cqhttp</code>部分系统支持一键运行，但树莓派不支持，所以我下载了符合树莓派系统的<code>linux-armV7</code></p><p><img src="https://s1.ax1x.com/2022/11/27/zNjCtA.jpg" alt=""></p><p>下载完成解压，初次运行将自动生成配置文件，所以，请先运行一次。</p><ul><li><p>第一次运行选择<code>http</code>链路即可</p></li><li><p>在解压目录下运行<code>./go-cqhttp</code>启动服务</p></li></ul><blockquote><p>由于AI项目在win10上运行，所以我们需要上报数据链到局域网端口中</p></blockquote><p><img src="https://s1.ax1x.com/2022/11/27/zNjFpt.jpg" alt=""></p><p>在<code>config.yml</code>中填写上报IP地址及端口</p><p>重启服务</p><p><img src="https://s1.ax1x.com/2022/11/27/zNjPfI.jpg" alt=""></p><p>不出意外的话，你的服务已经运行起来了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 私聊消息发送</span><br><span class="line">http://192.168.2.199:5700/send_private_msg?user_id=对方QQ&amp;message=消息内容</span><br><span class="line"></span><br><span class="line"># 群聊消息发送</span><br><span class="line">http://192.168.2.199:5700/send_group_msg?group_id=群id&amp;message=消息内容&amp;message_type=group&amp;auto_escape=false</span><br><span class="line"></span><br><span class="line"># 在局域网内使用IP加端口，跟上参数，（QQ需要已添加好友），get一次就能顺利发出消息。</span><br></pre></td></tr></table></figure><h2 id="win10监听"><a href="#win10监听" class="headerlink" title="win10监听"></a>win10监听</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取QQ消息</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_data</span>():</span><br><span class="line">    <span class="keyword">if</span> request.get_json().get(<span class="string">&#x27;message_type&#x27;</span>) == <span class="string">&#x27;private&#x27;</span>:  <span class="comment"># 私聊信息</span></span><br><span class="line">        uid = request.get_json().get(<span class="string">&#x27;sender&#x27;</span>).get(<span class="string">&#x27;user_id&#x27;</span>)  <span class="comment"># 获取信息发送者的 QQ号码</span></span><br><span class="line">        message = request.get_json().get(<span class="string">&#x27;raw_message&#x27;</span>)  <span class="comment"># 获取原始信息</span></span><br><span class="line">        <span class="built_in">print</span>(message, uid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.get_json().get(<span class="string">&#x27;message_type&#x27;</span>) == <span class="string">&#x27;group&#x27;</span>:  <span class="comment"># 如果是群聊信息</span></span><br><span class="line">        gid = request.get_json().get(<span class="string">&#x27;group_id&#x27;</span>)  <span class="comment"># 获取群号</span></span><br><span class="line">        uid = request.get_json().get(<span class="string">&#x27;sender&#x27;</span>).get(<span class="string">&#x27;user_id&#x27;</span>)  <span class="comment"># 获取信息发送者的 QQ号码</span></span><br><span class="line">        message = request.get_json().get(<span class="string">&#x27;raw_message&#x27;</span>)  <span class="comment"># 获取原始信息</span></span><br><span class="line">        <span class="built_in">print</span>(message, gid, uid)</span><br><span class="line">        send(message, gid, uid) <span class="comment"># 检测发送消息函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;OK&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;192.168.2.191&#x27;</span>, port=<span class="number">1234</span>)  <span class="comment"># 此处的 host和 port对应上面 yml文件的设置</span></span><br></pre></td></tr></table></figure><blockquote><p>win10监听1234端口，当树莓派端获取到消息，将上报到此端口</p></blockquote><p><img src="https://s1.ax1x.com/2022/11/27/zNjk1P.jpg" alt=""></p><h2 id="指令处理"><a href="#指令处理" class="headerlink" title="指令处理"></a>指令处理</h2><p>当检测到某个关键词时，将处理对应的函数</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 发送消息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">message, gid, uid</span>):</span><br><span class="line">    put = <span class="string">&#x27;http://192.168.2.199:5700/send_group_msg?group_id=&#123;0&#125;&amp;message=&#123;1&#125;&amp;message_type=group&amp;auto_escape=false&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 推送到QQ</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send_qq_msg</span>(<span class="params">path, gid</span>):</span><br><span class="line">        path = quote(path, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        pic_path = <span class="string">f&#x27;[CQ:image,file=http://frp1.freefrp.net:13389/<span class="subst">&#123;path&#125;</span>]&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;message_type&quot;</span>: <span class="string">&quot;group&quot;</span>,</span><br><span class="line">            <span class="string">&quot;group_id&quot;</span>: gid,</span><br><span class="line">            <span class="string">&quot;message&quot;</span>: pic_path</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(pic_path, gid)</span><br><span class="line">        response = requests.post(<span class="string">&#x27;http://192.168.2.199:5700/send_group_msg&#x27;</span>, json=data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> message.find(<span class="string">&quot;画了个画&quot;</span>):</span><br><span class="line">        key = message[<span class="number">5</span>:].split(<span class="string">&#x27;，&#x27;</span>)</span><br><span class="line">        <span class="comment"># 关键词转换</span></span><br><span class="line">        m = []</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">            m.append(tanslate(key[ii]))</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        yu = <span class="string">&quot;,&quot;</span>.join(m)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果没被画过，开始绘画</span></span><br><span class="line">        <span class="keyword">if</span> yu <span class="keyword">not</span> <span class="keyword">in</span> over_send_msg:</span><br><span class="line">            message = <span class="string">&quot;开始绘画\n关键词:&quot;</span> + message[<span class="number">5</span>:] + <span class="string">&quot;[&quot;</span> + yu + <span class="string">&quot;]\n预计时间:1m...&quot;</span></span><br><span class="line">            over_send_msg.append(<span class="string">&quot;,&quot;</span>.join(m))</span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, message))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;画图\n关键词:&quot;</span> + message[<span class="number">5</span>:] + <span class="string">&quot;\n==&gt;&quot;</span> + yu)</span><br><span class="line">            <span class="built_in">print</span>(over_send_msg)</span><br><span class="line">            paint_state = <span class="literal">True</span></span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;来自:%d的绘图完成\n%s&quot;</span> % (uid, start_piant(yu))))</span><br><span class="line">            send_qq = <span class="built_in">input</span>(<span class="string">&quot;是否允许推送QQ？(y推送):&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> send_qq != <span class="string">&quot;y&quot;</span>:</span><br><span class="line">                send_qq_msg(key_qq_msg, gid)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;你的绘图，太刺激了吧.....不给你看&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> message.find(<span class="string">&quot;画了个画&quot;</span>):</span><br><span class="line">        yu = message[<span class="number">5</span>:].replace(<span class="string">&quot;，&quot;</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> yu <span class="keyword">not</span> <span class="keyword">in</span> over_send_msg:</span><br><span class="line">            message = <span class="string">&quot;开始绘画\n关键词:[&quot;</span> + yu + <span class="string">&quot;]\n预计时间:1m...&quot;</span></span><br><span class="line">            over_send_msg.append(yu)</span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, message))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;画图\n关键词:\n==&gt;&quot;</span> + yu)</span><br><span class="line">            <span class="built_in">print</span>(over_send_msg)</span><br><span class="line">            paint_state = <span class="literal">True</span></span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;来自:%d的绘图完成\n%s&quot;</span> % (uid, start_piant(yu))))</span><br><span class="line">            send_qq = <span class="built_in">input</span>(<span class="string">&quot;是否允许推送QQ？(y推送):&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> send_qq != <span class="string">&quot;y&quot;</span>:</span><br><span class="line">                send_qq_msg(key_qq_msg, gid)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;你的绘图，太刺激了吧.....不给你看&quot;</span>))</span><br></pre></td></tr></table></figure><blockquote><p>在侦测到”高级画画”，”画了个画”时，将触发函数</p></blockquote><h1 id="完整py"><a href="#完整py" class="headerlink" title="完整py"></a>完整py</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"><span class="keyword">import</span> http.client</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">over_send_msg = []</span><br><span class="line">key_msg = []</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"><span class="comment"># 请求绘图</span></span><br><span class="line"><span class="comment"># 拿到处理完成后的用户关键词后，post请求本地AI，画完后返回图片消息</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_piant</span>(<span class="params">key_new</span>):</span><br><span class="line">    cookies = &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 随机数取值</span></span><br><span class="line">    value = (random.uniform(<span class="number">100236542</span>, <span class="number">875987458</span>))</span><br><span class="line">    value = <span class="built_in">int</span>(value)</span><br><span class="line">    key = <span class="string">&quot;masterpiece, best quality, &quot;</span> + key_new</span><br><span class="line">    <span class="built_in">print</span>(key, <span class="string">&quot;绘图中&quot;</span>)</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;en,zh-CN;q=0.9,zh;q=0.8&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;Bearer&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Origin&#x27;</span>: <span class="string">&#x27;http://localhost:6969&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Google Chrome&quot;;v=&quot;107&quot;, &quot;Chromium&quot;;v=&quot;107&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class="string">&#x27;?0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-ch-ua-platform&#x27;</span>: <span class="string">&#x27;&quot;Windows&quot;&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据内容提交</span></span><br><span class="line">    json_data = &#123;</span><br><span class="line">        <span class="string">&#x27;prompt&#x27;</span>: key,</span><br><span class="line">        <span class="string">&#x27;width&#x27;</span>: <span class="number">512</span>,</span><br><span class="line">        <span class="string">&#x27;height&#x27;</span>: <span class="number">768</span>,</span><br><span class="line">        <span class="string">&#x27;scale&#x27;</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="string">&#x27;sampler&#x27;</span>: <span class="string">&#x27;k_euler_ancestral&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;steps&#x27;</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="string">&#x27;seed&#x27;</span>: value,</span><br><span class="line">        <span class="string">&#x27;n_samples&#x27;</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="string">&#x27;ucPreset&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&#x27;uc&#x27;</span>: <span class="string">&#x27;lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.post(<span class="string">&#x27;http://localhost:6969/generate-stream&#x27;</span>, cookies=cookies, headers=headers, json=json_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义全局变量方便拿值</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> key_qq_msg</span><br><span class="line">    key_qq_msg = key_new + <span class="string">&quot; s-&quot;</span> + <span class="built_in">str</span>(value) + <span class="string">&quot;.png&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key_new + <span class="string">&quot; s-&quot;</span> + <span class="built_in">str</span>(value) + <span class="string">&quot;.png&quot;</span></span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"><span class="comment"># 百度通用翻译API，详见官方文档，请使用自己的参数</span></span><br><span class="line"><span class="comment"># 将用户输入的中文关键词翻译成英文关键词，ai处理效果更好</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tanslate</span>(<span class="params">q</span>):</span><br><span class="line">    appid = <span class="string">&#x27;&#x27;</span>  <span class="comment"># 填写你的appid</span></span><br><span class="line">    secretKey = <span class="string">&#x27;&#x27;</span>  <span class="comment"># 填写你的密钥</span></span><br><span class="line">    httpClient = <span class="literal">None</span></span><br><span class="line">    myurl = <span class="string">&#x27;/api/trans/vip/translate&#x27;</span></span><br><span class="line">    fromLang = <span class="string">&#x27;zh&#x27;</span>  <span class="comment"># 原文语种</span></span><br><span class="line">    toLang = <span class="string">&#x27;en&#x27;</span>  <span class="comment"># 译文语种</span></span><br><span class="line">    salt = random.randint(<span class="number">32768</span>, <span class="number">65536</span>)</span><br><span class="line">    sign = appid + q + <span class="built_in">str</span>(salt) + secretKey</span><br><span class="line">    sign = hashlib.md5(sign.encode()).hexdigest()</span><br><span class="line">    myurl = myurl + <span class="string">&#x27;?appid=&#x27;</span> + appid + <span class="string">&#x27;&amp;q=&#x27;</span> + urllib.parse.quote(</span><br><span class="line">        q) + <span class="string">&#x27;&amp;from=&#x27;</span> + fromLang + <span class="string">&#x27;&amp;to=&#x27;</span> + toLang + <span class="string">&#x27;&amp;salt=&#x27;</span> + <span class="built_in">str</span>(</span><br><span class="line">        salt) + <span class="string">&#x27;&amp;sign=&#x27;</span> + sign</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        httpClient = http.client.HTTPConnection(<span class="string">&#x27;api.fanyi.baidu.com&#x27;</span>)</span><br><span class="line">        httpClient.request(<span class="string">&#x27;GET&#x27;</span>, myurl)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># response是HTTPResponse对象</span></span><br><span class="line">        response = httpClient.getresponse()</span><br><span class="line">        result_all = response.read().decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        result = json.loads(result_all)</span><br><span class="line">        <span class="keyword">return</span> result[<span class="string">&quot;trans_result&quot;</span>][<span class="number">0</span>][<span class="string">&quot;dst&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="keyword">if</span> httpClient:</span><br><span class="line">            httpClient.close()</span><br><span class="line"></span><br><span class="line">--------------------------------------------------------------</span><br><span class="line"><span class="comment"># 发送消息</span></span><br><span class="line"><span class="comment"># 由于服务部署于不同设备，推送QQ图片时不方便。使用内网穿透，直接映射文件出去。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">message, gid, uid</span>):</span><br><span class="line"></span><br><span class="line">推送到的地址，需要改变ip</span><br><span class="line">    put = <span class="string">&#x27;http://192.168.2.199:5700/send_group_msg?group_id=&#123;0&#125;&amp;message=&#123;1&#125;&amp;message_type=group&amp;auto_escape=false&#x27;</span></span><br><span class="line">    <span class="comment"># 图片推送到QQ，使用CQ消息 https://docs.go-cqhttp.org/cqcode/#%E5%9B%BE%E7%89%87</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send_qq_msg</span>(<span class="params">path, gid</span>):</span><br><span class="line">        path = quote(path, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        pic_path = <span class="string">f&#x27;[CQ:image,file=http://frp1.freefrp.net:13389/<span class="subst">&#123;path&#125;</span>]&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;message_type&quot;</span>: <span class="string">&quot;group&quot;</span>,</span><br><span class="line">            <span class="string">&quot;group_id&quot;</span>: gid,</span><br><span class="line">            <span class="string">&quot;message&quot;</span>: pic_path</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(pic_path, gid)</span><br><span class="line">        response = requests.post(<span class="string">&#x27;http://192.168.2.199:5700/send_group_msg&#x27;</span>, json=data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断关键词</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> message.find(<span class="string">&quot;画了个画&quot;</span>):</span><br><span class="line">        key = message[<span class="number">5</span>:].split(<span class="string">&#x27;，&#x27;</span>)</span><br><span class="line">        <span class="comment"># 关键词转换，百度翻译而已</span></span><br><span class="line">        m = []</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">            m.append(tanslate(key[ii]))</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">        yu = <span class="string">&quot;,&quot;</span>.join(m)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 如果没被画过，开始绘画</span></span><br><span class="line">        <span class="keyword">if</span> yu <span class="keyword">not</span> <span class="keyword">in</span> over_send_msg:</span><br><span class="line">            message = <span class="string">&quot;开始绘画\n关键词:&quot;</span> + message[<span class="number">5</span>:] + <span class="string">&quot;[&quot;</span> + yu + <span class="string">&quot;]\n预计时间:1m...&quot;</span></span><br><span class="line">            over_send_msg.append(<span class="string">&quot;,&quot;</span>.join(m))</span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, message))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;画图\n关键词:&quot;</span> + message[<span class="number">5</span>:] + <span class="string">&quot;\n==&gt;&quot;</span> + yu)</span><br><span class="line">            <span class="built_in">print</span>(over_send_msg)</span><br><span class="line">            paint_state = <span class="literal">True</span></span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;来自:%d的绘图完成\n%s&quot;</span> % (uid, start_piant(yu))))</span><br><span class="line">            send_qq = <span class="built_in">input</span>(<span class="string">&quot;是否允许推送QQ图片？(y表示不推送):&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> send_qq != <span class="string">&quot;y&quot;</span>:</span><br><span class="line">                send_qq_msg(key_qq_msg, gid)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;你的绘图，太刺激了吧.....不给你看&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> message.find(<span class="string">&quot;高级画画&quot;</span>):</span><br><span class="line"><span class="comment"># 高级绘画时，将不处理关键词，即直接推送标签。</span></span><br><span class="line">        yu = message[<span class="number">5</span>:].replace(<span class="string">&quot;，&quot;</span>, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> yu <span class="keyword">not</span> <span class="keyword">in</span> over_send_msg:</span><br><span class="line">            message = <span class="string">&quot;开始绘画\n关键词:[&quot;</span> + yu + <span class="string">&quot;]\n预计时间:1m...&quot;</span></span><br><span class="line">            over_send_msg.append(yu)</span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, message))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;画图\n关键词:\n==&gt;&quot;</span> + yu)</span><br><span class="line">            <span class="built_in">print</span>(over_send_msg)</span><br><span class="line">            paint_state = <span class="literal">True</span></span><br><span class="line">            requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;来自:%d的绘图完成\n%s&quot;</span> % (uid, start_piant(yu))))</span><br><span class="line">            send_qq = <span class="built_in">input</span>(<span class="string">&quot;是否允许推送QQ图片？(y表示不推送):&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> send_qq != <span class="string">&quot;y&quot;</span>:</span><br><span class="line">                send_qq_msg(key_qq_msg, gid)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                requests.get(url=put.<span class="built_in">format</span>(gid, <span class="string">&quot;你的绘图，太刺激了吧.....不给你看&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;        else:</span></span><br><span class="line"><span class="string">            requests.get(url=put.format(gid, &quot;喂，已经画过了喂，GPU很烫的！&quot;))&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取QQ消息</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_data</span>():</span><br><span class="line">    <span class="keyword">if</span> request.get_json().get(<span class="string">&#x27;message_type&#x27;</span>) == <span class="string">&#x27;private&#x27;</span>:  <span class="comment"># 私聊信息</span></span><br><span class="line">        uid = request.get_json().get(<span class="string">&#x27;sender&#x27;</span>).get(<span class="string">&#x27;user_id&#x27;</span>)  <span class="comment"># 获取信息发送者的 QQ号码</span></span><br><span class="line">        message = request.get_json().get(<span class="string">&#x27;raw_message&#x27;</span>)  <span class="comment"># 获取原始信息</span></span><br><span class="line">        <span class="built_in">print</span>(message, uid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.get_json().get(<span class="string">&#x27;message_type&#x27;</span>) == <span class="string">&#x27;group&#x27;</span>:  <span class="comment"># 如果是群聊信息</span></span><br><span class="line">        gid = request.get_json().get(<span class="string">&#x27;group_id&#x27;</span>)  <span class="comment"># 获取群号</span></span><br><span class="line">        uid = request.get_json().get(<span class="string">&#x27;sender&#x27;</span>).get(<span class="string">&#x27;user_id&#x27;</span>)  <span class="comment"># 获取信息发送者的 QQ号码</span></span><br><span class="line">        message = request.get_json().get(<span class="string">&#x27;raw_message&#x27;</span>)  <span class="comment"># 获取原始信息</span></span><br><span class="line">        <span class="built_in">print</span>(message, gid, uid)</span><br><span class="line">        send(message, gid, uid)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;OK&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;192.168.2.191&#x27;</span>, port=<span class="number">1234</span>)  <span class="comment"># 此处的 host和 port对应上面 yml文件的设置</span></span><br></pre></td></tr></table></figure><h1 id="frp端口映射"><a href="#frp端口映射" class="headerlink" title="frp端口映射"></a>frp端口映射</h1><blockquote><p>使用了开源<a href="https://github.com/codemonkey-m/FrpClient-Win">FrpClient</a>项目进行映射</p></blockquote><p>至于免费<code>frp服务</code>，网络上太多了<a href="https://afrps.cn/">afrps</a>，<a href="https://freefrp.net/">freefrp</a>等等</p><p>建立服务后，更改python代码中的ip与端口，浏览器中带端口测试，不出意外的话，你就已经映射了文件。</p><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://s1.ax1x.com/2022/11/27/zNjEX8.jpg" alt=""></p><p><img src="https://s1.ax1x.com/2022/11/27/zNjZnS.jpg" alt=""></p><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>完成啦</p></div></div>]]></content>
    
    
    <summary type="html">AI帮我画张画，加个小机器人，QQ群里就可以帮我画画啦~</summary>
    
    
    
    <category term="食用指南" scheme="https://nrhs-space.github.io/categories/%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    
    
    <category term="自动化" scheme="https://nrhs-space.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    <category term="AI，树莓派" scheme="https://nrhs-space.github.io/tags/AI%EF%BC%8C%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
  </entry>
  
  <entry>
    <title>『弹幕笔记』开源！</title>
    <link href="https://nrhs-space.github.io/2022/11/12/BulletNote_open-source/"/>
    <id>https://nrhs-space.github.io/2022/11/12/BulletNote_open-source/</id>
    <published>2022-11-12T13:48:39.000Z</published>
    <updated>2023-04-04T02:57:20.634Z</updated>
    
    <content type="html"><![CDATA[<h1 id="序-Prologue"><a href="#序-Prologue" class="headerlink" title="序-Prologue"></a>序-Prologue</h1><p>耗时近半月之后，弹幕笔记开发完成。她是在我老是记混知识点时，灵感闪过，想着要是能在屏幕上时不时的提醒我一下多是一件美事。</p><p>灵感就是这样神奇，若不实现她，彻夜难安。我在寻找这类软件时，也偶遇了【弹幕记忆】APP。她很不错，但是我想要的功能，嗯……要VIP。于是，我决定自己开发。</p><p>对于安卓开发，我并不擅长。甚至可以说，我基本不会。我的专业是医学数据，计算机只能说沾边，但完全不深入。对于java这些语言，我更是完全没有系统学习。</p><p>但对于我构思的这款软件，她其实并不难。甚至可以是用<code>AutoJs</code>这类脚本就可以很好的展现出来。但脚本着实不好管理，且不优雅。我不喜欢，我还是更喜欢用APP的形式展现她。</p><p>我决定使用<code>Lua</code>这个小而轻量的语言完成我的构思。恰好，<code>Lua</code>在手机上就可以很好的完成编程，相当于自带了真机调试环境，省去了很多繁琐的步骤。</p><p>而<code>Lua</code>这一小而轻量的语言，本身就省去了很多繁琐的东西。恰好我在很早之前也曾接触过她一点点，不用从头学起。</p><p>“从闭源到开源是一次伟大的飞跃”，我一直很认可这句话。无论是在我学习的途中，还是遇到问题的过程中。开源都给予了我莫大的帮助。</p><p>当我也终于学会了其中的一点点知识，我也毫不犹豫的决定，开源她。</p><hr><h1 id="展示，构思与实现"><a href="#展示，构思与实现" class="headerlink" title="展示，构思与实现"></a>展示，构思与实现</h1><h2 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h2><div class="note primary modern"><p>很多时候，我都喜欢先看看最终效果来衡量一篇文章或者项目对我是否有效。所以我也把我的『弹幕笔记』效果摆出来瞅瞅先。</p></div><p><img src="https://s1.ax1x.com/2022/11/13/zFGUSO.jpg" alt=""></p><p><img src="https://s1.ax1x.com/2022/11/13/zFGd6e.jpg" alt=""></p><div class="note red icon modern"><i class="note-icon fas fa-fan"></i><p>『弹幕笔记』将在任何界面上随机弹幕出你添加的笔记内容，但它不会影响你的操作。</p></div><p><img src="https://s1.ax1x.com/2022/11/13/zFGwOH.jpg" alt=""></p><div class="note purple no-icon flat"><p>自我感觉UI设计勉勉强强还行，起码不是xp风。</p></div><h2 id="基础构思"><a href="#基础构思" class="headerlink" title="基础构思"></a>基础构思</h2><p>其一，我准备实现的目标是添加笔记之后，可以随时随地在手机屏幕上“弹幕”出我的笔记，来加深我的印象。所以其实基础功能就这两个：</p><ul><li>数据存取</li><li>弹幕内容</li></ul><p>但我们不能直接摆个文本文档上去。我们得交互，得优雅。所以，我们起码得完成以下功能：</p><ul><li>安卓activity绘制</li><li>基础界面交互</li><li>应用内数据库操作</li><li>全局管理</li><li>悬浮窗</li></ul><hr><h2 id="开始实现"><a href="#开始实现" class="headerlink" title="开始实现"></a>开始实现</h2><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><div class="tip info"><p>开发环境：Redmi K30 安卓12<br>开发工具：<a href="https://www.andnixsh.com/2020/05/andlua-v66-apk-englishchinese.html">AndroidLua+</a><br>开发语言：<a href="https://www.runoob.com/lua/lua-tutorial.html">lua</a><br>相关助手：<a href="https://gitee.com/hanwuji886/aluaj-pro">AluaJ助手</a></p></div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>在进一步之前，你应该具备基础的Lua语言知识。</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>由于开源程序包已放出，所以本篇文档将只会阐述各Lua脚本的作用，以及注意事项！</p>            </div><h3 id="概览"><a href="#概览" class="headerlink" title="概览"></a>概览</h3><p><img src="https://s1.ax1x.com/2022/11/13/zFGykt.jpg" alt=""></p><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>文件概览</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>大部分文件在我都已经表明了它的作用</p>            </div><hr><h3 id="Bullet-db文件详解"><a href="#Bullet-db文件详解" class="headerlink" title="Bullet.db文件详解"></a>Bullet.db文件详解</h3><p>安卓本地数据库一般都采用<code>Sqlite</code>数据库，因为它足够轻巧，灵敏。该有的东西它一个不少。</p><p>你即使删掉这个文件也不会造成影响。在我开源的文件中，你也不会找到它，因为<code>『弹幕笔记』</code>将自动创建这个数据库用来保存数据。</p><p>删掉这个文件即会删掉所有的用户数据。<code>『弹幕笔记』</code>的笔记内容，用户内容以不同的表保存。</p><p>图中的<wavy>Bullet.db-jurnal</wavy>文件为程序自动生成的临时日志文件。删掉一般无影响（反正还会生成）。</p><h3 id="main-lua详解"><a href="#main-lua详解" class="headerlink" title="main.lua详解"></a>main.lua详解</h3><p><code>main</code>是程序启动后首先执行的文件。也就是入口文件，我在里面放了程序启动时引入的大量包，以及程序启动就应该执行的事件</p><p>需要注意其中导入”<code>Mlua/fun</code>“和”<code>Mlua/incident</code>“的顺序。这两个文件非常重要！其中<code>fun</code>文件几乎纪录了程序所有已封装成函数的自定义事件。而<code>incident</code>记录几乎所有的事件，即用户执行的反馈内容。</p><ul><li>这两个文件会在后面说明，在这里你只需要知道，尽量不要去调整<code>main</code>函数内的内容及顺序关系。</li></ul><h3 id="Mlayout文件夹"><a href="#Mlayout文件夹" class="headerlink" title="Mlayout文件夹"></a>Mlayout文件夹</h3><p>该文件夹内全部为各布局文件。就像<wavy>CSS样式表</wavy>一样，想改<code>UI</code>界面，就在里面自己去找相应的的内容。</p><ul><li>并没有太需要注意的事项。</li></ul><h3 id="Mlua文件夹"><a href="#Mlua文件夹" class="headerlink" title="Mlua文件夹"></a>Mlua文件夹</h3><p>该文件夹就全部是脚本文件了。就是关于逻辑设计，事件处理等，是软件的核心内容。</p><p><img src="https://s1.ax1x.com/2022/11/13/zFGcff.jpg" alt=""></p><ul><li>它们大概的作用如上</li></ul><h4 id="fun函数文件"><a href="#fun函数文件" class="headerlink" title="fun函数文件"></a>fun函数文件</h4><div class="tip warning"><p>该文件为最重要的函数文件，其中包含了几乎所有的自定义函数和不便于分类简单布局</p></div><details class="folding-tag" green><summary> 查看实现悬浮窗代码 </summary>              <div class='content'>              <ul><li>该功能实现依赖于很多函数控制，关联太多，在<code>incident</code>文件与<code>fun</code>文件中交叉进行。</li><li>需要自己仔细研究</li><li>这里只是展现了部分框架</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--悬浮窗page页面</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">addTab</span><span class="params">(t)</span></span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    CardView;</span><br><span class="line">    cardBackgroundColor=<span class="number">0x00000000</span>,</span><br><span class="line">    elevation=<span class="string">&quot;0&quot;</span>;</span><br><span class="line">    radius=<span class="string">&quot;38dp&quot;</span>;</span><br><span class="line">    id=<span class="string">&quot;___&quot;</span>,</span><br><span class="line">    layout_marginLeft=<span class="string">&quot;12dp&quot;</span>,</span><br><span class="line">    onClick=<span class="function"><span class="keyword">function</span><span class="params">(v)</span></span></span><br><span class="line">      <span class="keyword">for</span> i=<span class="number">0</span>,v.parent.getChildCount()<span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">if</span> v.parent.getChildAt(i).id==v.id <span class="keyword">then</span></span><br><span class="line">          pg.setCurrentItem(i)</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      LinearLayout;</span><br><span class="line">      layout_width=<span class="string">&quot;-2&quot;</span>;</span><br><span class="line">      layout_height=<span class="string">&quot;-2&quot;</span>;</span><br><span class="line">      padding=<span class="string">&quot;4dp&quot;</span>,</span><br><span class="line">      paddingLeft=<span class="string">&quot;14dp&quot;</span>,</span><br><span class="line">      paddingRight=<span class="string">&quot;14dp&quot;</span>,</span><br><span class="line">      orientation=<span class="string">&quot;vertical&quot;</span>;</span><br><span class="line">      &#123;</span><br><span class="line">        TextView;</span><br><span class="line">        textSize=<span class="string">&quot;14sp&quot;</span>,</span><br><span class="line">        textColor=<span class="number">0xFFFFD6E2</span>,</span><br><span class="line">        gravity=<span class="string">&quot;center&quot;</span>;</span><br><span class="line">        text=t;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">setWidth</span><span class="params">(a,b)</span></span></span><br><span class="line">  <span class="keyword">local</span> q=a.layoutParams</span><br><span class="line">  q.width=b</span><br><span class="line">  a.layoutParams=q</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dp2px</span><span class="params">(dpValue)</span></span></span><br><span class="line">  <span class="keyword">local</span> scale = activity.getResources().getDisplayMetrics().scaledDensity</span><br><span class="line">  <span class="keyword">return</span> dpValue * scale + <span class="number">0.5</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">bar.addView(loadlayout(addTab(<span class="string">&quot;添加记录&quot;</span>),<span class="literal">nil</span>,bar.class))</span><br><span class="line">bar.addView(loadlayout(addTab(<span class="string">&quot;翻译系统&quot;</span>),<span class="literal">nil</span>,bar.class))</span><br><span class="line"></span><br><span class="line">bar.getChildAt(<span class="number">0</span>).getChildAt(<span class="number">0</span>).getChildAt(<span class="number">0</span>).textColor=<span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">choose.addView(loadlayout(&#123;</span><br><span class="line">  CardView;</span><br><span class="line">  cardBackgroundColor=<span class="number">0xFFF2BECA</span>,</span><br><span class="line">  elevation=<span class="string">&quot;0&quot;</span>;</span><br><span class="line">  radius=<span class="string">&quot;38dp&quot;</span>;</span><br><span class="line">  layout_height=<span class="string">&quot;24dp&quot;</span>,</span><br><span class="line">  layout_marginLeft=<span class="string">&quot;12dp&quot;</span>,</span><br><span class="line">&#125;,<span class="literal">nil</span>,choose.class))</span><br><span class="line"></span><br><span class="line">bar.getChildAt(<span class="number">0</span>).post &#123;</span><br><span class="line">  run=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    setWidth(choose.getChildAt(<span class="number">0</span>),bar.getChildAt(<span class="number">0</span>).width)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">--[[for i=1,2 do</span></span><br><span class="line"><span class="comment">  pg.adapter.add(loadlayout&#123;</span></span><br><span class="line"><span class="comment">    LinearLayout,</span></span><br><span class="line"><span class="comment">    layout_width=&quot;fill&quot;,</span></span><br><span class="line"><span class="comment">    layout_height=&quot;fill&quot;,</span></span><br><span class="line"><span class="comment">  &#125;)</span></span><br><span class="line"><span class="comment">end]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> data=&#123;</span><br><span class="line">  scrollData=&#123;&#125;,</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pg.setOnPageChangeListener&#123;</span><br><span class="line">  onPageSelected=<span class="function"><span class="keyword">function</span><span class="params">(t)</span></span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">0</span>,bar.getChildCount()<span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line">      bar.getChildAt(i).getChildAt(<span class="number">0</span>).getChildAt(<span class="number">0</span>).textColor=<span class="number">0xFFFFD6E2</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    bar.getChildAt(t).getChildAt(<span class="number">0</span>).getChildAt(<span class="number">0</span>).textColor=<span class="number">0xffffffff</span></span><br><span class="line">    setWidth(choose.getChildAt(<span class="number">0</span>),bar.getChildAt(t).width)</span><br><span class="line">    choose.getChildAt(<span class="number">0</span>).x=bar.getChildAt(t).x</span><br><span class="line">  <span class="keyword">end</span>,</span><br><span class="line">  onPageScrollStateChanged=<span class="function"><span class="keyword">function</span><span class="params">(i)</span></span></span><br><span class="line">    data.scrollData.scroll=i&gt;<span class="number">0</span></span><br><span class="line">  <span class="keyword">end</span>,</span><br><span class="line">  onPageScrolled=<span class="function"><span class="keyword">function</span><span class="params">(a,b,c)</span></span></span><br><span class="line">    <span class="keyword">local</span> nowView=bar.getChildAt(a)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> nextView=bar.getChildAt(a==bar.getChildCount() <span class="keyword">and</span> bar.getChildCount() <span class="keyword">or</span> a+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> data.scrollData.scroll <span class="keyword">and</span> b~=<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">if</span> data.scrollData.last <span class="keyword">and</span> data.scrollData.last&lt;b <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">if</span> nextView.width&lt;nowView.width <span class="keyword">then</span></span><br><span class="line">          setWidth(choose.getChildAt(<span class="number">0</span>),nowView.width-((nowView.width-nextView.width)*b))</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">          setWidth(choose.getChildAt(<span class="number">0</span>),nowView.width+((nextView.width-nowView.width)*b))</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        choose.getChildAt(<span class="number">0</span>).x=nextView.x-((nextView.x-nowView.x)*(<span class="number">1</span>-b))</span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">local</span> lastView=bar.getChildAt(a)</span><br><span class="line">        <span class="keyword">local</span> nowView=bar.getChildAt(a+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> lastView.width&gt;nowView.width <span class="keyword">then</span></span><br><span class="line">          setWidth(choose.getChildAt(<span class="number">0</span>),nowView.width+((lastView.width-nowView.width)*(<span class="number">1</span>-b)))</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">          setWidth(choose.getChildAt(<span class="number">0</span>),nowView.width-((nowView.width-lastView.width)*(<span class="number">1</span>-b)))</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        choose.getChildAt(<span class="number">0</span>).x=lastView.x+((nowView.x-lastView.x)*b)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">0</span> <span class="keyword">or</span> c==<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">      <span class="keyword">for</span> i=<span class="number">0</span>,bar.getChildCount()<span class="number">-1</span> <span class="keyword">do</span></span><br><span class="line">        bar.getChildAt(i).getChildAt(<span class="number">0</span>).getChildAt(<span class="number">0</span>).textColor=<span class="number">0xFFFFD6E2</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      bar.getChildAt(pg.getCurrentItem()).getChildAt(<span class="number">0</span>).getChildAt(<span class="number">0</span>).textColor=<span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    data.scrollData.page=a</span><br><span class="line">    data.scrollData.last=b</span><br><span class="line">  <span class="keyword">end</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 查看数据库操作相关代码 </summary>              <div class='content'>              <ul><li>数据库控制大部分函数均在<code>fun</code>文件中，各个功能调用使用</li><li>而一些特殊的需求，或者不便于调用的函数，又分布在各文件中。</li><li>需要自己研究</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">&quot;android.database.sqlite.*&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--sqlite数据库操作</span></span><br><span class="line"></span><br><span class="line">db = SQLiteDatabase.openOrCreateDatabase(this.getLuaDir() .. <span class="string">&quot;/bullet.db&quot;</span>,MODE_PRIVATE, <span class="literal">nil</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">--执行方式</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--rawQuery()方法用于执行select语句。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">raw</span><span class="params">(sql,text)</span></span></span><br><span class="line">  cursor=db.rawQuery(sql,text)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--execSQL()方法可以执行insert、delete、update和CREATE TABLE之类有更改行为的SQL语句</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exec</span><span class="params">(sql)</span></span></span><br><span class="line">  db.execSQL(sql);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建表</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">create_config</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">local</span> sql=<span class="string">&quot;create table config(name varchar primary key NOT NULL,value varchar ,bool boolean)&quot;</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">pcall</span>(exec,sql) <span class="keyword">then</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;创建配置表失败&quot;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--示例：执行语句，拿到结果。这个语句用来统计总数。</span></span><br><span class="line"><span class="keyword">local</span> sql=<span class="string">&quot;select count(*) from sqlite_master where type=&#x27;table&#x27; and name=&#x27;config&#x27;&quot;</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">pcall</span>(raw,sql,<span class="literal">nil</span>) <span class="keyword">then</span></span><br><span class="line">  cursor.moveToFirst(); <span class="comment">--移动指针</span></span><br><span class="line">  <span class="keyword">local</span> result = cursor.getLong(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> result==<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    create_config()</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;数据库查询失败！&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--其他lua数据库操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--创建表</span></span><br><span class="line"><span class="keyword">local</span> CreatrTableSql=<span class="string">&quot;create table &quot;</span>..tablename..<span class="string">&quot;(id integer primary key,cyan varchar,remark varchar)&quot;</span></span><br><span class="line"><span class="comment">--创建user表，integer类型为自动增长</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--删除表记录</span></span><br><span class="line"><span class="keyword">local</span> sql=<span class="string">&quot;delete from config where name=&#x27;&quot;</span>..record_name..<span class="string">&quot;&#x27;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--重命名表</span></span><br><span class="line"><span class="keyword">local</span> sql=<span class="string">&quot;ALTER TABLE &quot;</span>..old_name..<span class="string">&quot; RENAME to &quot;</span>..new_name</span><br><span class="line"></span><br><span class="line"><span class="comment">--为表插入新纪录</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addrecord</span><span class="params">(tablename,newrecord,newremark)</span></span></span><br><span class="line">  <span class="keyword">local</span> newrecord=newrecord:<span class="built_in">gsub</span>(<span class="string">&#x27;&amp;&amp;&#x27;</span>,<span class="string">&quot;•&quot;</span>) <span class="comment">--单词分词的替换</span></span><br><span class="line">  <span class="keyword">local</span> newremark=newremark:<span class="built_in">gsub</span>(<span class="string">&#x27;&amp;&amp;&#x27;</span>,<span class="string">&quot;•&quot;</span>)</span><br><span class="line">  <span class="keyword">local</span> sql=<span class="string">&quot;insert into &quot;</span>..tablename..<span class="string">&quot;(cyan,remark) values(&#x27;&quot;</span>..newrecord..<span class="string">&quot;&#x27;,&#x27;&quot;</span>..newremark..<span class="string">&quot;&#x27;)&quot;</span></span><br><span class="line">  <span class="comment">--print(sql)</span></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">pcall</span>(exec,sql) <span class="keyword">then</span></span><br><span class="line">    <span class="comment">--MD提示(&quot;添加新记录成功&quot;,0xFF2196F3,0xFFFFFFFF,4,10)</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;添加新纪录失败&quot;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" green><summary> 查看通知栏推送相关代码 </summary>              <div class='content'>              <ul><li>在实现屏幕弹幕后，遇到了一个问题。</li><li>软件不能长时间驻留后台，即使加锁和关闭省电策略。</li><li>我查到应该使用安卓前台<code>service</code>服务来确保应用的后台运行。当时我并未找到相关的案例，即<code>LuaService</code>的使用。</li><li>但我尝试在通知栏中长期驻留，以达到类似的效果，但是并没有什么作用。</li><li>我只是实现了通知栏推送，但未实现前台<code>service</code>。于是留下了这个坑。</li><li><u>注：该方法仅适用于安卓8以上</u></li></ul><p><img src="https://s1.ax1x.com/2022/11/13/zFGW6g.jpg" alt=""></p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--通知栏推送</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">push_notise</span><span class="params">(notice_id,title,content,value)</span></span></span><br><span class="line">  <span class="comment">--设置标题</span></span><br><span class="line">  builder.setContentTitle(title);</span><br><span class="line">  <span class="comment">--设置内容</span></span><br><span class="line">  builder.setContentText(content);</span><br><span class="line">  <span class="comment">--设置状态栏显示的图标，建议图标颜色透明</span></span><br><span class="line">  builder.setSmallIcon(R.drawable.icon)</span><br><span class="line"></span><br><span class="line">  builder.setWhen(System.currentTimeMillis())<span class="comment">--通知时间</span></span><br><span class="line">  builder.setShowWhen(<span class="literal">true</span>)<span class="comment">--是否显示通知时间</span></span><br><span class="line">  builder.setLargeIcon(loadbitmap(<span class="string">&quot;null&quot;</span>))<span class="comment">--右侧图标</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">--添加完成事件</span></span><br><span class="line">  <span class="comment">--intentDone = Intent(mDoneAction)</span></span><br><span class="line">  NotificationManager = activity.getSystemService(Context.NOTIFICATION_SERVICE)</span><br><span class="line"></span><br><span class="line">  <span class="comment">--创建 Intent，点击后通过包名跳转应用</span></span><br><span class="line">  NotificationIntent = Intent(<span class="string">&quot;android.intent.action.VIEW&quot;</span>,Uri.parse(<span class="string">&quot;&quot;</span>));</span><br><span class="line">  NotificationIntent.setClassName(<span class="comment">--[[this.getPackageName()]]</span><span class="string">&quot;com.nrhs.deskbullet&quot;</span>,<span class="string">&quot;com.androlua.Main&quot;</span>)</span><br><span class="line">  <span class="comment">--创建 PendingIntent</span></span><br><span class="line">  pendingIntent = PendingIntent.getActivity(activity.getApplicationContext(),<span class="number">0</span>,NotificationIntent,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">  hangIntent = Intent();</span><br><span class="line">  hangIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">  <span class="comment">--hangIntent.setClass(Context,activity.getApplicationContext())</span></span><br><span class="line">  <span class="comment">--如果描述的PendingIntent已经存在,则在产生新的Intent之前会先取消掉当前的</span></span><br><span class="line">  hangPendingIntent = PendingIntent.getActivity(activity.getApplicationContext(),<span class="number">0</span>,hangIntent,PendingIntent.FLAG_CANCEL_CURRENT)</span><br><span class="line">  builder.setFullScreenIntent(hangPendingIntent,<span class="literal">true</span>)</span><br><span class="line">  builder.setContentIntent(pendingIntent)<span class="comment">--点击后要跳转的intent</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">--builder.addAction(R.drawable.icon, &quot;弹幕笔记&quot;, pendingIntent)--通知上的操作需要Android10</span></span><br><span class="line">  <span class="comment">--builder.addAction(R.drawable.icon, &quot;关闭&quot;, pendingIntent)--通知上的操作需要Android10</span></span><br><span class="line">  <span class="keyword">if</span> value==<span class="string">&quot;long&quot;</span> <span class="keyword">then</span></span><br><span class="line">    builder.setOngoing(<span class="literal">true</span>); <span class="comment">--常驻通知，开启后用户的清除操作不可清除该通知</span></span><br><span class="line">    builder.setAutoCancel(<span class="literal">false</span>); <span class="comment">--自动取消</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">    builder.setOngoing(<span class="literal">false</span>);</span><br><span class="line">    builder.setAutoCancel(<span class="literal">true</span>); <span class="comment">--自动取消</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="comment">--builder.setContentIntent(pendingIntent); --点击事件</span></span><br><span class="line">  builder.setPriority(Notification.PRIORITY_HIGH);<span class="comment">--通知等级</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">--builder.setLargeIcon(BitmapFactory.decodeResource(activity.getResources(), R.drawable.icon));</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.O</span><br><span class="line">    channel = NotificationChannel(<span class="string">&quot;5996773&quot;</span>, <span class="string">&quot;弹幕笔记&quot;</span>, NotificationManager.IMPORTANCE_DEFAULT);</span><br><span class="line">    channel.enableLights(<span class="literal">true</span>);<span class="comment">--是否在桌面icon右上角展示小红点</span></span><br><span class="line">    channel.setLightColor(Color.GREEN);<span class="comment">--小红点颜色</span></span><br><span class="line">    channel.setShowBadge(<span class="literal">false</span>); <span class="comment">--是否在久按桌面图标时显示此渠道的通知</span></span><br><span class="line">    mNManager.createNotificationChannel(channel);</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  notification=builder.build();</span><br><span class="line"></span><br><span class="line">  mNManager.notify(notice_id,notification);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear_push</span><span class="params">(notice_id)</span></span></span><br><span class="line">  mNManager.cancel(notice_id);<span class="comment">--消除相应ID的通知</span></span><br><span class="line">  <span class="comment">--mNotificationMgr.cancleAll();</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>              </div>            </details><h4 id="incident文件"><a href="#incident文件" class="headerlink" title="incident文件"></a>incident文件</h4><div class="tip warning"><p>该文件为全局控制文件，几乎包含了所有事件的处理和逻辑</p></div><details class="folding-tag" green><summary> 查看弹幕传参代码 </summary>              <div class='content'>              <ul><li>最开始使用了属性动画，多个函数间相互传参。</li><li>最后在动画监听部分一直有奇奇怪怪的冲突，也没找到问题，于是改成了补间动画。</li><li>再干脆把所有事件写一起算了，反正机器读而已。</li><li>这个日志可有可无，当初不报错误但内容奇奇怪怪的时候才写的，只是输出了每次循环的信息。</li></ul><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">--开启弹幕传参</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ballistic</span><span class="params">()</span></span> <span class="comment">--弹道一事件</span></span><br><span class="line">  home_view()</span><br><span class="line">  <span class="keyword">local</span> <span class="built_in">random</span>=<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">1</span>,#home_list_name) <span class="comment">--随机数取当前弹幕序列中的卡片</span></span><br><span class="line">  bullet_text.setText(random_sqlite(home_list_name[<span class="built_in">random</span>])) <span class="comment">--设置随机记录到Text上去</span></span><br><span class="line">  bullet_cars.measure(View.MeasureSpec.makeMeasureSpec(<span class="number">0</span>,View.MeasureSpec.UNSPECIFIED),View.MeasureSpec.makeMeasureSpec(<span class="number">0</span>,View.MeasureSpec.UNSPECIFIED));</span><br><span class="line">  <span class="keyword">local</span> width =<span class="number">0</span>-(bullet_cars.getMeasuredWidth()); <span class="comment">--获取设置文字后的控件宽度。这里需注意，必须在setText下面，否则读不到正常宽度。</span></span><br><span class="line">  bullet_cars.startAnimation(TranslateAnimation(获取屏幕宽(),width,<span class="number">0</span>,<span class="number">0</span>).setDuration(<span class="number">20000</span>).setFillAfter(<span class="literal">true</span>).setAnimationListener(AnimationListener&#123;</span><br><span class="line">    onAnimationEnd=<span class="function"><span class="keyword">function</span><span class="params">()</span></span> <span class="comment">--设置补间动画结束监听</span></span><br><span class="line">      <span class="keyword">if</span> read_config(<span class="string">&quot;bullet_state&quot;</span>) == <span class="literal">true</span> <span class="keyword">then</span></span><br><span class="line">        ballistic()</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>&#125;))</span><br><span class="line">  <span class="keyword">if</span> read_config(<span class="string">&quot;log&quot;</span>)==<span class="literal">true</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">local</span> <span class="built_in">log</span>= <span class="string">&quot;弹道1,表:&quot;</span>..home_list_name[<span class="built_in">random</span>]..<span class="string">&quot;内容：&quot;</span>..random_sqlite(home_list_name[<span class="built_in">random</span>])..<span class="string">&quot;弹幕状态：&quot;</span>..<span class="built_in">tostring</span>(read_config(<span class="string">&quot;bullet_state&quot;</span>))</span><br><span class="line">    addrecord(<span class="string">&quot;log&quot;</span>,<span class="string">&quot;弹道一&quot;</span>,<span class="built_in">log</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>其他事件都不是很特殊，自己看看就行</li></ul>              </div>            </details><h4 id="volume文件"><a href="#volume文件" class="headerlink" title="volume文件"></a>volume文件</h4><div class="tip warning"><p>该文件为实现弹幕的核心文件，包括了弹幕容器，标志等</p></div><details class="folding-tag" green><summary> 查看相关代码 </summary>              <div class='content'>              <ul><li>其中尤为重要的是<code>flags</code>标志，它决定你的悬浮窗是否与用户交互，是否响应事件</li><li>在这里我们的弹幕不需要任何交互，因为它不能影响用户操作</li><li>而悬浮窗不仅需要与用户交互，还得输入内容，对数据库操作。</li><li>但这里有一个坑。我无法解决</li><li>其中悬浮窗函数的<code>flags</code>设置为的是:<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">悬浮窗口容器.flags = WindowManager.LayoutParams().FLAG_NOT_TOUCH_MODAL;</span><br></pre></td></tr></table></figure></li></ul><p>悬浮窗交互时，由于需要输入框，所以要获取输入焦点，但这样会导致悬浮窗后无法获取输入焦点<br>也就是说，用户在悬浮窗上输入内容时，<wavy>无法在悬浮窗外输入内容</wavy>（触摸正常），收起悬浮窗后正常。</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">窗口 = activity.getSystemService(Context.WINDOW_SERVICE)</span><br><span class="line"></span><br><span class="line"><span class="comment">--弹幕容器</span></span><br><span class="line">弹幕窗口容器 = WindowManager.LayoutParams()</span><br><span class="line"><span class="keyword">if</span> Build.VERSION.SDK_INT &gt;= <span class="number">26</span> <span class="keyword">then</span> <span class="comment">-- 判断SDK版本</span></span><br><span class="line">  弹幕窗口容器.<span class="built_in">type</span> = WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">  弹幕窗口容器.<span class="built_in">type</span> = WindowManager.LayoutParams.TYPE_SYSTEM_ALERT</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--不发生任何交互的flags</span></span><br><span class="line"></span><br><span class="line">弹幕窗口容器.flags = WindowManager.LayoutParams().FLAG_NOT_TOUCHABLE | WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE | WindowManager.LayoutParams.FLAG_LAYOUT_NO_LIMITS;</span><br><span class="line">弹幕窗口容器.gravity = Gravity.LEFT | Gravity.TOP</span><br><span class="line">弹幕窗口容器.<span class="built_in">format</span> = <span class="number">1</span></span><br><span class="line">弹幕窗口容器.alpha = <span class="number">0.8</span></span><br><span class="line">弹幕窗口容器.y = activity.getWidth()/<span class="number">5</span></span><br><span class="line"><span class="comment">--弹幕窗口容器.width = WindowManager.LayoutParams.WRAP_CONTENT</span></span><br><span class="line">弹幕窗口容器.width=activity.getWidth()</span><br><span class="line">弹幕窗口容器.height = WindowManager.LayoutParams.WRAP_CONTENT</span><br><span class="line">bullet=loadlayout(<span class="string">&quot;Mlayout/bullet_lay&quot;</span>) <span class="comment">-- 加载弹幕界面</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 悬浮窗内容</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--悬浮球容器</span></span><br><span class="line">窗口容器 = WindowManager.LayoutParams()</span><br><span class="line"><span class="keyword">if</span> Build.VERSION.SDK_INT &gt;= <span class="number">26</span> <span class="keyword">then</span></span><br><span class="line">  窗口容器.<span class="built_in">type</span> = WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">  窗口容器.<span class="built_in">type</span> = WindowManager.LayoutParams.TYPE_SYSTEM_ALERT</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">窗口容器.flags = WindowManager.LayoutParams().FLAG_NOT_FOCUSABLE;</span><br><span class="line">窗口容器.gravity = Gravity.LEFT | Gravity.TOP</span><br><span class="line">窗口容器.<span class="built_in">format</span> = <span class="number">1</span></span><br><span class="line">窗口容器.y = activity.getWidth()/<span class="number">3</span></span><br><span class="line">窗口容器.width = WindowManager.LayoutParams.WRAP_CONTENT</span><br><span class="line"><span class="comment">--窗口容器.width=activity.getWidth()</span></span><br><span class="line">窗口容器.height = WindowManager.LayoutParams.WRAP_CONTENT</span><br><span class="line"></span><br><span class="line"><span class="comment">--悬浮窗容器</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--由于FLAGS设置的冲突，只好分开悬浮窗与悬浮球，分别设置Flags</span></span><br><span class="line"><span class="comment">--在悬浮窗显示时，屏幕后输入框将无法弹出输入法。悬浮球时正常</span></span><br><span class="line"><span class="comment">--详见搜索Flags属性</span></span><br><span class="line"></span><br><span class="line">悬浮窗口容器 = WindowManager.LayoutParams()</span><br><span class="line"><span class="keyword">if</span> Build.VERSION.SDK_INT &gt;= <span class="number">26</span> <span class="keyword">then</span></span><br><span class="line">  悬浮窗口容器.<span class="built_in">type</span> = WindowManager.LayoutParams.TYPE_APPLICATION_OVERLAY</span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">  悬浮窗口容器.<span class="built_in">type</span> = WindowManager.LayoutParams.TYPE_SYSTEM_ALERT</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">悬浮窗口容器.flags = WindowManager.LayoutParams().FLAG_NOT_TOUCH_MODAL;</span><br><span class="line">悬浮窗口容器.gravity = Gravity.LEFT | Gravity.TOP</span><br><span class="line">悬浮窗口容器.<span class="built_in">format</span> = <span class="number">1</span></span><br><span class="line">悬浮窗口容器.y = activity.getWidth()/<span class="number">3</span></span><br><span class="line">悬浮窗口容器.width = WindowManager.LayoutParams.WRAP_CONTENT</span><br><span class="line"><span class="comment">--窗口容器.width=activity.getWidth()</span></span><br><span class="line">悬浮窗口容器.height = WindowManager.LayoutParams.WRAP_CONTENT</span><br><span class="line"></span><br><span class="line">悬浮窗=loadlayout(<span class="string">&quot;Mlayout/xfc&quot;</span>)</span><br><span class="line">悬浮球=loadlayout(<span class="string">&quot;Mlayout/xfq&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>其余依赖的函数太零碎，自己全局搜索咯</li></ul>              </div>            </details><h3 id="files文件夹"><a href="#files文件夹" class="headerlink" title="files文件夹"></a>files文件夹</h3><p>开源的文件管理器所有配置文件，不建议操作。</p><h3 id="libs文件夹"><a href="#libs文件夹" class="headerlink" title="libs文件夹"></a>libs文件夹</h3><p>软件class和百度统计的dex文件</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--百度统计服务</span></span><br><span class="line">StatService()</span><br><span class="line">.setAppKey(<span class="string">&quot;&quot;</span>) <span class="comment">--统计id</span></span><br><span class="line">.start(this)</span><br></pre></td></tr></table></figure><h3 id="res文件夹"><a href="#res文件夹" class="headerlink" title="res文件夹"></a>res文件夹</h3><p>软件使用的图片，字体</p><h2 id="开源相关"><a href="#开源相关" class="headerlink" title="开源相关"></a>开源相关</h2><div class="note primary simple"><p>致谢<br>软件开发以来，使用了部分开源项目。有作者信息的统计如下：</p><ul><li>Nimoaix制作（QQ：<psw>1650656895</psw>）</li><li>由XMSUI1二改(XMSUI1作者QQ：<psw>1650656895</psw>)</li><li>XMSUI1由悬浮窗3d二改（悬浮窗3d作者QQ：<psw>1650656895</psw>)</li><li>作者 Error</li><li>作者：Paixs</li><li>爱梅の日常</li><li>oゞ夜色乄未央ぁ</li><li>苦小怕</li><li>狸猫🐱</li></ul></div><p>部分作者在开源项目中留下了QQ，我就默认允许公布其QQ。其他作者未主动公开，就仅留名。</p><div class="note success flat"><p>『弹幕笔记』开源相关<br>体验APP：<a href="https://nrhs.eu.org/app/">https://nrhs.eu.org/app/</a><br>开源文件：<a href="http://47.115.206.192:5244/%E5%A5%87%E6%80%AA%E7%9A%84%E5%B7%A5%E5%85%B7/APK/%E5%BC%B9%E5%B9%95%E7%AC%94%E8%AE%B0">弹幕笔记历史版本及开源文件</a> 自部署云盘，报错请多次刷新<br>备用资源：<a href="https://nrhs.lanzoul.com/b0fa9n2xi">APP</a> <a href="https://nrhs.lanzoul.com/b0fa9n39a">alp文件</a> <psw>提取密码：bullet</psw><br>Andlua+：由于官方网站已关闭，附我使用的<a href="http://47.115.206.192:5244/d/%E5%A5%87%E6%80%AA%E7%9A%84%E5%B7%A5%E5%85%B7/APK/Andlua%2B7.0_bate.apk">版本</a><br>讨论区：<a href="https://support.qq.com/embed/phone/427645/team/">软件讨论区及问题反馈</a>   <a href="https://support.qq.com/products/427645/faqs-more?id=126272">保姆使用流程</a><br>开源协议：你可以不经作者许可二次修改，分发软件。但你需要留下作者信息，同时，你的软件不得用于商业用途。</p></div><p><img src="https://pic.imgdb.cn/item/63771f0016f2c2beb1608dfe.jpg" alt=""></p><div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><p>若有相关问题可在博客下或者讨论区留言</p></div>]]></content>
    
    
    <summary type="html">我喜欢一些奇奇怪怪的东西，即使我不会以此谋生。但我喜欢有能力实现自己想法的自己。</summary>
    
    
    
    <category term="食用指南" scheme="https://nrhs-space.github.io/categories/%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    
    
    <category term="弹幕笔记" scheme="https://nrhs-space.github.io/tags/%E5%BC%B9%E5%B9%95%E7%AC%94%E8%AE%B0/"/>
    
    <category term="开源" scheme="https://nrhs-space.github.io/tags/%E5%BC%80%E6%BA%90/"/>
    
    <category term="lua" scheme="https://nrhs-space.github.io/tags/lua/"/>
    
  </entry>
  
  <entry>
    <title>桌面拓展及优雅的设备流转</title>
    <link href="https://nrhs-space.github.io/2022/10/16/extend_device/"/>
    <id>https://nrhs-space.github.io/2022/10/16/extend_device/</id>
    <published>2022-10-16T06:15:00.000Z</published>
    <updated>2022-11-13T07:01:15.184Z</updated>
    
    <content type="html"><![CDATA[<p>很多时候，一块电脑屏幕并不能优雅的满足我的需求。我总是想分一个窗口浏览网页，一个回消息，一个看图片。但是一块屏幕完全不够分。</p><p>屏幕我没有，但二手机我不缺。如何优雅的将他们组合起来才是该思考的问题。</p><p>公网上屏幕共享完全不需要考虑，极高的延时，糟糕的画质，还有…难看的吃相。</p><p>局域网内才是我们为所欲为的地方。</p><h1 id="安装spacedesk"><a href="#安装spacedesk" class="headerlink" title="安装spacedesk"></a>安装spacedesk</h1><p><code>spacedesk</code>轻松打通了PC，安卓，平板。使其在局域网内可以优雅的将多于的手机屏幕，平板屏幕等作为电脑的拓展屏幕。</p><p>安装它也很简单，在<a href="https://www.spacedesk.net/#download">官网</a>下载你需要的客户端即可。</p><p><img src="https://pic1.imgdb.cn/item/634baae216f2c2beb1026c40.jpg" alt=""></p><p>再顺便下载个手机端，打开手机端，会自动查找局域网下存在的电脑。点击连接就行啦。</p><p><img src="https://pic1.imgdb.cn/item/634bad4816f2c2beb106f2c6.jpg" alt=""></p><h1 id="QTscrcpy局域网控制"><a href="#QTscrcpy局域网控制" class="headerlink" title="QTscrcpy局域网控制"></a>QTscrcpy局域网控制</h1><p>但这样极不优雅的问题是，我只是将其当作了屏幕。但我无法控制我的手机。</p><p>使用开源项目<a href="https://github.com/Genymobile/scrcpy">scrcpy</a>可以解决这个问题。用USB线连接电脑，使用adb调试，就可以在电脑上映射出手机。</p><p>同样也支持方向控制。局域网内延迟极低，支持无线连接。</p><div class="note purple icon simple"><i class="note-icon far fa-hand-scissors"></i><p>更建议使用基于此开源项目的<a href="https://gitee.com/Barryda/QtScrcpy">QTscrcpy</a> </p></div><p><img src="https://pic1.imgdb.cn/item/634baeb216f2c2beb1096398.jpg" alt=""></p><p><img src="https://pic1.imgdb.cn/item/634baf0316f2c2beb109f2c4.jpg" alt=""></p><div class="note primary modern"><p>第一次不能直接使用无线连接。需要使用USB线连接电脑，开启USB调试模式。</p></div><p><img src="https://pic1.imgdb.cn/item/634baf6f16f2c2beb10ab2ee.jpg" alt=""></p><p>不出意外的话，你就可以在<code>QTscrcpy</code>的界面上找到你的手机，双击连接即可。就可以在电脑上即时操作你的手机。</p><h1 id="hamibot公网控制"><a href="#hamibot公网控制" class="headerlink" title="hamibot公网控制"></a>hamibot公网控制</h1><p>有如果我需要在公网上访问呢？局域网显然不能优雅的解决。</p><p>我们可以在本地部署一个<a href="https://hamibot.com/">hamibot客户端</a></p><p><img src="https://pic1.imgdb.cn/item/634bb09916f2c2beb10ca481.jpg" alt=""></p><p>只要你的局域网能被公网所访问，你就可以使用它完成你想要完成的任何事情，包括解锁。</p><p><code>hamibot</code>基于<code>Auto.js</code>运行，方便的在本地完成各种各样的自动化操作。</p><p>一方面可以在脚本市场中找免费脚本</p><p><img src="https://pic1.imgdb.cn/item/634bb13716f2c2beb10da21c.jpg" alt=""></p><p>也可以使用<a href="https://hyb1996.github.io/AutoJs-Docs/#/?id=%e7%bb%bc%e8%bf%b0">Auto.js</a>自己写一个小脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//back()</span><br><span class="line">//home()</span><br><span class="line">//powerDialog() //电源窗口</span><br><span class="line">//recents() //最近任务</span><br><span class="line">//notifications() //通知栏</span><br><span class="line">//console.show() //显示调试窗口</span><br><span class="line">//alert(&quot;出现错误~&quot;); //对话框</span><br><span class="line">launch(&quot;nrhs.start&quot;); //运行某APP，填写包名</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h1 id="自启动辅助"><a href="#自启动辅助" class="headerlink" title="自启动辅助"></a>自启动辅助</h1><p>还剩下一个问题，我不能优雅的开启USB调试，也不能很快确定程序包名。</p><p>所以我们写一个小程序，来完成这些事情。</p><p><img src="https://pic1.imgdb.cn/item/634bb30b16f2c2beb110b2fa.jpg" alt=""></p><p><img src="https://pic1.imgdb.cn/item/634bb31616f2c2beb110c740.jpg" alt=""></p><p>程序运行即会检测是否横屏，如果横屏将判定为作为屏幕拓展。将尝试开启USB调试。</p><p>也可以查看手机所安装的所有应用名称，包名。</p><p>只需要一句话启动</p><p><code>launch(&quot;nrhs.start&quot;);</code></p><p>嗯，够优雅了.</p><h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><div class="note green no-icon flat"><p>Spacedesk：<br>官网：<a href="https://www.spacedesk.net/#download">https://www.spacedesk.net/#download</a><br>花的小金库：<a href="http://pan.nrhs.tk/d/%E5%A5%87%E6%80%AA%E7%9A%84%E5%B7%A5%E5%85%B7/PC/%E5%B0%8F%E5%B7%A5%E5%85%B7/spacedeskConsole%E5%B1%80%E5%9F%9F%E7%BD%91%E5%B1%8F%E5%B9%95%E6%8B%93%E5%B1%95.zip">安全不限速，包含汉化版本，手机端</a></p></div><div class="note green no-icon flat"><p>QTscrcpy：<br>官网：<a href="https://gitee.com/Barryda/QtScrcpy">https://gitee.com/Barryda/QtScrcpy</a><br>花的小金库：<a href="http://pan.nrhs.tk/d/%E5%A5%87%E6%80%AA%E7%9A%84%E5%B7%A5%E5%85%B7/PC/%E5%B0%8F%E5%B7%A5%E5%85%B7/QtScrcpy-win-x64-v2.0.1_USB%E6%98%A0%E5%B0%84%E6%89%8B%E6%9C%BA.zip">安全不限速</a></p></div>]]></content>
    
    
    <summary type="html">优雅的将多个屏幕拓展为电脑桌面，麻麻再也不担心我做作业不能看电影了</summary>
    
    
    
    <category term="食用指南" scheme="https://nrhs-space.github.io/categories/%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    
    
    <category term="自动化" scheme="https://nrhs-space.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>树莓派备忘录</title>
    <link href="https://nrhs-space.github.io/2022/10/14/raspi/"/>
    <id>https://nrhs-space.github.io/2022/10/14/raspi/</id>
    <published>2022-10-14T03:49:19.000Z</published>
    <updated>2022-12-05T02:37:49.062Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础操作"><a href="#基础操作" class="headerlink" title="基础操作"></a>基础操作</h1><hr><h2 id="树莓派无屏幕连接"><a href="#树莓派无屏幕连接" class="headerlink" title="树莓派无屏幕连接"></a>树莓派无屏幕连接</h2><ol><li>ssh连接ip</li><li>sudo raspi-config开启vnc服务</li><li>登陆提示无屏幕</li><li>ssh连接进入设置，改变分辨率大小，重启</li><li>vnc连接，显示不完全<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.config/lxpanel/LXDE-pi/panels</span><br><span class="line"></span><br><span class="line">curl -O https://gist.githubusercontent.com/ColinNg/9ed317308a9a0f75824f828e75c8469c/raw/a72176416201a0e6ebbce30608e6f7eceb379e0e/panel</span><br><span class="line"></span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure></li></ol><blockquote><p><a href="https://shumeipai.nxez.com/2015/06/28/raspberry-pi-date-and-time-correction-method-allowed.html">修正时间</a></p></blockquote><h2 id="开启ssh"><a href="#开启ssh" class="headerlink" title="开启ssh"></a>开启ssh</h2><blockquote><p>boot目录下创建ssh文件，默认ssh账户pi密码为raspberry</p></blockquote><ul><li>修改pi用户的ssh密码:<code>sudo passwd pi</code></li></ul><h2 id="配置Wifi连接及网络"><a href="#配置Wifi连接及网络" class="headerlink" title="配置Wifi连接及网络"></a>配置Wifi连接及网络</h2><p>使用nano修改<code>/etc/wpa_supplicant/wpa_supplicant.conf</code>文件，仿照原配置继续写</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo   iwlist wlan0  scan --扫描周围wifi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure><p>例如配置，其中<code>priority=5</code>值越高等级越高，优先连接权更高</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev</span><br><span class="line">update_config=1</span><br><span class="line">country=CN</span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line">        ssid=&quot;Three-Body&quot;</span><br><span class="line">        psk=&quot;qwertyuiop&quot;</span><br><span class="line">        priority=5</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line">        ssid=&quot;360 N7 Lite&quot;</span><br><span class="line">        psk=&quot;zxcvbnml&quot;</span><br><span class="line">        priority=2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">network=&#123;</span><br><span class="line">        ssid=&quot;SXYYC&quot;</span><br><span class="line">        key_mgmt=NONE</span><br><span class="line">        priority=1</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>首次烧录镜像的话，在boot目录下创建<code>wpa_supplicant.conf</code>即可</li></ul><h2 id="定时执行任务"><a href="#定时执行任务" class="headerlink" title="定时执行任务"></a>定时执行任务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e 编辑命令，首次选择nano</span><br><span class="line">crontab -l 查看任务</span><br></pre></td></tr></table></figure><p>取消了秒</p><p>P.<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/1 * * * *  python3 /home/pi/nrhs_pi/pi_py/ip.py 每分钟执行一次py脚本</span><br></pre></td></tr></table></figure></p><h2 id="仪表盘安装"><a href="#仪表盘安装" class="headerlink" title="仪表盘安装"></a><a href="https://make.quwj.com/project/10">仪表盘安装</a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nginx php7.4-fpm php7.4-cli php7.4-curl php7.4-gd php7.4-cgi</span><br><span class="line"></span><br><span class="line"># 由于教程过时，在2022年应该使用php7.4</span><br><span class="line"># 若提示无法找到包，请换成7.3</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line">index  index.html index.htm index.php default.html default.htm default.php;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">location ~\.php$ &#123;</span><br><span class="line">fastcgi_pass unix:/run/php/php7.4-fpm.sock;</span><br><span class="line">#fastcgi_pass 127.0.0.1:9000;</span><br><span class="line">fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;</span><br><span class="line">include fastcgi_params;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重启nginx:<code>sudo service nginx restart</code></p><p>git克隆：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install git</span><br><span class="line"></span><br><span class="line">cd /var/www/html</span><br><span class="line"></span><br><span class="line">sudo git clone https://github.com/nxez/pi-dashboard.git</span><br></pre></td></tr></table></figure></p><h2 id="重新安装chromium浏览器"><a href="#重新安装chromium浏览器" class="headerlink" title="重新安装chromium浏览器"></a>重新安装chromium浏览器</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update/sudo apt full-upgrade 升级与完整包升级</span><br><span class="line"></span><br><span class="line">sudo apt install chromium-browser -y 安装chromium-browser</span><br><span class="line"></span><br><span class="line">chromium-browser 启动</span><br></pre></td></tr></table></figure><h2 id="ftp服务安装"><a href="#ftp服务安装" class="headerlink" title="ftp服务安装"></a>ftp服务安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vsftpd   安装vstfpd</span><br><span class="line"></span><br><span class="line">sudo service vsftpd start 启动服务</span><br><span class="line"></span><br><span class="line">sudo nano /etc/vsftpd.conf   编辑vsftdp的配置文件</span><br></pre></td></tr></table></figure><p>编辑：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">anonymous_enable=NO  不允许匿名访问</span><br><span class="line"></span><br><span class="line">local_enable=YES  设定本地用户可以访问。</span><br><span class="line"></span><br><span class="line">write_enable=YES  设定可以进行写操作</span><br><span class="line"></span><br><span class="line">local_umask=022   设定上传后文件的权限掩码。</span><br></pre></td></tr></table></figure></p><p>重启:<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service vsftpd restart</span><br></pre></td></tr></table></figure></p><p>上传文件名包含中文时可能会乱码，在linux下无法正常显示。这是因为windows文件名默认GBK编码，而linux是UTF—8。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install convmv -y   --安装convmv文件转码工具</span><br><span class="line"></span><br><span class="line">convmv -f gbk -t utf-8 -r --notest /home/要操作的文件或者文件夹</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/mlgjb/p/9747315.html">转码完成即解决</a></p><h2 id="文件夹及文件操作"><a href="#文件夹及文件操作" class="headerlink" title="文件夹及文件操作"></a>文件夹及文件操作</h2><blockquote><p>移动复制删除文件夹</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo mv FMmp3 /home/pi/nrhs_pi/pi_web/将当前目录下的FMmp3移动到指定目录</span><br><span class="line"></span><br><span class="line">sudo mv /usr/xu/* .将/usr/xu中的所有文件移到当前目录（.表示当前）</span><br><span class="line"></span><br><span class="line">sudo cp dir1/a.doc dir2 表示将dir1下的a.doc文件复制到dir2目录下</span><br><span class="line"></span><br><span class="line">sudo rm -rf mp3删除了当前目录下mp3文件夹，可跟目录。</span><br><span class="line"></span><br><span class="line">sudo rm -f /var/log/httpd/access.log强制删除/var/log/httpd/access.log文件</span><br></pre></td></tr></table></figure><p>文件及文件夹更名：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mv FMmp3 mp3 将FMmp3改名为mp3</span><br></pre></td></tr></table></figure></p><blockquote><p>权限设置</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 folder_path</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>修改密码</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd pi                   #修改 pi 密码  </span><br><span class="line">sudo passwd root                 #设置 root 密码    </span><br><span class="line">su root                          #切换到 root 用户  </span><br><span class="line">su pi                            #切换到 pi 用户 </span><br></pre></td></tr></table></figure><blockquote><p>find寻找</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -iname &quot;sshd_config&quot; # 寻找文件夹</span><br></pre></td></tr></table></figure><h2 id="时间设置"><a href="#时间设置" class="headerlink" title="时间设置"></a><a href="https://blog.csdn.net/github_38111866/article/details/76057237">时间设置</a></h2><p>调整时区<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg-reconfigure tzdata 打开设置</span><br><span class="line"></span><br><span class="line">选择Asia亚洲shanghai时间</span><br><span class="line"></span><br><span class="line">sudo ntpd -s -d 矫正时间</span><br><span class="line"></span><br><span class="line">//sudo date  --s=&quot;2017-07-25 10:43:00&quot; 强制设置时间</span><br><span class="line"></span><br><span class="line">date 显示时间</span><br></pre></td></tr></table></figure></p><h2 id="更换源"><a href="#更换源" class="headerlink" title="更换源"></a>更换源</h2><p>编辑<code>/etc/apt/sources.list</code>文件<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">注释原来源，换为清华大学源</span><br><span class="line"></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib</span><br><span class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main non-free contrib</span><br></pre></td></tr></table></figure></p><p>编辑<code>/etc/apt/sources.list.d/raspi.list</code>文件<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list.d/raspi.list</span><br><span class="line"></span><br><span class="line">注释原来源，换为清华大学源</span><br><span class="line"></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui</span><br></pre></td></tr></table></figure></p><blockquote><p>更新软件库及依赖<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update --更新软件源</span><br><span class="line">apt list --upgradable --更新了哪些内容</span><br><span class="line"></span><br><span class="line">sudo apt upgrade --升级所有软件，时间漫长，慎重</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="开启及关闭GUI"><a href="#开启及关闭GUI" class="headerlink" title="开启及关闭GUI"></a><a href="https://www.cxyzjd.com/article/qq_42908042/91129443">开启及关闭GUI</a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo raspi-config # 打开设置</span><br><span class="line"></span><br><span class="line">boot options # boot设置</span><br><span class="line"></span><br><span class="line"># 选择console Autologin Text console</span><br></pre></td></tr></table></figure><h1 id="进阶应用"><a href="#进阶应用" class="headerlink" title="进阶应用"></a>进阶应用</h1><p>由于树莓派内存较小，<code>mysql</code>有点大，我的学习资料都跑不起来了。</p><h2 id="安装SQLite"><a href="#安装SQLite" class="headerlink" title="安装SQLite"></a>安装SQLite</h2><p>一般来讲，Linux一般已内置<a href="https://www.runoob.com/sqlite/sqlite-tutorial.html">SQLite</a><br><a href="https://www.labno3.com/2021/03/25/setting-up-an-sqlite-database-on-a-raspberry-pi/">示例教程</a></p><p>检查”<code>SQLite3</code>“</p><blockquote><p>未安装</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line"></span><br><span class="line">sudo apt install sqlite3</span><br></pre></td></tr></table></figure><blockquote><p>启动</p></blockquote><p>命令行下SQLite3会出现版本号和sql命令行</p><h2 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 SQLite-name.db在外命令行下直接创建</span><br><span class="line"></span><br><span class="line">sqlite&gt;.open SQLite-name.dbSQLite命令行下创建，标识为(sqlite&gt;)</span><br><span class="line">//.open会检查数据库时候存在，存在就打开，不存在就创建</span><br><span class="line"></span><br><span class="line">sqlite&gt;.databases查看数据库列表</span><br><span class="line"></span><br><span class="line">sqlite&gt;.quit退出数据库操作</span><br><span class="line">//CTRL+D一样</span><br></pre></td></tr></table></figure><h2 id="PHP调用"><a href="#PHP调用" class="headerlink" title="PHP调用"></a><a href="https://www.runoob.com/sqlite/sqlite-php.html">PHP调用</a></h2><p>请参阅<a href="https://www.runoob.com/sqlite/sqlite-php.html">PHP_SQLite菜鸟教程</a>，<a href="https://www.runoob.com/php/php-tutorial.html">PHP菜鸟教程</a></p><blockquote><p>PHP中连接数据库并遍历数据按html模板输出</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">      <span class="meta">&lt;?php</span></span><br><span class="line">      <span class="class"><span class="keyword">class</span> <span class="title">MyDB</span> <span class="keyword">extends</span> <span class="title">SQLite3</span></span></span><br><span class="line"><span class="class">      </span>&#123;</span><br><span class="line">          <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">          </span>&#123;</span><br><span class="line">              <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">open</span>(<span class="string">&#x27;../pi_sql_web.db&#x27;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="variable">$db</span> = <span class="keyword">new</span> <span class="title function_ invoke__">MyDB</span>();</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable">$db</span>) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">lastErrorMsg</span>();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">//echo &quot;Opened database successfully\n&quot;;</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="variable">$sql</span> = <span class="string">&lt;&lt;&lt;EOF</span></span><br><span class="line"><span class="string">      SELECT * from desk_project;</span></span><br><span class="line"><span class="string">EOF</span>;</span><br><span class="line"></span><br><span class="line">      <span class="variable">$ret</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">      <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$ret</span>-&gt;<span class="title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC)) &#123;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;shortcut&quot; onclick=&quot;Win10.openUrl(\&#x27;&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;url&#x27;</span>].<span class="string">&#x27;\&#x27;,</span></span><br><span class="line"><span class="string">          \&#x27;&lt;img class=\\\&#x27;icon\\\&#x27; src=\\\&#x27;&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;ico&#x27;</span>].<span class="string">&#x27;\\\&#x27;/&gt;终端操作\&#x27;)&quot;&gt;&#x27;</span>;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&#x27;&lt;img class=&quot;icon&quot; src=&quot;&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;ico&#x27;</span>].<span class="string">&#x27;&quot; /&gt;&#x27;</span>;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;title&quot;&gt;&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>PHP执行一段SQL并拿到值</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM pi_cyan ORDER BY RANDOM() limit 1;&quot;</span>;</span><br><span class="line">    <span class="variable">$ret</span> = <span class="variable">$db</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$ret</span>-&gt;<span class="title function_ invoke__">fetchArray</span>(SQLITE3_ASSOC)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;title&quot;&gt;&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;cyan&#x27;</span>].<span class="string">&#x27;&amp;nbsp;&amp;nbsp;&amp;nbsp;__@&#x27;</span>.<span class="variable">$row</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Pytho调用"><a href="#Pytho调用" class="headerlink" title="Pytho调用"></a>Pytho调用</h2><blockquote><p>读，查数据库</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"></span><br><span class="line">conn = sqlite3.connect(<span class="string">&#x27;----||test.db&#x27;</span>)    <span class="comment"># 应当使用绝对路径，否则不能正确读库</span></span><br><span class="line">c = conn.cursor()</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;数据库打开成功&quot;</span>)</span><br><span class="line"></span><br><span class="line">cursor = c.execute(<span class="string">&quot;SELECT id, name, address, salary  from COMPANY&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> cursor:</span><br><span class="line">   <span class="built_in">print</span> <span class="string">&quot;ID = &quot;</span>, row[<span class="number">0</span>]</span><br><span class="line">   <span class="built_in">print</span> <span class="string">&quot;NAME = &quot;</span>, row[<span class="number">1</span>]</span><br><span class="line">   <span class="built_in">print</span> <span class="string">&quot;ADDRESS = &quot;</span>, row[<span class="number">2</span>]</span><br><span class="line">   <span class="built_in">print</span> <span class="string">&quot;SALARY = &quot;</span>, row[<span class="number">3</span>], <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;数据操作成功&quot;</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><blockquote><p>python一键换源<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure></p></blockquote><h2 id="树莓派进程守护"><a href="#树莓派进程守护" class="headerlink" title="树莓派进程守护"></a>树莓派进程守护</h2><blockquote><p><a href="https://shumeipai.nxez.com/2020/06/30/linux-usage-systemd.html">树莓派进程守护systemd</a></p></blockquote><p>在<code>/usr/lib/systemd/system/</code>目录下新建<code>service</code>文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /usr/lib/systemd/system/alist.service</span><br></pre></td></tr></table></figure><p>写入配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=alist   --名称</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">WorkingDirectory=path_alist  --alist安装目录，下同</span><br><span class="line">ExecStart=path_alist/alist-xxxx -conf data/config.json   --</span><br><span class="line">Restart=on-failure</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure><ul><li>启动: systemctl start alist</li><li>关闭: systemctl stop alist</li><li>自启: systemctl enable alist</li><li>状态: systemctl status alist</li><li>重启: systemctl restart alist</li></ul><blockquote><p>screen</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">screen -S project_name  创建</span><br><span class="line"></span><br><span class="line">screen -r project_name  进入已有的窗口</span><br><span class="line"></span><br><span class="line">screen -ls</span><br><span class="line"></span><br><span class="line">CTRL+A 选中 d隐藏</span><br><span class="line"></span><br><span class="line">kill name_or_id 杀死进程</span><br></pre></td></tr></table></figure><h2 id="内网穿透"><a href="#内网穿透" class="headerlink" title="内网穿透"></a>内网穿透</h2><p>frp：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frpc -c ./frpc.ini   启动</span><br></pre></td></tr></table></figure></p><p>1.尝试破解邻居wifi—-失败5，成功1<br>    (1).房屋内信号奇差，遂开始研究无线中继</p><pre><code>    [1].尝试esp8266开发板中继        1).因淘宝买到崴货失败    [2].尝试树莓派搭建中继服务---树莓派2楼掉下干碎，维修￥15    [3].中继搭建成功        1).WiFi芯片功率较低而速度极慢，放弃    [4].开始研究无线网卡作为AP中继        1).因无线网卡芯片不支持Linux失败。。。    [5].开始研究USB网络共享        1).因拼多多买到崴货数据线失败</code></pre><p>2.尝试钓鱼执法偷密码—-因技术原因失败</p><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 40%" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"><p>更新于2022.6</p></div></div><h2 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h2><blockquote><p>首先查看树莓派是否已自带docker</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker -v</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://blog.csdn.net/wzhrsh/article/details/116230165">卸载与重装</a></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">#卸载docker</span><br><span class="line">sudo apt-get remove docker</span><br><span class="line">sudo apt-get remove docker-engine docker.io</span><br><span class="line">#卸载docker-ce</span><br><span class="line">sudo apt-get remove docker-ce</span><br><span class="line">#卸载安装依赖</span><br><span class="line">sudo apt-get autoremove --purge docker-ce</span><br><span class="line">上面的命令不会移除镜像、容器、卷或者是用户创建的配置文件，如果想卸载所有的镜像、容器、卷，可运行</span><br><span class="line">rm -rf /var/lib/docker</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br><span class="line">首先安装依赖</span><br><span class="line">sudo apt-get install apt-transport-https ca-certificates curl gnupg2 software-properties-common</span><br><span class="line">信任 Docker 的 GPG 公钥</span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><br><span class="line">对于 amd64 架构的计算机，添加软件仓库</span><br><span class="line"> </span><br><span class="line">sudo add-apt-repository \</span><br><span class="line"> &quot;deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu \</span><br><span class="line">$(lsb_release -cs) \</span><br><span class="line">stable&quot;</span><br><span class="line">最后安装</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install docker-ce</span><br><span class="line">把当前用户加到docker用户组中</span><br><span class="line">添加docker用户组</span><br><span class="line"> </span><br><span class="line">sudo groupadd docker</span><br><span class="line"> </span><br><span class="line">把自己加到docker用户组中</span><br><span class="line"> </span><br><span class="line">#myusername   是你自己的用户名</span><br><span class="line">sudo gpasswd -a myusername docker</span><br><span class="line"> </span><br><span class="line">重启docker后台服务</span><br><span class="line"> </span><br><span class="line">sudo service docker restart</span><br><span class="line">切换当前用户到新group</span><br><span class="line"> </span><br><span class="line">newgrp - docker</span><br><span class="line">确定docker可以非sudo运行</span><br><span class="line"> </span><br><span class="line">docker ps --查看所有项目</span><br><span class="line"></span><br><span class="line">sudo docker run hello-world --测试docker是否成功安装</span><br><span class="line"></span><br><span class="line">将会输出`Hello from Docker!`</span><br><span class="line">--------------------------------------------------</span><br><span class="line"></span><br><span class="line">#下载 Docker 图形化界面 portainer</span><br><span class="line">sudo docker pull portainer/portainer</span><br><span class="line">#创建 portainer 容器</span><br><span class="line">sudo docker volume create portainer_data</span><br><span class="line">#运行 portainer</span><br><span class="line">sudo docker run -d -p 9000:9000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer</span><br><span class="line"></span><br><span class="line">--------------------------------------------------</span><br><span class="line">#重启 systemctl 守护进程</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">#设置 Docker 开机启动</span><br><span class="line">sudo systemctl enable docker</span><br><span class="line">#开启 Docker 服务</span><br><span class="line">sudo systemctl start docker</span><br><span class="line"># 重启</span><br><span class="line">systemctl daemon-reload</span><br><span class="line"> </span><br><span class="line">systemctl restart docker</span><br><span class="line"># sudo systemctl disable docker 取消开机自启</span><br></pre></td></tr></table></figure><blockquote><p>进入容器虚拟目录</p></blockquote><p>docker container exec -it 容器id /bin/bash</p><h2 id="部署alist"><a href="#部署alist" class="headerlink" title="部署alist"></a>部署alist</h2><p>官方文档，docker安装</p><h1 id="部分问题"><a href="#部分问题" class="headerlink" title="部分问题"></a>部分问题</h1><blockquote><p>apt-get安装中的E: Sub-process /usr/bin/dpkg returned an error code (1)问题</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/dpkg/</span><br><span class="line">sudo mv info/ info_bak          # 现将info文件夹更名</span><br><span class="line">sudo mkdir info                 # 再新建一个新的info文件夹</span><br><span class="line">sudo apt-get update             # 更新</span><br><span class="line">sudo apt-get -f install         # 修复</span><br><span class="line">sudo mv info/* info_bak/        # 执行完上一步操作后会在新的info文件夹下生成一些文件，现将这些文件全部移到info_bak文件夹下</span><br><span class="line">sudo rm -rf info                # 把自己新建的info文件夹删掉</span><br><span class="line">sudo mv info_bak info           # 把以前的info文件夹重新改回名</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">树莓派可好吃了...</summary>
    
    
    
    <category term="学习笔记" scheme="https://nrhs-space.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="树莓派" scheme="https://nrhs-space.github.io/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
  </entry>
  
  <entry>
    <title>感谢陪伴</title>
    <link href="https://nrhs-space.github.io/2022/09/30/meet_and_leave/"/>
    <id>https://nrhs-space.github.io/2022/09/30/meet_and_leave/</id>
    <published>2022-09-30T10:11:54.000Z</published>
    <updated>2022-10-09T15:40:32.077Z</updated>
    
    <content type="html"><![CDATA[<p>十年，又有多长呢？</p><p>十年，是我从小学到大学的距离；是母亲青丝变白发的距离；也是一段物是人非的距离。它也是你陪伴我生活的距离。</p><p>不应为你感到悲伤，一个人正常的老去再死掉已是无比幸运，更何况你只是一只小小的小狗。</p><p>也不应说为你来世祝愿，我一直不大相信来世今生之说。倘若今生的生活还要依靠上世的修行，那是何等可悲。</p><p>更不能为你树立一块小小的石碑，因为你连名字都还没有呢！</p><p>于是，也便只好说感谢这十几年来的陪伴。</p><p>再见.</p><p><img src="https://pic1.imgdb.cn/item/6342e0d916f2c2beb145c6b5.jpg" alt=""></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;十年，又有多长呢？&lt;/p&gt;
&lt;p&gt;十年，是我从小学到大学的距离；是母亲青丝变白发的距离；也是一段物是人非的距离。它也是你陪伴我生活的距离。&lt;/p&gt;
&lt;p&gt;不应为你感到悲伤，一个人正常的老去再死掉已是无比幸运，更何况你只是一只小小的小狗。&lt;/p&gt;
&lt;p&gt;也不应说为你来世祝愿，</summary>
      
    
    
    
    <category term="城南旧事" scheme="https://nrhs-space.github.io/categories/%E5%9F%8E%E5%8D%97%E6%97%A7%E4%BA%8B/"/>
    
    
    <category term="城南旧事" scheme="https://nrhs-space.github.io/tags/%E5%9F%8E%E5%8D%97%E6%97%A7%E4%BA%8B/"/>
    
  </entry>
  
  <entry>
    <title>主不在乎</title>
    <link href="https://nrhs-space.github.io/2022/07/17/stars/"/>
    <id>https://nrhs-space.github.io/2022/07/17/stars/</id>
    <published>2022-07-17T02:47:31.000Z</published>
    <updated>2022-07-17T03:16:15.791Z</updated>
    
    <content type="html"><![CDATA[<h1 id="星月"><a href="#星月" class="headerlink" title="星月"></a>星月</h1><p>敲完脚本最后一行，我看着手机成像的逐渐清晰，几片沉睡的树叶在山谷风下微微起伏，开始唱起梵高的星空。我同月亮在伴奏中沉沉睡去。</p><p>我是被冷醒的，亚热带季风气候似乎已被接替。月亮已经移到了脑后对着山坡撒下一片白蒙蒙的温柔。流星短暂划过天空的一角，拉出一道小小的光亮又猝然不见。</p><p>手机还在忠实的拍摄，长时间曝光后成像的一瞬间刻画下不属于肉眼的微亮，树还在伴奏。</p><p>再醒来时，东方鱼白，只剩下启明星还在等我醒来。手机上一团过曝的光亮预示着拍摄还在进行，但已没有必要。我检查起昨夜的拍摄的一千张照片，期待拍到群星乱舞变成流动的星月夜，亦或者倒计时尽头为我闪烁的整个宇宙。</p><p>星夜在暗沉的幕布上缓缓移动，星轨开始一圈一圈展现。没有星月夜，宇宙也没有为我闪烁。有的只是无尽岁月所展示的一个平凡的夜。</p><div class="video"><video controls preload><source src='https://dpv.videocc.net/6358b82195/2/6358b821959f1c6be7bba7024cdc6592_3.mp4?pid=1658026441723X1781612' type='video/mp4'>Your browser does not support the video tag.</video></div><hr><div class="tip info"><p>ISO：3200<br>曝光时间：20s<br>对焦距离：无限远<br>拍摄样片：1000张<br>拍摄自动化：FV悬浮球自动化流程<br>星轨：Pr残影效果</p></div>]]></content>
    
    
    <summary type="html">没有星月夜，宇宙也没有为我闪烁。有的只是无尽岁月所展示的一个平凡的夜。还有，主不在乎</summary>
    
    
    
    <category term="食用指南" scheme="https://nrhs-space.github.io/categories/%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    
    
    <category term="摄影" scheme="https://nrhs-space.github.io/tags/%E6%91%84%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>e为什么是自然常数</title>
    <link href="https://nrhs-space.github.io/2022/05/14/nature_e/"/>
    <id>https://nrhs-space.github.io/2022/05/14/nature_e/</id>
    <published>2022-05-14T01:41:16.000Z</published>
    <updated>2022-05-14T03:26:16.049Z</updated>
    
    <content type="html"><![CDATA[<p>在高中时，我无数次计算过<code>e</code>这个数。它常常伴随着各种奇奇怪怪的函数，方程出现。但老师只教过我怎样去算它，<code>e</code>约等于2.718…<code>e</code>的导数还是<code>e</code>……</p><p>我也一直难以理解这个数，直到一次偶然机会，我才发现，<code>e</code>真是太神奇了！</p><h2 id="e的历史"><a href="#e的历史" class="headerlink" title="e的历史"></a>e的历史</h2><p>我们在<a href="https://baike.baidu.com/item/%E8%87%AA%E7%84%B6%E5%B8%B8%E6%95%B0/1298918">百度百科</a>上搜一下”e”，解释是：</p><p><img src="https://s1.ax1x.com/2022/05/14/O6eOkF.jpg" alt=""></p><p>数学对它的定义是“自然常数”。我对于常数的理解一直是，不会随着时间变换而变换的数。它就像明天一定会到来一样固定。</p><p>但它为什么自然呢？</p><h2 id="简单比喻"><a href="#简单比喻" class="headerlink" title="简单比喻"></a>简单比喻</h2><p>我们以银行存钱来比喻。银行存钱一般以年利率来计算，存一块钱，年利率3%。一年后就可以得到1.03块钱。</p><p>我们假如有一个银行的利率是100%，那么，存1块钱，在一年后就应该得到2块钱。</p><p>而利率是可以拆分的，年利率可以拆分为月利率，月利率下面还有七日利率。</p><p>我们一块钱存半年，可以得到1.5元。我们再投资，1.5再存半年，应该得到1.5*(1+50%)=2.25。</p><p>没错，我们的钱钱变多了😛</p><p>如果银行允许我们无限操作，那么，我想我有了一个大胆的想法😎。</p><hr><p>但把时间拆成无数份，我们存了再取，取了再存。我们的钱钱是否真的会无限变大呢？</p><p>我们存一年，利率公式为1<em>(1+100%)=2<br>一年分为两个时间段，利率公式为1</em>(1+50%)²=2.25<br>一年分为三个时间段，利率公式为1<em>(1+33%)³=2.352<br>一年分为四个时间段，利率公式为1</em>(1+25%)⁴=2.441<br>……</p><p>时间是无限份的，我们就可以得到$\displaystyle\lim_{x\to+\infty}\left(1+\frac{1}{x}\right)^x$极限公式(第二重要极限😛)</p><p>我们对它求一下极限，它其实就是e。</p><p>我们将x带入值计算y=$\displaystyle\lim_{x\to+\infty}\left(1+\frac{1}{x}\right)^x$。也会发现，在y短暂的快速变化后，y值变化的速度越来越小，开始无限趋近于2.718…..</p><p>它就是e</p><hr><p>很久之前，我的小外甥女问我树是什么时候长高的。我说在晚上你睡着了它就开始悄悄长高了。</p><p>那它是突然一下就长高了呢还是一直在长呢？</p><p>一直在长高呢，就像你长个子一样，每时每刻都在长。</p><p>那现在它又长高了多少呢？</p><p>….</p><p>是阿，时间是无限的，是不可分割的。相比起上一刻，我们又变化了多少呢？</p><p>我想，现在有了答案。我们变化了e</p>]]></content>
    
    
    <summary type="html">很久前，我的小外甥女问我树木是什么时候长高的，我说每时每刻都在长高，那现在又长高了多少呢？我想，现在我能回答了。</summary>
    
    
    
    <category term="学习笔记" scheme="https://nrhs-space.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="数学" scheme="https://nrhs-space.github.io/tags/%E6%95%B0%E5%AD%A6/"/>
    
  </entry>
  
  <entry>
    <title>模拟器实现三层交换机互通及telnet登陆</title>
    <link href="https://nrhs-space.github.io/2022/05/09/local_network/"/>
    <id>https://nrhs-space.github.io/2022/05/09/local_network/</id>
    <published>2022-05-09T10:18:28.000Z</published>
    <updated>2022-05-09T10:18:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="思科"><a href="#思科" class="headerlink" title="思科"></a>思科</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><div class="note primary simple"><p>思科模拟器6.0<a href="https://nrhs.lanzoui.com/iOHXE04kvn4d">便携包下载</a></p></div><p>点击程序包外快捷方式或打开主程序exe启动模拟器</p><p><img src="https://s1.ax1x.com/2022/05/10/OtSjxS.jpg" alt=""></p><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>在思科模拟器中按照题目要求摆放：</p>            </div><ol><li>1个<span class='p red'>三层</span>交换机</li><li>3个<span class='p red'>二层</span>交换机</li><li>6个<span class='p red'>PC终端</span></li></ol><p><img src="https://s1.ax1x.com/2022/05/09/OYkpnS.jpg" alt=""></p><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>以太网连接交换机：</p>            </div><ol><li>2个PC为一组，分别通过以太网口连接至二层交换机</li><li>每组第一个pc终端通过<code>RS232</code>端口连接到二层交换机<code>console</code>端口</li><li>最后一个pc终端的<code>RS232</code>连接至三层交换机</li><li>二层交换机<code>fa0/24</code>与三层交换机以太网口连接</li></ol><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>IP配置：</p>            </div><ol><li>0-1号PC的IP为<u>192.168.10.2/3</u> 网关:192.168.10.1 子网掩码默认</li><li>2-3号PC的IP为<u>192.168.20.2/3</u> 网关:192.168.20.1 子网掩码默认</li><li>4-5号PC的IP为<u>192.168.30.2/3</u> 网关:192.168.30.1 子网掩码默认</li></ol><p><img src="https://s1.ax1x.com/2022/05/09/OYkkhn.jpg" alt=""></p><div class="note success simple"><p>准备工作完成╮(╯▽╰)╭</p></div><h2 id="配置二层交换机"><a href="#配置二层交换机" class="headerlink" title="配置二层交换机"></a>配置二层交换机</h2><h3 id="划分Vlan"><a href="#划分Vlan" class="headerlink" title="划分Vlan"></a>划分Vlan</h3><p>一个交换机上终端太多，很容易诱发<a href="https://baike.baidu.com/item/%E5%B9%BF%E6%92%AD%E9%A3%8E%E6%9A%B4/3574878">广播风暴</a>，瘫痪网络。划分vlan的目的就是<wavy>限制广播风暴</wavy>，更好管理网络。</p><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>PC0登陆到二层交换机<code>min-switch-0</code></p>            </div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">enable --进入特权模式</span><br><span class="line"></span><br><span class="line">configure terminal --进入全局特权模式</span><br><span class="line"></span><br><span class="line">vlan 10 --创建vlan10</span><br><span class="line"></span><br><span class="line">exit --退出</span><br><span class="line"></span><br><span class="line">interface fa0/1 --进入端口0/1</span><br><span class="line"></span><br><span class="line">switch access vlan 10 --将0/1端口加入到vlan10中</span><br><span class="line"></span><br><span class="line">exit --退出</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2022/05/10/OtS8Bj.jpg" alt=""></p><div class="note primary simple"><p>这样你就添加了fa0/1到Vlan10里。同样，把另一台pc添加到vlan里来吧。只需要注意一下是<code>0/2</code>端口哦。</p></div><h3 id="交换机更名"><a href="#交换机更名" class="headerlink" title="交换机更名"></a>交换机更名</h3><p>交换机太多，不更名很容易混淆。为了后面远程登陆辨认，快改个名称吧!</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enable --进入特权模式</span><br><span class="line"></span><br><span class="line">configure terminal --进入全局特权模式</span><br><span class="line"></span><br><span class="line">hostname min-switch-0 --更改名称为了&#x27;min-switch-0&#x27;</span><br></pre></td></tr></table></figure><h3 id="设置trunk模式"><a href="#设置trunk模式" class="headerlink" title="设置trunk模式"></a>设置<a href="http://webcast.ctocio.com.cn/wlzb/2020/0827/34386.html#:~:text=TRUNK%E6%A8%A1%E5%BC%8F%E4%B8%BB,LAN%E5%85%B1%E4%BA%AB%E7%BA%BF%E8%B7%AF%E3%80%82">trunk模式</a></h3><p><code>trunk</code>即端口汇聚，允许交换机与交换机、交换机与路由器、主机与交换机或路由器之间通过两个或多个端口并行连接同时传输以提供更高带宽、更大吞吐量， 大幅度提供整个网络能力。</p><p>尤其在一个交换机有多个<code>vlan</code>时，设置<code>trunk模式</code>可以通过一个端口传输多个vlan数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--登陆到二层交换机，并且进入全局配置模式</span><br><span class="line"></span><br><span class="line">int fa0/24 --进入到与三层交换机相连接的端口(简写了interface)</span><br><span class="line"></span><br><span class="line">sw mo trunk --设置为trunk模式(简写了switchport)</span><br><span class="line"></span><br><span class="line">sw trunk allowed vlan all --运行所有的vlan通过</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2022/05/10/OtSYEn.jpg" alt=""></p><div class="tip info"><p>大部分命令敲一半就可以按<kbd>tab</kbd>键补齐哦~<br>如果都快敲完了也不补全，很可能是你不能在当前状态下执行你的命令<br>例如：<strong>show running-config</strong>查看配置<br>在全局模式下敲show run<kbd>tab</kbd>补全，在其他状态下不会补全~</p></div><h3 id="二层交换机的远程登陆配置"><a href="#二层交换机的远程登陆配置" class="headerlink" title="二层交换机的远程登陆配置"></a>二层交换机的远程登陆配置</h3><p>远程登陆必备吧。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">--登陆到二层交换机，并且进入全局配置模式</span><br><span class="line"></span><br><span class="line">vlan 110 --创建了vlan110用于远程</span><br><span class="line"></span><br><span class="line">int vlan 110 --进入vlan110</span><br><span class="line"></span><br><span class="line">ip address 192.168.110.1 255.255.255.0 --配置它的ip地址及子网掩码</span><br><span class="line"></span><br><span class="line">no shutdown --开启端口（必须！）</span><br><span class="line"></span><br><span class="line">exit --退出</span><br><span class="line"></span><br><span class="line">ip default-getway 192.168.110.254 --设置默认网关</span><br><span class="line"></span><br><span class="line">line vty 0 4 --设置虚拟端口</span><br><span class="line"></span><br><span class="line">password 123 --设置访问密码</span><br><span class="line"></span><br><span class="line">login --登陆</span><br><span class="line"></span><br><span class="line">privilege level 15 --设置用户权限</span><br><span class="line"></span><br><span class="line">end --完成退出</span><br><span class="line"></span><br><span class="line">write --保存</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2022/05/09/OYkV10.jpg" alt=""></p><div class="tip cogs"><p>另外两台交换机类似操作哦~<br>只是需要注意：</p><ol><li>名称记得改改哦</li><li>远程登陆ip:<code>192.168.110.2/3</code></li></ol></div><h2 id="配置三层交换机"><a href="#配置三层交换机" class="headerlink" title="配置三层交换机"></a>配置三层交换机</h2><p>做到这里有点懵吧？特别是如果你尝试互相ping了一下的话。</p><p>你会发现，只是同一交换机下俩机子能ping通。其他什么都不行，远程登陆也不行的。</p><p>这就开始配置三层交换机。三层交换机才能将二层交换机互相联通。</p><hr><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>PC5登陆到三层交换机，并且进入全局配置模式</p>            </div><ol><li>划分vlan<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">vlan 10 --创建了vlan10</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">int fa0/1 --进入端口0/1(它与二层交换机相连接)</span><br><span class="line"></span><br><span class="line">no shutdown --开启端口</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">int vlan 10 --进入vlan10</span><br><span class="line"></span><br><span class="line">ip address 192.168.10.1 255.255.255.0 --配置它的ip及子网掩码</span><br><span class="line"></span><br><span class="line">no shutdown --开启vlan</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://s1.ax1x.com/2022/05/10/OtS0vF.jpg" alt=""></p><div class="tip info"><p>在这里创建<code>vlan10</code>实际上是将整个二层交换机放了进来。让第一个二层交换机的pc可以通信。</p></div><div class="tip cogs"><p>类似操作，我们分别创建<code>vlan 20</code>与<code>30</code>，将<code>fa0/2</code>与<code>0/3</code>分别放入相应的<code>vlan</code>中。</p></div><ol><li><strong>开启路由</strong></li></ol><p>让不通的交换机相互通信，当然要开启路由转发功能啦。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip routing</span><br></pre></td></tr></table></figure><p>必须有哦，不然通不了！！！</p><ol><li>三层交换机的远程登陆</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">vlan 110 --创建了vlan110(远程管理专用)</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">int vlan 110</span><br><span class="line"></span><br><span class="line">ip address 192.168.110.254 255.255.255.0 --配置它的ip地址及子网掩码</span><br><span class="line"></span><br><span class="line">no shutdown --开启端口</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">line vty 0 4 --配置虚拟端口</span><br><span class="line"></span><br><span class="line">password 123 --设置访问密码</span><br><span class="line"></span><br><span class="line">login --开启服务</span><br><span class="line"></span><br><span class="line">privilege level 15 --设置权限</span><br><span class="line"></span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">write --保存</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2022/05/10/OtSsb9.jpg" alt=""></p><div class="note green no-icon flat"><p>好啦，不出意外的话你就配置好了一台:</p><ol><li><code>6个pc</code>可以互相联通</li><li>任意一台机子可以通过<code>192.168.110.1</code>/<code>2</code>/<code>3</code>/<code>254</code>来远程登陆交换机</li></ol></div><p>ping测试：<br><img src="https://s1.ax1x.com/2022/05/10/OtSRC6.jpg" alt=""></p><p>telnet登陆测试：<br><img src="https://s1.ax1x.com/2022/05/10/OtSHUI.jpg" alt=""></p><div class="note info no-icon flat"><p>示例pkt文件，请用模拟器打开<br><a href="https://nrhs.lanzoui.com/i6BTs04kwwrg">下载</a></p></div>]]></content>
    
    
    <summary type="html">思科三层交换机互联互通，telnet远程登陆。</summary>
    
    
    
    <category term="学习笔记" scheme="https://nrhs-space.github.io/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    
    
    <category term="交换机" scheme="https://nrhs-space.github.io/tags/%E4%BA%A4%E6%8D%A2%E6%9C%BA/"/>
    
  </entry>
  
  <entry>
    <title>The truth that you leave</title>
    <link href="https://nrhs-space.github.io/2022/05/01/The%20truth_leave/"/>
    <id>https://nrhs-space.github.io/2022/05/01/The%20truth_leave/</id>
    <published>2022-05-01T15:46:54.000Z</published>
    <updated>2023-08-01T10:55:50.863Z</updated>
    
    <content type="html"><![CDATA[<p>夏天的雨往往如某些记忆一样汹涌而来，我觉得我应该记录下一些什么。以免它们在成长的过程悄然消逝。</p><p>大概是在初二，第一次偶然在大街上听见了这首曲子，但不知道它叫什么名字。</p><p>它一下就唤醒了我的记忆，似乎有很多往事猛的涌了上来，但猝不及防的不知道如何表达。</p><p>再转眼到了高二，我提着俩个包子从食堂跑回教室。云天楼上金黄的阳光撒了下来，我再一次听见了这首曲子。时间都开始慢了下来，操场上体育生在奔跑，楼上两个女生趴在栏杆上迎着阳光。那是我见过最诗意的画面。</p><p>到了大二，我已经经历得更多了。家里的变故一件一件的落下来，越来越多的物是人非。跑步的时候突然循环到这首歌，一下我就跑不下去了。抬头发现，那是我在大学见过最繁星亮丽的夜。城市的生活越来越让我忘记内心，我们美其名曰成长，但丢失的往往是最初的自己。</p><p>星星一直有，但碌碌无为的生活却遮住了我的双眼。</p><p>我尝试将它弹奏出来，但效果一直不尽人意，直到有一天我在水木看见一段话：“余幼时家贫，但仍不知上进。蹉跎岁月后方明知识之重要。奈何花有重开日，人无再少年，今日有幸再读送东阳马生序，再踏上故土，顿感悔恨，初读是文章，再阅已是人生。愿此文章影响更多学子，祝阅过此篇文章之人珍惜岁月，一路向前。”</p><p>我发现我真正缺少的还是经历，书本上的道理万般不能留下一点回响，经历让人活得大彻大悟。而经历，就交给未来的岁月吧。</p><p>人生如逆旅，我亦是行人。</p><div class="video"><video controls preload><source src='http://dpv.videocc.net/6358b82195/0/6358b82195e59dc21b248912b4070c50_3.mp4?pid=1651730029185X1149701' type='video/mp4'>Your browser does not support the video tag.</video></div>]]></content>
    
    
    <summary type="html">原以为告别总会留有时间，相拥着泪别亦或者目送着渐行渐远。但后来才发现，告别大多都是悄无声息的。原来那次相见，就已经是最后一面。</summary>
    
    
    
    <category term="吉他" scheme="https://nrhs-space.github.io/categories/%E5%90%89%E4%BB%96/"/>
    
    
    <category term="吉他" scheme="https://nrhs-space.github.io/tags/%E5%90%89%E4%BB%96/"/>
    
    <category term="音乐" scheme="https://nrhs-space.github.io/tags/%E9%9F%B3%E4%B9%90/"/>
    
  </entry>
  
  <entry>
    <title>似水流年</title>
    <link href="https://nrhs-space.github.io/2022/04/14/I_ever-life/"/>
    <id>https://nrhs-space.github.io/2022/04/14/I_ever-life/</id>
    <published>2022-04-14T15:59:33.000Z</published>
    <updated>2022-04-30T15:01:20.790Z</updated>
    
    <content type="html"><![CDATA[<p>我很喜欢夏天的雨。</p><p>夏天的雨往往如同某些记忆汹涌而来，我觉得我应该记录下一些什么，以免它们在成长的过程中悄然消逝。</p><p>大概是在05年吧，那是我记忆最早的片段。母亲把我放在地上，我摇晃着走到墙根，抬头看见灰黄的墙石，我还不能摸不到再上一块墙石的缝隙。</p><p>记得那个时候对一切都是一种灰蒙蒙的状态，山是灰蒙蒙的，人也是灰蒙蒙的。对面山坡上还住着好几家人，而到现在都已经是树木丛生。</p><p>再大一点，我开始上幼儿园了。我总疑心我到底在哪个地方读了幼儿园，只依稀记得幼儿园读了1年，毕业的时候老师奖励好孩子一个翻盖就能响的手机。而恰好多了一个坏的，没有电池，就顺手把它给了我。那是我的第一个奖品。</p><p>开始上小学了，在我的记忆中，我的母亲总是和我的爷爷在争夺谁来抚养我。我记得在幼儿园的时候我就在爷爷身边，但小学一年级又回到了母亲的身旁。母亲同时照顾我和上初中的姐姐，每天中午都套着红领巾脏兮兮的回到出租房，而姐姐就甩着她的校园出入证回家。</p><p>周五下午母亲就带着我走2个小时的路，从镇上回到老家。小时候我很讨厌走这么久的路，但母亲又很节约，不想坐车。常常我走一半了就不走了，蹲在地上数蚂蚁。母亲就开始好言劝我，说马上到了，马上到了，再不走<span class='nota' data-nota='鬼的方言读音'>麻麻</span>要把我背走。但常常还是母亲把我背回家去。</p><p>在老家的下雨天是我最喜欢的天气。下雨天我就可以缠着和母亲多睡一会，再一觉醒来，母亲就会在厨房叮叮当当的做早饭，窗外的雨淅淅沥沥，爸爸在闲聊，小橘喵喵的在要吃的……那是我最幸福的时光。</p><p>上学时住在一个出租屋，出租房很小，小到厕所都没有，就一间四四方方的房间。我常常和楼下的中洋玩耍，还有一个小妹妹，已经记不到她的姓名，只是知道她的后妈对她很不好，天天她都在洗碗，犯错了还被她妈妈用针扎脸。那个时候我还和她私定婚约，说长大一点就一起跑。</p><p>但后来我转学离开了那个小镇去到了爷爷身旁，从此失去了她的消息。</p><p>从此以后的记忆就围绕在爷爷的身旁展开。</p><p>刚开始，住在一个伯伯买的小平屋中，很窄，但厕所很大。爷爷买了一块小案板，每天早上都给我放喜羊羊与灰太狼醒觉。爷爷就在一旁叮叮咚咚的剁肉给我做团子……我和爷爷生活了11年，从2年级到高三毕业。</p><p>小学总是好奇再上一层楼是几年级。和浩还有倩，婷他们天天在外面嬉闹。在广场上玩瞎子摸鱼，跑到浩家里玩寻宝。那个时候对于未来全然不觉，6年级的楼梯永远爬不完。</p><p>算起来，小学6年是最愉快的时光的了。小时候还总在想，大人说我们无忧无虑，才不是呢！天天写作业，背课文，抄公式……最可怕的就是考试考砸了，老师要打手心。老师拿着竹块进来，心就悬到了嗓子眼。到现在看起来，我们总是在一个阶段过后才能体会到消逝的美好。</p><p>去年回家看了看小学的解老师，才知道她要结婚了。小学的时候就记得她单身一人，毕业的时候还哭得稀里哗啦。算起来，也快8年未见了，她是我记忆最为深刻的老师，她没有教会我什么高深的东西，但却真真切切的影响了我的一生。</p><p>小学在漫天的同学录中结束。那个时候还以为写下同学录就可以保持这份友谊，时至今日，上面的人早已没有了联系。我们在某个时候总能有三五个非常好的朋友，但之后，又不约而同的逐渐消逝在彼此的生活中。但只如果能见上一面，依旧还是熟悉的感觉。</p><p>六年级老师老让我们坐到梯子上去做作业，初中生比我们多一节课，他们下楼我们就分出一条路。那时候总觉得高年级的同学都好高大，叮叮咚咚的下楼，带起一层灰尘。</p><p>我也终于进入了初中，有了傲视小学生的资格。都学会了用英语骂人了<code>you mother&#39;s</code>。</p><p>也是在初中，开始接触到手机。半夜爬到窗子上，扒着铁栏杆，蹭着对面楼的微弱WiFi信号。</p><p>那个时候最喜欢的就是周五放假跑到附近手机店蹭WiFi玩手机。和我一起的还有好几个小伙伴，幸好爷爷老是来逮我，不然我早和他们一样打工去了。</p><p>初中感情也开始萌芽，当时特别喜欢后桌的长发女生。每天进教室的第一件事情就是往她的座位看看，看见她在，又赶忙把眼神转移。从来都不敢和她正面说话，只想默默看着她，现在想起来，那段幼稚的感情真好。</p><p>初中毕业后和他们大多都断了联系，但和蓉却保持直到今天的联系。那是我遇到最好的一个女孩了，天真得像一个意外坠入人间的天使。也是我记忆中最为深刻的女孩，她经常来找我玩，我爷爷老是以为她是我女朋友。</p><p>她说我是她的男闺蜜，虽然男闺蜜这种东西压根就不该存在。但正如她的天真一样，她认为我们之间是最好的友情。上大学了她也结交了男朋友，我们的联系就慢慢的少了起来。</p><p>她跟她男朋友吵架了，她跟我打电话哭。但吵架的原因竟然是因为有我这个“男闺蜜”的存在。我开始刻意的和她保持了距离，不再接她的电话，也不再经常聊天。似乎这奏了效，真的好久都没再听见她的消息。</p><p>但每每想起来，都充满了遗憾。</p><p>进入了高中。但我的心智却还停留在初中。我没有长大，在高一，为了贪图好玩，从理科跑到了文科。那时的我，丝毫没有意识到过从那一刻起，就注定了我要还这一笔债。</p><p>和飞飞还有航在一起的高中生活，我们三包揽后几排的宝座，我们常常把英语老师气得哭。自习课和历史课上，跟豆豆她们整节课的聊天。我们跟老班喊春春，他从来不用武力统治我们，他喜欢跟我们思想教育，但当时的我们，很少人听得进去……</p><p>高三最后一年认识了女孩艳，她很喜欢笑。她的笑容很像雨后的初阳。明媚而灿烂。她也是我遇到最神秘的女孩，她的内心里好像一直在播放一首伤感的背景音乐。我永远看不见她的内心。高中时期的感情很美化，但我直到毕业，也未曾踏出一步……她就像，记忆中的百合花，美丽而不妖艳的永远只在记忆中……</p><p>愉悦的时光就带来了我成绩的长期倒数，甚至破天荒的6科考了280分。但羞愧与自责只存在一晚，第二天，便烟消云散。</p><p>和父母也爆发了最大的分歧。父亲骂我一天不思进取，我说读书不是唯一的出路。父亲说等我到18岁，就让我自己出去自生自灭。我说我不稀罕。我笑父亲无学识，无素质，辛苦半辈子还在泥巴里刨食……</p><p>但时间会证明，生活总会教会你生活。2019年7月9日，老班跟我说，我父亲入院了。</p><p>那是我目前人生最大的分界点，我曾打开过一丝门缝，看了看外面黑暗的暴雨，我又紧紧的关上了门。但这一次，生活把我踹了出去，生活教会了我生活。</p><p>我从300分拉到430，无比接近了本科线，但正如这无比遗憾的生活，充满了遗憾。</p><p>父亲的生病是导致我来到医专的直接原因，但老天似乎对我有些许怜悯。我居然跳过了前5个专业，来到了我最后一个和理想有一丝丝关系的专业。</p><p>我开始在医专敲代码。我一定要实现科技对生活的改变。</p><p>在我6岁那年，父亲给我买过唯一的一个玩具。是一个可以弯曲折叠的块状棍子，爸爸给我的时候还不忘教育我好好读书。</p><p>这件事情我大概记了10年，而今，父亲再也不能给我买玩具了。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;我很喜欢夏天的雨。&lt;/p&gt;
&lt;p&gt;夏天的雨往往如同某些记忆汹涌而来，我觉得我应该记录下一些什么，以免它们在成长的过程中悄然消逝。&lt;/p&gt;
&lt;p&gt;大概是在05年吧，那是我记忆最早的片段。母亲把我放在地上，我摇晃着走到墙根，抬头看见灰黄的墙石，我还不能摸不到再上一块墙石的缝隙。</summary>
      
    
    
    
    <category term="朝花夕拾" scheme="https://nrhs-space.github.io/categories/%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/"/>
    
    
    <category term="朝花夕拾" scheme="https://nrhs-space.github.io/tags/%E6%9C%9D%E8%8A%B1%E5%A4%95%E6%8B%BE/"/>
    
  </entry>
  
  <entry>
    <title>python+Selenium=免费自动博客图床</title>
    <link href="https://nrhs-space.github.io/2022/03/20/IMG-Bed/"/>
    <id>https://nrhs-space.github.io/2022/03/20/IMG-Bed/</id>
    <published>2022-03-20T03:00:07.000Z</published>
    <updated>2022-05-13T02:30:27.679Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前世今生"><a href="#前世今生" class="headerlink" title="前世今生"></a>前世今生</h1><p>对于博客图片问题。我相信大部分博客编辑器都是可以直接将图片粘贴过去。生成一个本地文件夹来存储这些文件。</p><p>例如我比较喜欢的<code>HBuilderX</code>，将截图贴过来，<code>markdown</code>格式自动生成语句，本地创建文件夹。</p><p><img src="https://s1.ax1x.com/2022/03/29/q6X80O.jpg" alt=""></p><p>我们在本地可以很愉快的查看我们的预览效果。但是，推送到Github上就出现了奇奇怪怪的问题。一方面是图片过多，上传速度过慢，且由于一些科学上网的原因，很多时候会上传失败。</p><p>另外是访问速度不是很舒服，这不是优雅的图片解决方案。</p><hr><p>图床，尤其是大厂图床。CDN加速，无流量限制，随用随修改，这才是我们理想的图片解决方案。</p><p>但是，优雅的解决方案往往伴随着需要钞能力的加持。我们租用服务器，搭建平台，建设API……</p><p>我们大可不必重新建设轮子，在网络上有非常多的免费图床提供。</p><p><img src="https://s1.ax1x.com/2022/03/29/q6XAmT.jpg" alt=""></p><p>这些免费图床实现了我们免费白嫖图床的想法。但实际使用检验，很难有免费图床可以<kbd>不登陆</kbd>，<kbd>不删除</kbd>，<kbd>不限流</kbd>，<kbd>不限量</kbd>，<kbd>不跑路</kbd>……</p><p>我很喜欢使用<a href="https://imgtu.com/">路过图床</a>，它可以很好的解决上述问题。稳如老狗。</p><p><img src="https://s1.ax1x.com/2022/03/29/q6XttH.jpg" alt=""></p><p>但又出现了一个新的问题。在游客中上传图片只能<wavy>一次上传一张</wavy>。作为白嫖客，我完全理解。但这样使用一张图片就需要手动上传一次实在不优雅。</p><hr><u>更优雅的解决方案当然是读取本地markdown文档和相关文件夹，自动上传图片获得Url链接，并将其替换md文档内链接。</u><p>但正如上述，优雅往往需要钞能力加持。提供API接口的图床很多，但免费的寥寥无几。于是，我们需要使用一个次优雅的解决方案。</p><p><img src="https://s1.ax1x.com/2022/03/29/q6XHN4.jpg" alt=""></p><div class="note purple icon flat"><i class="note-icon far fa-hand-scissors"></i><p>次优雅解决方案</p></div><p>我们使用<code>Python+Selenium</code>库来实现python操作浏览器。</p><p>Python进行对本地文件夹与<code>markdown</code>文档读取。循环提交文件夹内的图片，拿到上传成功的<code>Url</code>链接，替换掉md文档内原路径链接。</p><h1 id="理论存在，实践开始"><a href="#理论存在，实践开始" class="headerlink" title="理论存在，实践开始"></a>理论存在，实践开始</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post_img</span>(<span class="params">path</span>):</span><br><span class="line">    Brower = webdriver.Chrome(<span class="string">&quot;E:\百分浏览器\chromedriver.exe&quot;</span>) <span class="comment"># 浏览器内核驱动路径</span></span><br><span class="line">    Brower.get(<span class="string">&#x27;https://imgtu.com/&#x27;</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)  <span class="comment"># 延时操作</span></span><br><span class="line">    Brower.find_element_by_id(<span class="string">&#x27;anywhere-upload-input&#x27;</span>).send_keys(path)</span><br><span class="line">    time.sleep(<span class="number">2</span>)  <span class="comment"># 延时操作</span></span><br><span class="line">    button=<span class="string">&#x27;document.querySelector(&quot;#anywhere-upload-submit &gt; div:nth-child(1) &gt; button&quot;).click()&#x27;</span></span><br><span class="line">    Brower.execute_script(button)</span><br><span class="line">    time.sleep(<span class="number">6</span>)</span><br><span class="line">    html=Brower.page_source</span><br><span class="line">    jpg=re.findall(<span class="string">r&#x27;image_src&quot; href=&quot;(.+?)&quot;&gt;&#x27;</span>,html)</span><br><span class="line">    Brower.close()  <span class="comment"># 关闭浏览器</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;已完成:%s&quot;</span>%jpg[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> jpg[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alter</span>(<span class="params">file,old_str,new_str</span>):</span><br><span class="line">  <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f1,<span class="built_in">open</span>(<span class="string">&quot;%s.bak&quot;</span> % file, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f2:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f1:</span><br><span class="line">      <span class="keyword">if</span> old_str <span class="keyword">in</span> line:</span><br><span class="line">        line = line.replace(old_str, new_str)</span><br><span class="line">      f2.write(line)</span><br><span class="line">  os.remove(file)</span><br><span class="line">  os.rename(<span class="string">&quot;%s.bak&quot;</span> % file, file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">folder_name = os.listdir(<span class="string">&quot;G:\\blog\source\_posts2\OCR_img_files&quot;</span>) <span class="comment"># 文件夹路径</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(folder_name)):</span><br><span class="line">    data_name = <span class="string">&quot;OCR_img_files/&quot;</span> + folder_name[i] <span class="comment"># md文档内路径前缀</span></span><br><span class="line">    post_path = <span class="string">&quot;G:\\blog\source\_posts2\\&quot;</span>+data_name.replace(<span class="string">&quot;/&quot;</span>, <span class="string">&quot;\\&quot;</span>) <span class="comment"># 文件夹路径转换/斜杠输出</span></span><br><span class="line"></span><br><span class="line">    alter(<span class="string">&quot;G:\\blog\source\_posts2\OCR_img.md&quot;</span>, data_name, post_img(post_path)) <span class="comment"># md文档绝对路径，替换md文档内路径</span></span><br></pre></td></tr></table></figure><p>其中文件路径需要仔细注意。</p><p><img src="https://s1.ax1x.com/2022/03/29/q6jP4H.jpg" alt=""></p><p>对<code>Selenium</code>存在疑问可以去”百度+必应”联合大学查找办法。大概流程可以参考我的博客文章<a href="http://blog.nrhs.tk/2022/01/23/EG-webdriver_py/">基于Selenium实现python浏览器自动化</a></p><div class="tip bell"><p>本文章自豪的采用了该技巧</p></div>]]></content>
    
    
    <summary type="html">Hexo+Github写写博客多是一件美事，但图片老是困扰我的生产质量。博客不易，阿花叹气。于是，有了这篇文章...🙃</summary>
    
    
    
    <category term="python" scheme="https://nrhs-space.github.io/categories/python/"/>
    
    
    <category term="python" scheme="https://nrhs-space.github.io/tags/python/"/>
    
    <category term="Selenium" scheme="https://nrhs-space.github.io/tags/Selenium/"/>
    
  </entry>
  
  <entry>
    <title>简单处理一下图片</title>
    <link href="https://nrhs-space.github.io/2022/03/15/OCR_img/"/>
    <id>https://nrhs-space.github.io/2022/03/15/OCR_img/</id>
    <published>2022-03-15T07:43:21.000Z</published>
    <updated>2022-05-13T02:29:30.587Z</updated>
    
    <content type="html"><![CDATA[<p>很烦截图诶，老是让我去查谁没交。名字在图片上，吸取上次的经验，我把“查查谁没交截图”做成了全自动😅</p><p>顺便把剪切图片这种烦人的工作也加了上去😑</p><hr><p>大概的思路就是将所有图片放在一个文件夹下，对这个文件夹下所有图片进行一个处理。</p><p>先进行OCR文字识别，把名字识别出来，然后用花名册对它进行遍历查找。</p><p>再顺便写了个批量剪切图片，就可以把证件照啥的一下全剪成200x200啥的。多是一件美事。</p><hr><h1 id="OCR识别"><a href="#OCR识别" class="headerlink" title="OCR识别"></a>OCR识别</h1><p>对于<kbd>OCR</kbd>识别，大致有两种方式。一是在线识别操作，二是本地离线模型包，离线识别。</p><p>免费在线识别有很多，随便一搜就有很多。但是无一例外，都是一张一张上传识别，不符合我们设计程序的思路。</p><p>大厂的OCR技术倒是有API接口，百度，腾讯，阿里……但无一例外，免费次数有限，而且我们操作的某些图片不太适合进行上传。</p><p><img src="https://s1.ax1x.com/2022/03/27/q0m8JS.jpg" alt=""></p><p>所以在这里，我选择了开源的<code>PaddleOCR</code>项目来作为轮子</p><p>同样，开源OCR项目也有很多。但Paddle项目的文档很全，且包很小，轻量CPU仅9MB。</p><p>Github地址：<a href="https://github.com/PaddlePaddle/PaddleOCR">https://github.com/PaddlePaddle/PaddleOCR</a></p><p>Gitee地址：<a href="https://gitee.com/paddlepaddle/PaddleOCR">https://gitee.com/paddlepaddle/PaddleOCR</a></p><p>官网地址：<a href="https://www.paddlepaddle.org.cn/">https://www.paddlepaddle.org.cn/</a></p><h2 id="🍕在python中安装PaddleOCR"><a href="#🍕在python中安装PaddleOCR" class="headerlink" title="🍕在python中安装PaddleOCR"></a>🍕在python中安装PaddleOCR</h2><div class="note primary flat"><p>从百度源下载cpu版本paddle库</p></div><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install paddlepaddle==<span class="number">2</span>.<span class="number">2</span>.<span class="number">0</span> -i https://mirror.baidu.com/pypi/simpl</span><br></pre></td></tr></table></figure><div class="note primary flat"><p>安装shapely</p></div><p>在<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#shapely">https://www.lfd.uci.edu/~gohlke/pythonlibs/#shapely</a>去找到<kbd>shapely</kbd>的<kbd>whl</kbd>包进行安装</p><p>在这里需要注意，你该如何选择对应的whl包？</p><p>执行命令:<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip debug --verbose</span><br></pre></td></tr></table></figure></p><p><img src="https://s1.ax1x.com/2022/03/27/q0mtMj.jpg" alt=""></p><p>查看当前你支持的whl包，去下载<u>对应的包</u>。</p><p>下载后将whl包放在<u>工程目录</u>下(其他地方cd过去也行)，执行:<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install xxxxxxxx.whl</span><br></pre></td></tr></table></figure></p><p>如果遇到错误，很可能是不支持的whl包。你下载了<wavy>错误的whl包</wavy>。</p><div class="note primary flat"><p>安装其他依赖</p></div><p>在项目下新建<kbd>requirements.txt</kbd>文件,里面填写官方<a href="https://gitee.com/paddlepaddle/PaddleOCR/blob/release/2.4/requirements.txt">文档</a>内的内容</p><p><img src="https://s1.ax1x.com/2022/03/27/q0mwd0.jpg" alt=""></p><p>然后在该目录下执行:<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install -r requirements.txt</span><br></pre></td></tr></table></figure></p><div class="note primary flat"><p>最后安装PaddleOCR</p></div><p>执行命令:<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install &quot;paddleocr&gt;=<span class="number">2</span>.<span class="number">2</span>.<span class="number">0</span>&quot;</span><br></pre></td></tr></table></figure></p><p>好了，不出意外的话你已经安装好了所有的拓展包.</p><details class="folding-tag" cyan><summary> 不出意外的话就要出意外 </summary>              <div class='content'>              <div class="note pink icon modern"><i class="note-icon fas fa-car-crash"></i><p>以下是我遇到的部分问题</p></div><div class="note warning flat"><p>报错: error: Microsoft Visual C++ 14.0 is required. </p></div><p><strong>安装Levenshtein</strong></p><p>同样进入<a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#python-levenshtein">https://www.lfd.uci.edu/~gohlke/pythonlibs/#python-levenshtein</a></p><p>找到对应的whl包下载，pip安装它。<br><img src="https://s1.ax1x.com/2022/03/27/q0mrJU.jpg" alt=""></p><p>这里有<a href="https://blog.csdn.net/weixin_40547993/article/details/89399825">详细文档</a></p><div class="note warning flat"><p>报错: ‘NoneType’ object has no attribute ‘<strong>array_interface</strong>‘</p></div><p>极有可能是因为你的文件路径<strong>包含了中文</strong>，python的安装路径也是一样，<u>不能包含中文</u>。</p><p>在期间我还遇到了很多奇奇怪怪的错误，大部分都可以在<strong>百度-必应</strong>联合大学下找到答案。</p><p><a href="https://www.jianshu.com/p/8c959eaa886e">部分问题文档</a></p><psw>自己动手，丰衣足食</psw>              </div>            </details><div class="note primary flat"><p>下载cpu解析模型包</p></div><p>如果不需要大型模型包，可以忽略本步骤。paddleocr可以自行检测是否有模型，如果没有就下载轻量级模型包。</p><h2 id="🍕python程序运行"><a href="#🍕python程序运行" class="headerlink" title="🍕python程序运行"></a>🍕python程序运行</h2><p>可以参照<a href="https://blog.csdn.net/qq_38463737/article/details/111391069">此文档</a>检验自己的配置是否正确</p><p>我直接贴我处理完后的代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> paddleocr <span class="keyword">import</span> PaddleOCR</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont</span><br><span class="line"></span><br><span class="line"><span class="comment"># deal with OCR_img</span></span><br><span class="line"><span class="comment"># API OCR_name</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OCR_name</span>(<span class="params">img_path,orginal_name</span>):</span><br><span class="line"></span><br><span class="line">    new_name = <span class="string">&quot;test.png&quot;</span></span><br><span class="line">    os.rename(img_path+orginal_name,img_path+new_name) <span class="comment"># 将图片改个名字，不清楚为什么传入中文会报错</span></span><br><span class="line"></span><br><span class="line">    orginal_img_path = img_path <span class="comment"># 存储路径</span></span><br><span class="line">    orginal_img_name = orginal_name</span><br><span class="line">    img_path = img_path+new_name <span class="comment"># 替换以下用到的文件绝对路径</span></span><br><span class="line"></span><br><span class="line">    font = cv2.FONT_HERSHEY_SIMPLEX</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Paddleocr目前支持中英文、英文、法语、德语、韩语、日语，可以通过修改lang参数进行切换</span></span><br><span class="line">    <span class="comment"># 参数依次为`ch`, `en`, `french`, `german`, `korean`, `japan`。</span></span><br><span class="line">    ocr = PaddleOCR(use_angle_cls=<span class="literal">True</span>, lang=<span class="string">&quot;ch&quot;</span>, use_gpu=<span class="literal">False</span>,</span><br><span class="line">                    rec_model_dir=<span class="string">&#x27;./inference/ch_ppocr_server_v2.0_rec_infer/&#x27;</span>,</span><br><span class="line">                    cls_model_dir=<span class="string">&#x27;./inference/ch_ppocr_mobile_v2.0_cls_infer/&#x27;</span>,</span><br><span class="line">                    det_model_dir=<span class="string">&#x27;./inference/ch_ppocr_server_v2.0_det_infer/&#x27;</span>)  <span class="comment"># need to run only once to download and load model into memory</span></span><br><span class="line"></span><br><span class="line">    first_name = [<span class="string">&#x27;李&#x27;</span>, <span class="string">&#x27;王&#x27;</span>, <span class="string">&#x27;张&#x27;</span>, <span class="string">&#x27;刘&#x27;</span>, <span class="string">&#x27;陈&#x27;</span>, <span class="string">&#x27;杨&#x27;</span>, <span class="string">&#x27;赵&#x27;</span>, <span class="string">&#x27;黄&#x27;</span>, <span class="string">&#x27;周&#x27;</span>, <span class="string">&#x27;吴&#x27;</span>, <span class="string">&#x27;徐&#x27;</span>, <span class="string">&#x27;孙&#x27;</span>, <span class="string">&#x27;胡&#x27;</span>, <span class="string">&#x27;朱&#x27;</span>, <span class="string">&#x27;高&#x27;</span>, <span class="string">&#x27;林&#x27;</span>, <span class="string">&#x27;何&#x27;</span>, <span class="string">&#x27;郭&#x27;</span>, <span class="string">&#x27;马&#x27;</span>, <span class="string">&#x27;罗&#x27;</span>, <span class="string">&#x27;梁&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;宋&#x27;</span>, <span class="string">&#x27;郑&#x27;</span>, <span class="string">&#x27;谢&#x27;</span>, <span class="string">&#x27;韩&#x27;</span>, <span class="string">&#x27;唐&#x27;</span>, <span class="string">&#x27;冯&#x27;</span>, <span class="string">&#x27;于&#x27;</span>, <span class="string">&#x27;董&#x27;</span>, <span class="string">&#x27;萧&#x27;</span>, <span class="string">&#x27;程&#x27;</span>, <span class="string">&#x27;曹&#x27;</span>, <span class="string">&#x27;袁&#x27;</span>, <span class="string">&#x27;邓&#x27;</span>, <span class="string">&#x27;许&#x27;</span>, <span class="string">&#x27;傅&#x27;</span>, <span class="string">&#x27;沈&#x27;</span>, <span class="string">&#x27;曾&#x27;</span>, <span class="string">&#x27;彭&#x27;</span>, <span class="string">&#x27;吕&#x27;</span>, <span class="string">&#x27;苏&#x27;</span>, <span class="string">&#x27;卢&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;蒋&#x27;</span>, <span class="string">&#x27;蔡&#x27;</span>, <span class="string">&#x27;贾&#x27;</span>, <span class="string">&#x27;丁&#x27;</span>, <span class="string">&#x27;魏&#x27;</span>, <span class="string">&#x27;薛&#x27;</span>, <span class="string">&#x27;叶&#x27;</span>, <span class="string">&#x27;阎&#x27;</span>, <span class="string">&#x27;余&#x27;</span>, <span class="string">&#x27;潘&#x27;</span>, <span class="string">&#x27;杜&#x27;</span>, <span class="string">&#x27;戴&#x27;</span>, <span class="string">&#x27;夏&#x27;</span>, <span class="string">&#x27;钟&#x27;</span>, <span class="string">&#x27;汪&#x27;</span>, <span class="string">&#x27;田&#x27;</span>, <span class="string">&#x27;任&#x27;</span>, <span class="string">&#x27;姜&#x27;</span>, <span class="string">&#x27;范&#x27;</span>, <span class="string">&#x27;方&#x27;</span>, <span class="string">&#x27;石&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;姚&#x27;</span>, <span class="string">&#x27;谭&#x27;</span>, <span class="string">&#x27;廖&#x27;</span>, <span class="string">&#x27;邹&#x27;</span>, <span class="string">&#x27;熊&#x27;</span>, <span class="string">&#x27;金&#x27;</span>, <span class="string">&#x27;陆&#x27;</span>, <span class="string">&#x27;郝&#x27;</span>, <span class="string">&#x27;孔&#x27;</span>, <span class="string">&#x27;白&#x27;</span>, <span class="string">&#x27;崔&#x27;</span>, <span class="string">&#x27;康&#x27;</span>, <span class="string">&#x27;毛&#x27;</span>, <span class="string">&#x27;邱&#x27;</span>, <span class="string">&#x27;秦&#x27;</span>, <span class="string">&#x27;江&#x27;</span>, <span class="string">&#x27;史&#x27;</span>, <span class="string">&#x27;顾&#x27;</span>, <span class="string">&#x27;侯&#x27;</span>, <span class="string">&#x27;邵&#x27;</span>, <span class="string">&#x27;孟&#x27;</span>,</span><br><span class="line">                  <span class="string">&#x27;龙&#x27;</span>, <span class="string">&#x27;万&#x27;</span>, <span class="string">&#x27;段&#x27;</span>, <span class="string">&#x27;漕&#x27;</span>, <span class="string">&#x27;钱&#x27;</span>, <span class="string">&#x27;汤&#x27;</span>, <span class="string">&#x27;尹&#x27;</span>, <span class="string">&#x27;黎&#x27;</span>, <span class="string">&#x27;易&#x27;</span>, <span class="string">&#x27;常&#x27;</span>, <span class="string">&#x27;武&#x27;</span>, <span class="string">&#x27;乔&#x27;</span>, <span class="string">&#x27;贺&#x27;</span>, <span class="string">&#x27;赖&#x27;</span>, <span class="string">&#x27;龚&#x27;</span>, <span class="string">&#x27;文&#x27;</span>, <span class="string">&#x27;盧&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">putText_Chinese</span>(<span class="params">img, strText, pos, color, fontSize</span>):</span><br><span class="line">        fontpath = <span class="string">&quot;./doc/fonts/simfang.ttf&quot;</span>  <span class="comment"># 宋体路径</span></span><br><span class="line">        font = ImageFont.truetype(fontpath, fontSize)</span><br><span class="line">        img_pil = Image.fromarray(img)</span><br><span class="line">        draw = ImageDraw.Draw(img_pil)</span><br><span class="line">        draw.text(pos, strText, font=font, fill=color)</span><br><span class="line">        img = np.array(img_pil)</span><br><span class="line">        <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">first_str</span>(<span class="params">s</span>):</span><br><span class="line">        s = s.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)  <span class="comment"># 防止空格</span></span><br><span class="line">        <span class="keyword">return</span> [ch <span class="keyword">for</span> ch <span class="keyword">in</span> s]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;---------------PaddleOCR Start---------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    img = cv2.imread(img_path)</span><br><span class="line">    <span class="comment">#cv2.imshow(img_path, img) # show original picture</span></span><br><span class="line">    result = ocr.ocr(img_path, cls=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> result:</span><br><span class="line">        data.append(line[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">        name=<span class="string">&quot;&quot;</span></span><br><span class="line">        pt1 = ((<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>]), (<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">0</span>][<span class="number">1</span>]))</span><br><span class="line">        pt2 = ((<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>]), (<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">1</span>][<span class="number">1</span>]))</span><br><span class="line">        pt3 = ((<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">2</span>][<span class="number">0</span>]), (<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">2</span>][<span class="number">1</span>]))</span><br><span class="line">        pt4 = ((<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">3</span>][<span class="number">0</span>]), (<span class="built_in">int</span>)(line[<span class="number">0</span>][<span class="number">3</span>][<span class="number">1</span>]))</span><br><span class="line">        cv2.line(img, pt1, pt2, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">1</span>, cv2.LINE_AA)</span><br><span class="line">        cv2.line(img, pt2, pt3, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">1</span>, cv2.LINE_AA)</span><br><span class="line">        cv2.line(img, pt3, pt4, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">1</span>, cv2.LINE_AA)</span><br><span class="line">        cv2.line(img, pt1, pt4, (<span class="number">0</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">1</span>, cv2.LINE_AA)</span><br><span class="line"></span><br><span class="line">        img = putText_Chinese(img, line[<span class="number">1</span>][<span class="number">0</span>], (pt1[<span class="number">0</span>], pt1[<span class="number">1</span>] - <span class="number">35</span>), (<span class="number">255</span>, <span class="number">0</span>, <span class="number">255</span>), <span class="number">50</span>)</span><br><span class="line">        value = re.findall(<span class="string">&quot;&#x27;(.+?)&#x27;&quot;</span>, <span class="built_in">str</span>(line[<span class="number">1</span>]))</span><br><span class="line">        <span class="comment"># value[0] is comlete string</span></span><br><span class="line">        <span class="comment"># first_str(value[0]) is modify string</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> first_str(value[<span class="number">0</span>])[<span class="number">0</span>] <span class="keyword">in</span> first_name:</span><br><span class="line">            name = value[<span class="number">0</span>]</span><br><span class="line">            <span class="built_in">print</span>(value)</span><br><span class="line">            <span class="keyword">break</span>  <span class="comment"># jump out of the loop and rename</span></span><br><span class="line">        <span class="comment"># print(&quot;failly! please inspect model!&quot;)</span></span><br><span class="line"></span><br><span class="line">    data = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> name != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        name = name + <span class="string">&quot;.png&quot;</span></span><br><span class="line">        os.rename(img_path, orginal_img_path+name)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        os.rename(img_path, orginal_img_path+orginal_img_name)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#cv2.imwrite(&quot;show_&quot;+name+&quot;.png&quot;, img) # 输出版面分析图片</span></span><br><span class="line">    <span class="comment">#cv2.imshow(&quot;模型展示&quot;+name+&quot;.png&quot;, img)  # 展示图片</span></span><br><span class="line"></span><br><span class="line">    cv2.waitKey()</span><br><span class="line">    cv2.destroyAllWindows()</span><br></pre></td></tr></table></figure><p>在这里我为了配合其他代码块简洁。将OCR识别区域写为了一个函数</p><p>需要传入2个参数，一个是<wavy>文件夹路径(img_path)</wavy>，另一个是<wavy>原名称(orginal_name)</wavy></p><details class="folding-tag" cyan><summary> 部分代码解释 </summary>              <div class='content'>              <ol><li>直接传入中文名称会有奇奇怪怪的问题，在程序开始部分对其重命名为test。在识别成功会被重命名，识别失败会被重命名为原名称。</li><li>代码中直接判断了<u>百家姓</u>规则，将符合规则的字符串作为姓名把图片重命名。</li><li>其中注释掉了展示<u>版面分析部分</u>，即第81，82行。<br><img src="https://s1.ax1x.com/2022/03/27/q0mIJO.jpg" alt=""></li></ol>              </div>            </details><h2 id=""><a href="#" class="headerlink" title=""></a><div class="note success flat"><p>OCR识别部分完结🍕</p></div></h2><h1 id="图片剪切"><a href="#图片剪切" class="headerlink" title="图片剪切"></a>图片剪切</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># cut picture</span></span><br><span class="line"><span class="comment"># need path of picture and place,value</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cut_picture</span>(<span class="params">file_in, width, height, value</span>):</span><br><span class="line">    <span class="keyword">if</span> value==<span class="string">&quot;mediary&quot;</span>: <span class="comment">#居中缩放</span></span><br><span class="line">        <span class="comment"># dont&#x27;t cut picture, entire shrink to specify pixel of picture</span></span><br><span class="line">        image = Image.<span class="built_in">open</span>(file_in)</span><br><span class="line">        resized_image = image.resize((width, height), Image.ANTIALIAS)</span><br><span class="line">        resized_image.save(file_in)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        img = Image.<span class="built_in">open</span>(file_in)</span><br><span class="line">        _width, _height = img.size</span><br><span class="line">        <span class="built_in">print</span>(_width,_height, <span class="string">&quot;==&gt;&quot;</span>,width,height)</span><br><span class="line">        <span class="comment"># 图像从左上角建立坐标系，四个值依次为距左的像素，距顶的像素，从左开始剪切到距离左多少的像素，从顶开始剪切到那里的像素。</span></span><br><span class="line">        <span class="comment"># 即（左，上，右，底），构成一个矩形</span></span><br><span class="line">        <span class="keyword">if</span> value==<span class="string">&quot;leftTop&quot;</span>:</span><br><span class="line">            crop = (<span class="number">0</span>, <span class="number">0</span>, width, height)</span><br><span class="line">        <span class="keyword">elif</span> value==<span class="string">&quot;rightTop&quot;</span>:</span><br><span class="line">            crop = (_width-width, <span class="number">0</span>, _width, height)</span><br><span class="line">        <span class="keyword">elif</span> value==<span class="string">&quot;bottomRight&quot;</span>:</span><br><span class="line">            crop = (_width-width, _height-height, _width, _height)</span><br><span class="line">        <span class="keyword">elif</span> value==<span class="string">&quot;bottomLeft&quot;</span>:</span><br><span class="line">            crop = (<span class="number">0</span>, _height-height, width, _height)</span><br><span class="line">        <span class="keyword">elif</span> value==<span class="string">&quot;middle&quot;</span>:</span><br><span class="line">            crop = (<span class="built_in">int</span>((_width-width)/<span class="number">2</span>), <span class="built_in">int</span>((_height-height)/<span class="number">2</span>), <span class="built_in">int</span>((_width-width)/<span class="number">2</span>+width), <span class="built_in">int</span>((_height-height)/<span class="number">2</span>+height))</span><br><span class="line">        cropped = img.crop(crop)  <span class="comment"># (left, upper, right, lower)</span></span><br><span class="line">        cropped.save(file_in)</span><br></pre></td></tr></table></figure><p>使用了PIL库直接操作了图片，没有什么特别的地方。</p><p><img src="https://wkphoto.cdn.bcebos.com/9c16fdfaaf51f3de341e8d0084eef01f3a297921.jpg" alt=""></p><p>主要是剪切的坐标系需要注意，是从左上角开始。</p><p>同样写为了一个函数，需要传入(file_in, width, height, value)，分别是：图片绝对路径，保留的宽度，高度，基点位置。</p><p>单文件版本见<a href="https://www.52pojie.cn/thread-1604383-1-1.html">我的吾爱贴子</a></p><p><img src="https://wkphoto.cdn.bcebos.com/962bd40735fae6cda9189f051fb30f2442a70f21.jpg" alt=""></p><hr><h1 id="文件查缺少"><a href="#文件查缺少" class="headerlink" title="文件查缺少"></a>文件查缺少</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># who is missing</span></span><br><span class="line"><span class="comment"># need excel file and folder path</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">without</span>(<span class="params">txt_path,folder_path</span>):</span><br><span class="line">    file = <span class="built_in">open</span>(txt_path, encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    body=[]</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        body.append(line.replace(<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;&#x27;</span>))  <span class="comment"># 添加到列表</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n已读取&quot;</span>, body[<span class="number">0</span>], <span class="string">&quot;等&quot;</span>, <span class="built_in">len</span>(body), <span class="string">&quot;人&quot;</span>)</span><br><span class="line">    listtwo = []</span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    filePath = folder_path</span><br><span class="line">    <span class="built_in">list</span> = os.listdir(filePath)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">list</span>) == <span class="built_in">len</span>(body):  <span class="comment"># 当文件数量等于名字列表时</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;相同！&quot;</span>)</span><br><span class="line">        <span class="built_in">input</span>(<span class="string">&quot;按下回车退出！&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n人数不匹配！(&quot;</span>, <span class="built_in">len</span>(<span class="built_in">list</span>), <span class="string">&quot;/&quot;</span>, <span class="built_in">len</span>(body), <span class="string">&quot;)人&quot;</span>, <span class="string">&quot;缺少&quot;</span>, <span class="built_in">len</span>(body) - <span class="built_in">len</span>(<span class="built_in">list</span>), <span class="string">&quot;人\n&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">list</span>)):</span><br><span class="line">            marry = <span class="built_in">list</span>[i].replace(<span class="string">&quot;.jpg&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;.png&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;.docx&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;.pptx&quot;</span>, <span class="string">&quot;&quot;</span>).replace(</span><br><span class="line">                <span class="string">&quot;.xlsx&quot;</span>, <span class="string">&quot;&quot;</span>)  <span class="comment"># 将后缀去掉</span></span><br><span class="line">            listtwo.append(marry)</span><br><span class="line">            <span class="comment"># count = body.count(marry)</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(body)):  <span class="comment"># 将文件夹内名字与列表匹配</span></span><br><span class="line">            <span class="keyword">if</span> body[v] <span class="keyword">in</span> listtwo:</span><br><span class="line">                <span class="keyword">pass</span>  <span class="comment"># 匹配成功不处理</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;不存在：&quot;</span>, body[v])  <span class="comment"># 输出不匹配的</span></span><br><span class="line">                a = a + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> a != <span class="built_in">len</span>(body) - <span class="built_in">len</span>(<span class="built_in">list</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n返回人数不一样，请检查你的文件内名字是否有错别字！\n&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n数据返回完毕！&quot;</span>)</span><br></pre></td></tr></table></figure><p>传入2个参数，一个是<kbd>花名册.txt</kbd>，将名单每行一个存入txt文件。另一个是需要遍历查找的文件夹路径。</p><p>自动查找缺少谁。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">without(<span class="string">&quot;花名册.txt&quot;</span>,<span class="string">&quot;D:\Desktop\\test2\\&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2022/03/27/q0mHQH.jpg" alt=""></p><hr><h1 id="遍历文件夹"><a href="#遍历文件夹" class="headerlink" title="遍历文件夹*"></a>遍历文件夹*</h1><p>上述前俩功能，都需要去处理文件夹下所有图片。</p><p>所以此功能是它们的驱动。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># deal with folder</span></span><br><span class="line"><span class="comment"># input folder_path</span></span><br><span class="line"></span><br><span class="line">form_name = [<span class="string">&quot;.jpg&quot;</span>,<span class="string">&quot;.png&quot;</span>,<span class="string">&quot;.jpeg&quot;</span>] <span class="comment">#判断的图片后缀</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_folder</span>(<span class="params">folder_path, value, width, height,cut_vaule</span>):</span><br><span class="line">    folder_name = os.listdir(folder_path)</span><br><span class="line">    <span class="keyword">if</span> value==<span class="string">&quot;ocr&quot;</span>:</span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(folder_name)):</span><br><span class="line">            <span class="keyword">if</span> form_name[<span class="number">0</span>] <span class="keyword">in</span> folder_name[v] <span class="keyword">or</span> form_name[<span class="number">1</span>] <span class="keyword">in</span> folder_name[v] <span class="keyword">or</span> form_name[<span class="number">2</span>] <span class="keyword">in</span> folder_name[v]:</span><br><span class="line">                <span class="comment"># print(folder_name[v])</span></span><br><span class="line">                OCR_name(folder_path,folder_name[v])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;不符合的类型&quot;</span>, folder_name[v])</span><br><span class="line">    <span class="keyword">elif</span> value==<span class="string">&quot;cut&quot;</span>:</span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(folder_name)):</span><br><span class="line">            cut_picture(<span class="built_in">str</span>(folder_path+folder_name[v]), width, height, cut_vaule) <span class="comment"># (path,width,height,value)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在此函数的驱动下，OCR识别与cut_picture俩个函数功能只需要传入一个即可。</p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find_folder(<span class="string">&quot;D:\Desktop\hh&quot;</span>+<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;ocr&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>) <span class="comment"># OCR识别，传入文件夹路径即可</span></span><br><span class="line"></span><br><span class="line">find_folder(<span class="string">&quot;D:\Desktop\\02-副本\\&quot;</span>,<span class="string">&quot;cut&quot;</span>,<span class="number">200</span>,<span class="number">500</span>,<span class="string">&quot;middle&quot;</span>) <span class="comment"># Cut图片，传入文件夹路径，宽，高，基点位置</span></span><br></pre></td></tr></table></figure></h2><h1 id="Ui绘制"><a href="#Ui绘制" class="headerlink" title="Ui绘制"></a>Ui绘制</h1><p>很多朋友说程序黑乎乎的Dos窗口很丑。于是我用PYQT5画了一个简单的Ui界面。</p><p>但，还没将他们关联好。</p><p>未完待续…</p>]]></content>
    
    
    <summary type="html">该死的截图，又让我清点谁没交。但我学会了新的姿势~用上了除了不能生孩子以外都能做的python😇</summary>
    
    
    
    <category term="python" scheme="https://nrhs-space.github.io/categories/python/"/>
    
    
    <category term="python" scheme="https://nrhs-space.github.io/tags/python/"/>
    
    <category term="OCR" scheme="https://nrhs-space.github.io/tags/OCR/"/>
    
  </entry>
  
  <entry>
    <title>我有一个朋友</title>
    <link href="https://nrhs-space.github.io/2022/02/10/Note-I%20have%20a%20friend/"/>
    <id>https://nrhs-space.github.io/2022/02/10/Note-I%20have%20a%20friend/</id>
    <published>2022-02-10T12:45:57.000Z</published>
    <updated>2022-11-13T06:43:02.822Z</updated>
    
    <content type="html"><![CDATA[<p>我有一个朋友，他非常好学。一天，他发现了一个全是漂亮妹妹的<a href="http://w.advancedinsulation.com.cn:61/qq.php?t=164188215388641">网页</a>(๐॔˃̶ᗜ˂̶๐॓)</p><p>他想了想，妹子太多。得留下来慢慢看，于是他决定敲一点简单的代码完成他的愿望。</p><hr><h1 id="致命分析"><a href="#致命分析" class="headerlink" title="致命分析"></a>致命分析</h1><p>打开网页，先不要康漂亮妹妹。在页脚发现【推荐】栏目。</p><p><img src="https://i.bmp.ovh/imgs/2022/02/ff5cccf05891256b.jpg" alt=""></p><p>嗯~，可以利用这个作为一个突破口。</p><p>打开开发者工具，康康漂亮妹纸的图片写法。嗯~，可以嫖。</p><p><img src="https://s3.bmp.ovh/imgs/2022/02/8e0d95705ae2cf2e.jpg" alt=""></p><p>于是他决定开发一款APP。将推荐栏目作为首页推荐，点击后加载所有漂亮妹妹的图片。</p><p>由于【推荐】栏目随机，这也恰好实现了首页栏目的推荐随机~</p><p>我的朋友还想顺便写一个一键保存所有图片功能……</p><h1 id="理论存在，实践开始"><a href="#理论存在，实践开始" class="headerlink" title="理论存在，实践开始"></a>理论存在，实践开始</h1><p>我们决定使用lua编程语言开发，小而轻量。手机端即可操作，童叟无欺，老少皆宜~</p><blockquote><p>开发语言: <a href="https://www.runoob.com/lua/lua-tutorial.html">lua</a></p><p>开发工具: <a href="https://www.andnixsh.com/2020/05/andlua-v66-apk-englishchinese.html">AndroidLua+</a></p><p>开发环境: Android手机</p><p>布局工具: <a href="https://gitee.com/hanwuji886/aluaj-pro">AluaJ助手</a></p></blockquote><h2 id="布局页面"><a href="#布局页面" class="headerlink" title="布局页面"></a>布局页面</h2><p>布局一个滑动窗体，可以左右切换栏目与图片表</p><p>左侧栏目用于显示栏目内容及封面，右侧为所有图片列表</p><details class="folding-tag" cyan><summary> 查看框架布局代码 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  LinearLayout;</span><br><span class="line">  layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">  layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">  orientation=<span class="string">&quot;vertical&quot;</span>;</span><br><span class="line">  &#123;</span><br><span class="line">    CardView;</span><br><span class="line">    layout_height=<span class="string">&quot;wrap_content&quot;</span>;</span><br><span class="line">    backgroundColor=<span class="string">&quot;0xFF2196F3&quot;</span>;</span><br><span class="line">    radius=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">    CardElevation=<span class="string">&quot;3dp&quot;</span>;</span><br><span class="line">    layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">    &#123;</span><br><span class="line">      LinearLayout;</span><br><span class="line">      layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">      layout_marginTop=result;</span><br><span class="line">      &#123;</span><br><span class="line">        LinearLayout;</span><br><span class="line">        orientation=<span class="string">&quot;horizontal&quot;</span>;</span><br><span class="line">        gravity=<span class="string">&quot;center&quot;</span>;</span><br><span class="line">        layout_height=<span class="string">&quot;56dp&quot;</span>;</span><br><span class="line">        layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">        &#123;</span><br><span class="line">          LinearLayout;</span><br><span class="line">          layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">          gravity=<span class="string">&quot;center&quot;</span>;</span><br><span class="line">          &#123;</span><br><span class="line">            CardView;</span><br><span class="line">            layout_height=<span class="string">&quot;80dp&quot;</span>;</span><br><span class="line">            PreventCornerOverlap=<span class="literal">false</span>;</span><br><span class="line">            layout_marginLeft=<span class="string">&quot;-15dp&quot;</span>;</span><br><span class="line">            CardElevation=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">            background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">            radius=<span class="string">&quot;40dp&quot;</span>;</span><br><span class="line">            UseCompatPadding=<span class="literal">false</span>;</span><br><span class="line">            layout_width=<span class="string">&quot;80dp&quot;</span>;</span><br><span class="line">            &#123;</span><br><span class="line">              ImageView;</span><br><span class="line">              layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">              layout_margin=<span class="string">&quot;-10dp&quot;</span>;</span><br><span class="line">              id=<span class="string">&quot;btn&quot;</span>;</span><br><span class="line">              background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">              padding=<span class="string">&quot;38dp&quot;</span>;</span><br><span class="line">              src=<span class="string">&quot;icon/navnav.png&quot;</span>;</span><br><span class="line">              layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">            &#125;;</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        &#123;</span><br><span class="line">          TextView;</span><br><span class="line">          gravity=<span class="string">&quot;center|left&quot;</span>;</span><br><span class="line">          singleLine=<span class="literal">true</span>;</span><br><span class="line">          layout_marginLeft=<span class="string">&quot;-15dp&quot;</span>;</span><br><span class="line">          layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">          text=activity.getTitle();</span><br><span class="line">          id=<span class="string">&quot;title&quot;</span>;</span><br><span class="line">          textSize=<span class="string">&quot;19dp&quot;</span>;</span><br><span class="line">          ellipsize=<span class="string">&quot;end&quot;</span>;</span><br><span class="line">          layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">          layout_weight=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">          textColor=<span class="string">&quot;#FFFFFF&quot;</span>;</span><br><span class="line">        &#125;;</span><br><span class="line">        &#123;</span><br><span class="line">          CardView;</span><br><span class="line">          layout_height=<span class="string">&quot;65dp&quot;</span>;</span><br><span class="line">          PreventCornerOverlap=<span class="literal">false</span>;</span><br><span class="line">          CardElevation=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">          layout_marginRight=<span class="string">&quot;-17dp&quot;</span>;</span><br><span class="line">          background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">          radius=<span class="string">&quot;33dp&quot;</span>;</span><br><span class="line">          UseCompatPadding=<span class="literal">false</span>;</span><br><span class="line">          layout_width=<span class="string">&quot;65dp&quot;</span>;</span><br><span class="line">          &#123;</span><br><span class="line">            ImageView;</span><br><span class="line">            layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">            layout_margin=<span class="string">&quot;-10dp&quot;</span>;</span><br><span class="line">            id=<span class="string">&quot;btn1&quot;</span>;</span><br><span class="line">            background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">            padding=<span class="string">&quot;28dp&quot;</span>;</span><br><span class="line">            src=<span class="string">&quot;icon/ic_package_variant.png&quot;</span>;</span><br><span class="line">            layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        &#123;</span><br><span class="line">          CardView;</span><br><span class="line">          layout_height=<span class="string">&quot;65dp&quot;</span>;</span><br><span class="line">          PreventCornerOverlap=<span class="literal">false</span>;</span><br><span class="line">          CardElevation=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">          layout_marginRight=<span class="string">&quot;-19dp&quot;</span>;</span><br><span class="line">          background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">          radius=<span class="string">&quot;33dp&quot;</span>;</span><br><span class="line">          UseCompatPadding=<span class="literal">false</span>;</span><br><span class="line">          layout_width=<span class="string">&quot;65dp&quot;</span>;</span><br><span class="line">          &#123;</span><br><span class="line">            ImageView;</span><br><span class="line">            layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">            layout_margin=<span class="string">&quot;-10dp&quot;</span>;</span><br><span class="line">            id=<span class="string">&quot;btn2&quot;</span>;</span><br><span class="line">            background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">            padding=<span class="string">&quot;28dp&quot;</span>;</span><br><span class="line">            src=<span class="string">&quot;icon/ic_right.png&quot;</span>;</span><br><span class="line">            layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        &#123;</span><br><span class="line">          CardView;</span><br><span class="line">          layout_height=<span class="string">&quot;65dp&quot;</span>;</span><br><span class="line">          PreventCornerOverlap=<span class="literal">false</span>;</span><br><span class="line">          CardElevation=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">          layout_marginRight=<span class="string">&quot;-10dp&quot;</span>;</span><br><span class="line">          background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">          radius=<span class="string">&quot;33dp&quot;</span>;</span><br><span class="line">          UseCompatPadding=<span class="literal">false</span>;</span><br><span class="line">          layout_width=<span class="string">&quot;65dp&quot;</span>;</span><br><span class="line">          &#123;</span><br><span class="line">            TextView;</span><br><span class="line">            layout_height=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">            id=<span class="string">&quot;menu&quot;</span>;</span><br><span class="line">            layout_marginLeft=<span class="string">&quot;-145dp&quot;</span>;</span><br><span class="line">            layout_marginTop=<span class="string">&quot;10dp&quot;</span>;</span><br><span class="line">            layout_width=<span class="string">&quot;0dp&quot;</span>;</span><br><span class="line">          &#125;;</span><br><span class="line">          &#123;</span><br><span class="line">            ImageView;</span><br><span class="line">            layout_height=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">            layout_margin=<span class="string">&quot;-10dp&quot;</span>;</span><br><span class="line">            id=<span class="string">&quot;btn3&quot;</span>;</span><br><span class="line">            background=<span class="string">&quot;#00000000&quot;</span>;</span><br><span class="line">            padding=<span class="string">&quot;31dp&quot;</span>;</span><br><span class="line">            src=<span class="string">&quot;icon/abc_ic_menu_moreoverflow_mtrl_alpha.png&quot;</span>;</span><br><span class="line">            layout_width=<span class="string">&quot;match_parent&quot;</span>;</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  &#123;</span><br><span class="line">    LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">    orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">    &#123;</span><br><span class="line">      PageView;<span class="comment">--滑动窗体</span></span><br><span class="line">      id=<span class="string">&quot;img_hd&quot;</span>,</span><br><span class="line">      pages=&#123;</span><br><span class="line">              &#123;</span><br><span class="line">                LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">                orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">                layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">                layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">                background=<span class="string">&#x27;#f1e8ae8&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">                &#123;</span><br><span class="line">                  CardView;<span class="comment">--卡片控件</span></span><br><span class="line">                  layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">                  layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                  <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                  elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">                  layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                  layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                  CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">                  radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">                  &#123;</span><br><span class="line">                    GridView,<span class="comment">--网格控件</span></span><br><span class="line">                    layout_width=<span class="string">&quot;fill&quot;</span>,<span class="comment">--布局宽度</span></span><br><span class="line">                    layout_height=<span class="string">&quot;wrap&quot;</span>,<span class="comment">--布局高度</span></span><br><span class="line">                    gravity=<span class="string">&quot;center&quot;</span>,<span class="comment">--重力居中</span></span><br><span class="line">                    numColumns=<span class="string">&quot;1&quot;</span>,<span class="comment">--设置列数</span></span><br><span class="line">                    overScrollMode=<span class="string">&quot;2&quot;</span>,<span class="comment">--去除滑动圆弧形</span></span><br><span class="line">                    verticalScrollBarEnabled=<span class="literal">false</span>,<span class="comment">--隐藏滑条</span></span><br><span class="line">                    id=<span class="string">&quot;fm_wg&quot;</span>,<span class="comment">--控件ID</span></span><br><span class="line">                  &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                &#123;</span><br><span class="line">                  CardView;<span class="comment">--卡片控件</span></span><br><span class="line">                  layout_margin=<span class="string">&#x27;16dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">                  layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                  <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                  elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">                  layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                  layout_height=<span class="string">&#x27;4.5%h&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                  CardBackgroundColor=<span class="string">&#x27;#c000000&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">                  radius=<span class="string">&#x27;5dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">                  id=<span class="string">&quot;f5&quot;</span>,</span><br><span class="line">                  &#123;</span><br><span class="line">                    TextView;<span class="comment">--文本控件</span></span><br><span class="line">                    gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                    <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                    layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                    textColor=<span class="string">&#x27;#87000000&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">                    text=<span class="string">&#x27;loading...&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">                    textSize=<span class="string">&#x27;14dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">                    id=<span class="string">&quot;tip&quot;</span>;</span><br><span class="line">                    textIsSelectable=<span class="literal">false</span><span class="comment">--长按复制</span></span><br><span class="line">                  &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">                &#123;</span><br><span class="line">                  CardView;<span class="comment">--卡片控件</span></span><br><span class="line">                  layout_margin=<span class="string">&#x27;16dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">                  layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                  <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                  elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">                  layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                  layout_height=<span class="string">&#x27;4.5%h&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                  CardBackgroundColor=<span class="string">&#x27;#c000000&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">                  radius=<span class="string">&#x27;5dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">                  id=<span class="string">&quot;download&quot;</span>,</span><br><span class="line">                  &#123;</span><br><span class="line">                    TextView;<span class="comment">--文本控件</span></span><br><span class="line">                    gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                    <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                    layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                    textColor=<span class="string">&#x27;#87000000&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">                    text=<span class="string">&#x27;批量下载图片&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">                    textSize=<span class="string">&#x27;14dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">                    textIsSelectable=<span class="literal">false</span><span class="comment">--长按复制</span></span><br><span class="line">                  &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">              &#125;;</span><br><span class="line">              <span class="comment">--</span></span><br><span class="line">              &#123;</span><br><span class="line">                LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">                orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">                layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">                layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">                background=<span class="string">&#x27;#00FFFFFF&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">                &#123;</span><br><span class="line">                  CardView;<span class="comment">--卡片控件</span></span><br><span class="line">                  layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">                  layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                  <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                  elevation=<span class="string">&#x27;5dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">                  layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                  layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                  CardBackgroundColor=<span class="string">&#x27;#ffffffff&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">                  radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">                  &#123;</span><br><span class="line">                    GridView,<span class="comment">--网格控件</span></span><br><span class="line">                    layout_width=<span class="string">&quot;fill&quot;</span>,<span class="comment">--布局宽度</span></span><br><span class="line">                    layout_height=<span class="string">&quot;wrap&quot;</span>,<span class="comment">--布局高度</span></span><br><span class="line">                    gravity=<span class="string">&quot;center&quot;</span>,<span class="comment">--重力居中</span></span><br><span class="line">                    numColumns=<span class="string">&quot;1&quot;</span>,<span class="comment">--设置列数</span></span><br><span class="line">                    overScrollMode=<span class="string">&quot;2&quot;</span>,<span class="comment">--去除滑动圆弧形</span></span><br><span class="line">                    verticalScrollBarEnabled=<span class="literal">true</span>,<span class="comment">--隐藏滑条</span></span><br><span class="line">                    id=<span class="string">&quot;bzwg&quot;</span>,<span class="comment">--控件ID</span></span><br><span class="line">                  &#125;;</span><br><span class="line">                  &#123;</span><br><span class="line">                    CardView;<span class="comment">--卡片控件</span></span><br><span class="line">                    layout_margin=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">                    layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                    <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                    elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">                    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                    layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                    CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">                    radius=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">                    id=<span class="string">&quot;tips&quot;</span>,</span><br><span class="line">                    &#123;</span><br><span class="line">                      TextView;<span class="comment">--文本控件</span></span><br><span class="line">                      gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">                      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">                      layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">                      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">                      textColor=<span class="string">&#x27;#32000000&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">                      text=<span class="string">&#x27;你还没选择妹子呢┐(´-｀)┌&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">                      textSize=<span class="string">&#x27;14dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">                      textIsSelectable=<span class="literal">false</span><span class="comment">--长按复制</span></span><br><span class="line">                    &#125;;</span><br><span class="line">                  &#125;;</span><br><span class="line">                &#125;;</span><br><span class="line">              &#125;;</span><br><span class="line">              <span class="comment">--</span></span><br><span class="line">            &#125;;</span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 封面适配 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">  orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">  layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">  layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">  background=<span class="string">&#x27;#00FFFFFF&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">  &#123;</span><br><span class="line">    CardView;<span class="comment">--卡片控件</span></span><br><span class="line">    layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">    layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">    <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">    elevation=<span class="string">&#x27;5dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;20%h&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">    CardBackgroundColor=<span class="string">&#x27;#ffffffff&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">    radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">    &#123;</span><br><span class="line">      ImageView;<span class="comment">--图片控件</span></span><br><span class="line">      id=<span class="string">&quot;tp_fm&quot;</span>;</span><br><span class="line">      <span class="comment">-- src=&#x27;https://c2cpicdw.qpic.cn/offpic_new//2697808752-3475747673-7E9ACC2E12FF6A70FF8B35FAACE2A8B0/0&#x27;;--图片路径</span></span><br><span class="line">      layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">      scaleType=<span class="string">&#x27;centerCrop&#x27;</span>;<span class="comment">--图片显示类型</span></span><br><span class="line">    &#125;;</span><br><span class="line">    &#123;</span><br><span class="line">      CardView;<span class="comment">--卡片控件</span></span><br><span class="line">      layout_margin=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">      layout_gravity=<span class="string">&#x27;bottom&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">      elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">      layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">      CardBackgroundColor=<span class="string">&#x27;#ffffff&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">      radius=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">      &#123;</span><br><span class="line">        TextView;<span class="comment">--文本控件</span></span><br><span class="line">        id=<span class="string">&quot;text&quot;</span>,</span><br><span class="line">        gravity=<span class="string">&#x27;right&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">        layout_marginRight=<span class="string">&#x27;15px&#x27;</span>;<span class="comment">--右距</span></span><br><span class="line">        layout_marginBottom=<span class="string">&#x27;12px&#x27;</span>;<span class="comment">--底距</span></span><br><span class="line">        <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">        layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;14sp&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        textColor=<span class="string">&#x27;#4c000000&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">        textSize=<span class="string">&#x27;14dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">        textIsSelectable=<span class="literal">false</span><span class="comment">--长按复制</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" cyan><summary> 图片列表布局适配 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">  orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">  layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">  layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">  background=<span class="string">&#x27;#00FFFFFF&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">  &#123;</span><br><span class="line">    CardView;<span class="comment">--卡片控件</span></span><br><span class="line">    layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">    layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">    <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">    elevation=<span class="string">&#x27;5dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">    layout_width=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">    layout_minheight=<span class="string">&#x27;20%h&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">    CardBackgroundColor=<span class="string">&#x27;#ffffffff&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">    radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">    &#123;</span><br><span class="line">      ImageView;<span class="comment">--图片控件</span></span><br><span class="line">      id=<span class="string">&quot;tp&quot;</span>,</span><br><span class="line">      src=<span class="string">&#x27;&#x27;</span>;<span class="comment">--图片路径</span></span><br><span class="line">      layout_width=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">      scaleType=<span class="string">&#x27;fitXY&#x27;</span>;<span class="comment">--图片显示类型</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>              </div>            </details><hr><p>到这里就帮助我的好朋友完成了布局</p><h2 id="主函数调用及爬虫配置"><a href="#主函数调用及爬虫配置" class="headerlink" title="主函数调用及爬虫配置"></a>主函数调用及爬虫配置</h2><details class="folding-tag" yellow><summary> 程序启动开始爬取推荐 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">list=&#123;[<span class="number">1</span>]=<span class="string">&quot;163690361614072&quot;</span>,[<span class="number">2</span>]=<span class="string">&quot;163971663641960&quot;</span>,[<span class="number">3</span>]=<span class="string">&quot;164103476922468&quot;</span>,[<span class="number">4</span>]=<span class="string">&quot;164103767225808&quot;</span>,[<span class="number">5</span>]=<span class="string">&quot;163826289956514&quot;</span>,[<span class="number">6</span>]=<span class="string">&quot;163842588189291&quot;</span>,[<span class="number">7</span>]=<span class="string">&quot;163819406521636&quot;</span>&#125;</span><br><span class="line">url=<span class="string">&quot;http://w.advancedinsulation.com.cn:61/qq.php?t=&quot;</span>..list[<span class="built_in">math</span>.<span class="built_in">random</span>(<span class="number">1</span>,<span class="number">7</span>)];</span><br><span class="line">Http.get(url,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="function"><span class="keyword">function</span><span class="params">(code,content)</span></span></span><br><span class="line">  <span class="keyword">if</span> code==<span class="number">200</span> <span class="keyword">then</span></span><br><span class="line">    title=content:<span class="built_in">gmatch</span>(<span class="string">[[&lt;title&gt;(.-)&lt;/title&gt;]]</span>)</span><br><span class="line">    content=content:<span class="built_in">match</span>(<span class="string">[[随机推荐(.-)section]]</span>)</span><br><span class="line">    p=content:<span class="built_in">gmatch</span>(<span class="string">[[php.-t=(.-)&#x27;]]</span>)</span><br><span class="line">    t=content:<span class="built_in">gmatch</span>(<span class="string">[[&lt;p&gt;(.-)&lt;/p&gt;]]</span>)</span><br><span class="line">    p_tab=&#123;&#125;</span><br><span class="line">    t_tab=&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> p <span class="keyword">do</span></span><br><span class="line">      <span class="built_in">table</span>.<span class="built_in">insert</span>(p_tab,i)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> t <span class="keyword">do</span></span><br><span class="line">      <span class="built_in">table</span>.<span class="built_in">insert</span>(t_tab,s)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    adp=LuaAdapter(activity,data,item_fm)</span><br><span class="line">    f5_s(t_tab,p_tab)</span><br><span class="line">    fm_wg.Adapter=adp</span><br><span class="line">    fm_wg.onItemClick=<span class="function"><span class="keyword">function</span><span class="params">(p,v,i,s)</span></span></span><br><span class="line">      img_forcode(<span class="built_in">tostring</span>(<span class="string">&quot;遍历表&quot;</span>..i+<span class="number">1</span>)) </span><br><span class="line">      <span class="comment">--print(p_tab[s])</span></span><br><span class="line">      img_hd.showPage(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    fm_wg.onItemLongClick=<span class="function"><span class="keyword">function</span><span class="params">(p,v,i,s)</span></span></span><br><span class="line">      弹出消息(<span class="string">&quot;已复制链接&quot;</span>)</span><br><span class="line">      activity.getSystemService(Context.CLIPBOARD_SERVICE).setText(<span class="string">&#x27;http://w.advancedinsulation.com.cn:61/qq.php?t=&#x27;</span>..p_tab[s])</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    f5.onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--点击事件</span></span><br><span class="line">      adp.clear()<span class="comment">--清空适配器</span></span><br><span class="line">      f5_s(t_tab,p_tab)</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">print</span>(code)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> f5_s刷新函数 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f5_s</span><span class="params">(tab_t,tab_p)</span></span></span><br><span class="line">  <span class="keyword">for</span> i=<span class="number">1</span>,#tab_p <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">      url_code(<span class="string">&#x27;http://w.advancedinsulation.com.cn:61/qq.php?t=&#x27;</span>..tab_p[i])</span><br><span class="line">      code_b=<span class="built_in">tostring</span>(<span class="string">&quot;遍历表&quot;</span>..i)</span><br><span class="line">      task(<span class="number">500</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--1000毫秒=1秒</span></span><br><span class="line">        <span class="comment">--print(&quot;我是&quot;..code_b..遍历表1[1])</span></span><br><span class="line">        adp.add&#123;tp_fm=遍历表<span class="number">1</span>[<span class="number">1</span>],text=<span class="string">&quot;--&quot;</span>..tab_t[<span class="number">1</span>]&#125;</span><br><span class="line">      <span class="keyword">end</span>)</span><br><span class="line">     <span class="keyword">elseif</span> i==<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">      url_code(<span class="string">&#x27;http://w.advancedinsulation.com.cn:61/qq.php?t=&#x27;</span>..tab_p[i])</span><br><span class="line">      code_b=<span class="built_in">tostring</span>(<span class="string">&quot;遍历表&quot;</span>..i)</span><br><span class="line">      task(<span class="number">1000</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--1000毫秒=1秒</span></span><br><span class="line">        <span class="comment">--print(&quot;我是&quot;..code_b..遍历表2[1])</span></span><br><span class="line">        adp.add&#123;tp_fm=遍历表<span class="number">2</span>[<span class="number">1</span>],text=<span class="string">&quot;--&quot;</span>..tab_t[<span class="number">2</span>]&#125;</span><br><span class="line">      <span class="keyword">end</span>)</span><br><span class="line">     <span class="keyword">elseif</span> i==<span class="number">3</span> <span class="keyword">then</span></span><br><span class="line">      url_code(<span class="string">&#x27;http://w.advancedinsulation.com.cn:61/qq.php?t=&#x27;</span>..tab_p[i])</span><br><span class="line">      code_b=<span class="built_in">tostring</span>(<span class="string">&quot;遍历表&quot;</span>..i)</span><br><span class="line">      task(<span class="number">1000</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--1000毫秒=1秒</span></span><br><span class="line">        <span class="comment">--print(&quot;我是&quot;..code_b..遍历表3[1])</span></span><br><span class="line">        adp.add&#123;tp_fm=遍历表<span class="number">3</span>[<span class="number">1</span>],text=<span class="string">&quot;--&quot;</span>..tab_t[<span class="number">3</span>]&#125;</span><br><span class="line">      <span class="keyword">end</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> url_code获取推荐链接页面的所有图片 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">url_code</span><span class="params">(url)</span></span></span><br><span class="line">  <span class="comment">--url=&quot;http://w.advancedinsulation.com.cn:61/qq.php?t=163690361614072&quot;</span></span><br><span class="line">  <span class="keyword">if</span> a_tab==<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    a_tab=a_tab+<span class="number">1</span></span><br><span class="line">    Http.get(url,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="function"><span class="keyword">function</span><span class="params">(code,content)</span></span></span><br><span class="line">      <span class="keyword">if</span> code==<span class="number">200</span> <span class="keyword">then</span></span><br><span class="line">        遍历=content:<span class="built_in">gmatch</span>(<span class="string">[[&lt;img.-src=&quot;(.-)&quot;]]</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> 遍历 <span class="keyword">do</span></span><br><span class="line">          <span class="keyword">if</span> <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">5</span>)==<span class="string">&quot;https&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">1</span>,i)</span><br><span class="line">           <span class="keyword">elseif</span></span><br><span class="line">            <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">5</span>)==<span class="string">&quot;http:&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">string</span>.<span class="built_in">gsub</span>(i,<span class="string">&quot;http&quot;</span>,<span class="string">&quot;https&quot;</span>)</span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">1</span>,i)</span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">1</span>,<span class="string">&quot;https&quot;</span>..i)</span><br><span class="line">          <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">--print(#遍历表1)</span></span><br><span class="line">        <span class="comment">--响应失败</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">print</span>(code)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line">   <span class="keyword">elseif</span> a_tab==<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">    a_tab=a_tab+<span class="number">1</span></span><br><span class="line">    Http.get(url,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="function"><span class="keyword">function</span><span class="params">(code,content)</span></span></span><br><span class="line">      <span class="keyword">if</span> code==<span class="number">200</span> <span class="keyword">then</span></span><br><span class="line">        遍历=content:<span class="built_in">gmatch</span>(<span class="string">[[&lt;img.-src=&quot;(.-)&quot;]]</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> 遍历 <span class="keyword">do</span></span><br><span class="line">          <span class="keyword">if</span> <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">5</span>)==<span class="string">&quot;https&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">2</span>,i)</span><br><span class="line">           <span class="keyword">elseif</span></span><br><span class="line">            <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">5</span>)==<span class="string">&quot;http:&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">string</span>.<span class="built_in">gsub</span>(i,<span class="string">&quot;http&quot;</span>,<span class="string">&quot;https&quot;</span>)</span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">2</span>,i)</span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">2</span>,<span class="string">&quot;https&quot;</span>..i)</span><br><span class="line">          <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">--print(#遍历表2)</span></span><br><span class="line">        <span class="comment">--响应失败</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">print</span>(code)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line">   <span class="keyword">elseif</span> a_tab==<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">    Http.get(url,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="function"><span class="keyword">function</span><span class="params">(code,content)</span></span></span><br><span class="line">      <span class="keyword">if</span> code==<span class="number">200</span> <span class="keyword">then</span></span><br><span class="line">        遍历=content:<span class="built_in">gmatch</span>(<span class="string">[[&lt;img.-src=&quot;(.-)&quot;]]</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> 遍历 <span class="keyword">do</span></span><br><span class="line">          <span class="keyword">if</span> <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">5</span>)==<span class="string">&quot;https&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">3</span>,i)</span><br><span class="line">           <span class="keyword">elseif</span></span><br><span class="line">            <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">5</span>)==<span class="string">&quot;http:&quot;</span> <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">string</span>.<span class="built_in">gsub</span>(i,<span class="string">&quot;http&quot;</span>,<span class="string">&quot;https&quot;</span>)</span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">3</span>,i)</span><br><span class="line">           <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">table</span>.<span class="built_in">insert</span>(遍历表<span class="number">3</span>,<span class="string">&quot;https&quot;</span>..i)</span><br><span class="line">          <span class="keyword">end</span></span><br><span class="line">          tip.setText(<span class="string">&quot;——不能加载太多，不然身体受不了——&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">-- print(#遍历表3)</span></span><br><span class="line">        <span class="comment">--响应失败</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">print</span>(code)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line">  <span class="keyword">end</span> <span class="comment">--判断结束</span></span><br><span class="line"><span class="keyword">end</span><span class="comment">--函数结束</span></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> img_forcode加载所有图片函数 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">img_forcode</span><span class="params">(for_img)</span></span></span><br><span class="line">  <span class="comment">--print(for_img..#for_img)</span></span><br><span class="line">  <span class="keyword">if</span> for_img==<span class="string">&quot;遍历表1&quot;</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">for</span> s=<span class="number">1</span>,#for_img <span class="keyword">do</span></span><br><span class="line">      <span class="comment">--print(&quot;imy&quot;..遍历表1[s])</span></span><br><span class="line">      adp2=LuaAdapter(activity,data,item)</span><br><span class="line">      <span class="keyword">for</span> s=<span class="number">1</span> , #遍历表<span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">        adp2.add&#123;tp=遍历表<span class="number">1</span>[s]&#125;</span><br><span class="line">        tips.setVisibility(View.GONE)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      bzwg.Adapter=adp2</span><br><span class="line">      bzwg.onItemClick=<span class="function"><span class="keyword">function</span><span class="params">(l,v,p,s)</span></span></span><br><span class="line">        图片链接(遍历表<span class="number">1</span>[s])<span class="comment">--调用一个包下载图片，需要包tptc</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">elseif</span> for_img==<span class="string">&quot;遍历表2&quot;</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">for</span> s=<span class="number">1</span>,#for_img <span class="keyword">do</span></span><br><span class="line">      <span class="comment">--print(&quot;imt&quot;..遍历表2[s])</span></span><br><span class="line">      adp2=LuaAdapter(activity,data,item)</span><br><span class="line">      <span class="keyword">for</span> s=<span class="number">1</span> , #遍历表<span class="number">2</span> <span class="keyword">do</span></span><br><span class="line">        adp2.add&#123;tp=遍历表<span class="number">2</span>[s]&#125;</span><br><span class="line">        tips.setVisibility(View.GONE)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      bzwg.Adapter=adp2</span><br><span class="line">      bzwg.onItemClick=<span class="function"><span class="keyword">function</span><span class="params">(l,v,p,s)</span></span></span><br><span class="line">        图片链接(遍历表<span class="number">2</span>[s])</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">   <span class="keyword">elseif</span> for_img==<span class="string">&quot;遍历表3&quot;</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">for</span> s=<span class="number">1</span>,#for_img <span class="keyword">do</span></span><br><span class="line">      <span class="comment">--print(&quot;ims&quot;..遍历表3[s])</span></span><br><span class="line">      adp2=LuaAdapter(activity,data,item)</span><br><span class="line">      <span class="keyword">for</span> s=<span class="number">1</span> , #遍历表<span class="number">3</span> <span class="keyword">do</span></span><br><span class="line">        adp2.add&#123;tp=遍历表<span class="number">3</span>[s]&#125;</span><br><span class="line">        tips.setVisibility(View.GONE)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      bzwg.Adapter=adp2</span><br><span class="line">      bzwg.onItemClick=<span class="function"><span class="keyword">function</span><span class="params">(l,v,p,s)</span></span></span><br><span class="line">        图片链接(遍历表<span class="number">3</span>[s])</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> 需要引用的文件及声明的数据 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">&quot;content&quot;</span></span><br><span class="line">import <span class="string">&quot;item&quot;</span></span><br><span class="line">import <span class="string">&quot;item_fm&quot;</span></span><br><span class="line">import <span class="string">&quot;tptc&quot;</span></span><br><span class="line"></span><br><span class="line">a_tab=<span class="number">0</span></span><br><span class="line">遍历表<span class="number">1</span>=&#123;&#125;</span><br><span class="line">遍历表<span class="number">2</span>=&#123;&#125;</span><br><span class="line">遍历表<span class="number">3</span>=&#123;&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" yellow><summary> 创建文件保存位置文件夹 </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--文件写入</span></span><br><span class="line">import<span class="string">&quot;java.io.File&quot;</span></span><br><span class="line"><span class="keyword">if</span> File(<span class="string">&quot;/sdcard/DCIM/meizT/&quot;</span>).exists()</span><br><span class="line">  <span class="keyword">and</span> File(<span class="string">&quot;/sdcard/DCIM/meizT/批量下载/&quot;</span>).exists()</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">  <span class="comment">--文件存在事件</span></span><br><span class="line"> <span class="keyword">else</span></span><br><span class="line">  File(<span class="string">&quot;/sdcard/DCIM/meizT/&quot;</span>).mkdir()<span class="comment">--不存在 则创建</span></span><br><span class="line">  File(<span class="string">&quot;/sdcard/DCIM/meizT/批量下载/&quot;</span>).mkdir()<span class="comment">--不存在 则创建</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>              </div>            </details><hr><h2 id="封装的方法"><a href="#封装的方法" class="headerlink" title="封装的方法"></a>封装的方法</h2><p>这是封装了一个图片展示的弹窗界面</p><p>import这个文件后只需要传入图片url即可: 图片链接(url)</p><p>效果详见最后的gif动画</p><p>原来是在FusionAPP上使用，分享图片功能正常。但是拿到AndLua+上面奇奇怪怪的，就阉割了，把分享图片改成了分享图片url。</p><p>写得略微有点潦草，应该将文件保存路径写成path传入。但是懒得改，文件保存的路径记得改改哦！</p><details class="folding-tag" yellow><summary> 图片展示封装tptc </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">&quot;android.content.*&quot;</span></span><br><span class="line">import <span class="string">&quot;android.content.Intent&quot;</span></span><br><span class="line">import <span class="string">&quot;android.net.Uri&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 弹出消息<span class="params">(文本)</span></span></span><br><span class="line">  tcxx=&#123;</span><br><span class="line">    LinearLayout;<span class="comment">--线性布局</span></span><br><span class="line">    orientation=<span class="string">&#x27;vertical&#x27;</span>;<span class="comment">--布局方向</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局高度</span></span><br><span class="line">    &#123;</span><br><span class="line">      CardView;<span class="comment">--卡片控件</span></span><br><span class="line">      layout_width=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--卡片宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--卡片高度</span></span><br><span class="line">      CardBackgroundColor=<span class="string">&#x27;#aaeeeeee&#x27;</span>;<span class="comment">--卡片颜色</span></span><br><span class="line">      elevation=<span class="number">0</span>;<span class="comment">--阴影属性</span></span><br><span class="line">      radius=<span class="string">&#x27;12dp&#x27;</span>;<span class="comment">--卡片圆角</span></span><br><span class="line">      &#123;</span><br><span class="line">        TextView;</span><br><span class="line">        layout_width=<span class="string">&quot;wrap&quot;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">        layout_height=<span class="string">&quot;wrap&quot;</span>;<span class="comment">--布局高度</span></span><br><span class="line">        background=<span class="string">&quot;#cc000000&quot;</span>;<span class="comment">--背景颜色</span></span><br><span class="line">        padding=<span class="string">&quot;8dp&quot;</span>;<span class="comment">--布局填充</span></span><br><span class="line">        textSize=<span class="string">&quot;15sp&quot;</span>;<span class="comment">--文字大小</span></span><br><span class="line">        TextColor=<span class="string">&quot;#ffeeeeee&quot;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">        gravity=<span class="string">&quot;center&quot;</span>;<span class="comment">--布局居中</span></span><br><span class="line">        id=<span class="string">&quot;wenzi&quot;</span>;<span class="comment">--控件ID</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">local</span> toast=Toast.makeText(activity,<span class="string">&quot;文本&quot;</span>,Toast.LENGTH_SHORT).setView(loadlayout(tcxx))</span><br><span class="line">  toast.setGravity(Gravity.BOTTOM,<span class="number">0</span>,<span class="number">120</span>)</span><br><span class="line">  wenzi.Text=<span class="built_in">tostring</span>(<span class="string">&quot;&quot;</span>..文本..<span class="string">&quot;&quot;</span>)</span><br><span class="line">  toast.show()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 分享文件<span class="params">(路径)</span></span></span><br><span class="line">  路径=<span class="built_in">tostring</span>(路径)</span><br><span class="line">  弹出消息(<span class="string">&quot;已复制链接.&quot;</span>)</span><br><span class="line">  activity.getSystemService(Context.CLIPBOARD_SERVICE).setText(路径)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> 图片链接<span class="params">(path)</span></span></span><br><span class="line">  弹窗框架=</span><br><span class="line">  <span class="comment">--创建布局在这里</span></span><br><span class="line">  &#123;</span><br><span class="line">    LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">    orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">    background=<span class="string">&#x27;#00FFFFFF&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">    &#123;</span><br><span class="line">      CardView;<span class="comment">--卡片控件</span></span><br><span class="line">      layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">      layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">      elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">      layout_width=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">      CardBackgroundColor=<span class="string">&#x27;#ffffffff&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">      radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">      id=<span class="string">&quot;tckp&quot;</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        ImageView;<span class="comment">--图片控件</span></span><br><span class="line">        src=<span class="built_in">path</span>;<span class="comment">--图片路径</span></span><br><span class="line">        layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        scaleType=<span class="string">&#x27;centerCrop&#x27;</span>;<span class="comment">--图片显示类型</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    &#123;</span><br><span class="line">      CardView;<span class="comment">--卡片控件</span></span><br><span class="line">      layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">      layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">      elevation=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">      layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;10%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">      CardBackgroundColor=<span class="string">&#x27;#ffffffff&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">      radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">      &#123;</span><br><span class="line">        CardView;<span class="comment">--卡片控件</span></span><br><span class="line">        layout_gravity=<span class="string">&#x27;left|center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">        <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">        elevation=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">        layout_width=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">        radius=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">        layout_marginLeft=<span class="string">&#x27;2%w&#x27;</span>;<span class="comment">--左距</span></span><br><span class="line">        id=<span class="string">&quot;fx&quot;</span>;</span><br><span class="line">        onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">          <span class="keyword">local</span> sj=<span class="built_in">os</span>.<span class="built_in">date</span>(<span class="string">&quot;%M-%S&quot;</span>)</span><br><span class="line">          Http.download(<span class="built_in">path</span>,<span class="string">&quot;/sdcard/DCIM/meizT/&quot;</span>..<span class="string">&#x27;cytp-&#x27;</span>..sj..<span class="string">&quot;.jpg&quot;</span>,<span class="function"><span class="keyword">function</span><span class="params">(a)</span></span></span><br><span class="line">          <span class="keyword">end</span>)</span><br><span class="line">          分享文件(<span class="string">&quot;/sdcard/DCIM/meizT/&quot;</span>..<span class="string">&#x27;cytp-&#x27;</span>..sj..<span class="string">&quot;.jpg&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">        &#123;</span><br><span class="line">          ImageView;<span class="comment">--图片控件</span></span><br><span class="line">          src=<span class="string">&#x27;icon/fx.png&#x27;</span>;<span class="comment">--图片路径</span></span><br><span class="line">          layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">          layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">          scaleType=<span class="string">&#x27;fitXY&#x27;</span>;<span class="comment">--图片显示类型</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line">      &#123;</span><br><span class="line">        CardView;<span class="comment">--卡片控件</span></span><br><span class="line">        layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">        <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">        elevation=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">        layout_width=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">        radius=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">        onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">          弹出消息(<span class="string">&quot;图片已保存到/sdcard/DCIM/meizT.&quot;</span>)</span><br><span class="line">          Http.download(<span class="built_in">path</span>,<span class="string">&quot;/sdcard/DCIM/meizT/&quot;</span>..<span class="string">&#x27;cytp-&#x27;</span>..<span class="built_in">os</span>.<span class="built_in">date</span>(<span class="string">&quot;%M-%S&quot;</span>)..<span class="string">&quot;.jpg&quot;</span>,<span class="function"><span class="keyword">function</span><span class="params">(a)</span></span></span><br><span class="line">          <span class="keyword">end</span>)</span><br><span class="line">          a.dismiss()</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line">          ImageView;<span class="comment">--图片控件</span></span><br><span class="line">          src=<span class="string">&#x27;icon/xz.png&#x27;</span>;<span class="comment">--图片路径</span></span><br><span class="line">          layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">          layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">          scaleType=<span class="string">&#x27;fitXY&#x27;</span>;<span class="comment">--图片显示类型</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line">      &#123;</span><br><span class="line">        CardView;<span class="comment">--卡片控件</span></span><br><span class="line">        layout_gravity=<span class="string">&#x27;center|right&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">        <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">        elevation=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">        layout_width=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">        radius=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">        layout_marginRight=<span class="string">&#x27;2%w&#x27;</span>;<span class="comment">--右距</span></span><br><span class="line">        <span class="comment">--id=&quot;gb&quot;;</span></span><br><span class="line">        onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--点击事件</span></span><br><span class="line">          a.dismiss()</span><br><span class="line">        <span class="keyword">end</span>;</span><br><span class="line">        &#123;</span><br><span class="line">          ImageView;<span class="comment">--图片控件</span></span><br><span class="line">          id=<span class="string">&quot;gb&quot;</span>;</span><br><span class="line">          src=<span class="string">&#x27;icon/gb.png&#x27;</span>;<span class="comment">--图片路径</span></span><br><span class="line">          layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">          layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">          scaleType=<span class="string">&#x27;fitXY&#x27;</span>;<span class="comment">--图片显示类型</span></span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">--</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  import<span class="string">&quot;android.graphics.drawable.ColorDrawable&quot;</span></span><br><span class="line">  <span class="comment">--.setCancelable(false)--禁用返回键</span></span><br><span class="line">  a=AlertDialog.Builder(this).show()</span><br><span class="line">  a.getWindow().setContentView(loadlayout(弹窗框架));</span><br><span class="line">  a.getWindow().setBackgroundDrawable(ColorDrawable(<span class="number">0x00000000</span>));</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> 振幅动画<span class="params">(id,mo,v,e,b,xx,yy)</span></span></span><br><span class="line">    e= e/<span class="number">100</span></span><br><span class="line">    b=b/<span class="number">500</span></span><br><span class="line">    sj = <span class="built_in">math</span>.<span class="built_in">random</span>(-v,v)</span><br><span class="line">    eee = v</span><br><span class="line">    vvti=Ticker()</span><br><span class="line">    vvti.Period=<span class="number">5</span></span><br><span class="line">    vvti.onTick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">      v = <span class="built_in">math</span>.<span class="built_in">sin</span>(sj)</span><br><span class="line">      bod = (-eee - eee)*v</span><br><span class="line">      eee = eee - b</span><br><span class="line">      sj =sj + e</span><br><span class="line">      <span class="keyword">if</span> eee &lt;<span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">        vvti.stop()</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      <span class="keyword">if</span> mo==<span class="number">1</span> <span class="keyword">then</span></span><br><span class="line">        id.setRotation(bod)</span><br><span class="line">       <span class="keyword">elseif</span> mo==<span class="number">2</span> <span class="keyword">then</span></span><br><span class="line">        id.setRotationX(bod)</span><br><span class="line">       <span class="keyword">elseif</span> mo==<span class="number">3</span> <span class="keyword">then</span></span><br><span class="line">        id.setRotationY(bod)</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> xx~=<span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">      id.setPivotX(xx)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">if</span> yy~=<span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">      id.setPivotY(yy)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    vvti.start()</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="comment">--控件id,摆动模式，摆动最大角度，重力值，阻力值，旋转中心点X坐标,旋转中心点Y坐标</span></span><br><span class="line">  振幅动画(tckp,<span class="number">2</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="literal">nil</span>,<span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>              </div>            </details><p>封装的下载弹窗及下载实现功能，需要传入文件夹名字以及网页链接</p><p>这俩参数会通过一个弹窗界面由用户输入，只需要在需要弹出下载框时import本文件即可</p><p>同样不是普遍适用，除保存的位置需要注意外就没啥了</p><p>截取的图片规则仅参考了本项目所用到的网页，对于其他网页可能不是很好用</p><details class="folding-tag" yellow><summary> 批量下载封装downimg </summary>              <div class='content'>              <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> 弹出消息<span class="params">(文本)</span></span></span><br><span class="line">  tcxx=&#123;</span><br><span class="line">    LinearLayout;<span class="comment">--线性布局</span></span><br><span class="line">    orientation=<span class="string">&#x27;vertical&#x27;</span>;<span class="comment">--布局方向</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局高度</span></span><br><span class="line">    &#123;</span><br><span class="line">      CardView;<span class="comment">--卡片控件</span></span><br><span class="line">      layout_width=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--卡片宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--卡片高度</span></span><br><span class="line">      CardBackgroundColor=<span class="string">&#x27;#aaeeeeee&#x27;</span>;<span class="comment">--卡片颜色</span></span><br><span class="line">      elevation=<span class="number">0</span>;<span class="comment">--阴影属性</span></span><br><span class="line">      radius=<span class="string">&#x27;12dp&#x27;</span>;<span class="comment">--卡片圆角</span></span><br><span class="line">      &#123;</span><br><span class="line">        TextView;</span><br><span class="line">        layout_width=<span class="string">&quot;wrap&quot;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">        layout_height=<span class="string">&quot;wrap&quot;</span>;<span class="comment">--布局高度</span></span><br><span class="line">        background=<span class="string">&quot;#cc000000&quot;</span>;<span class="comment">--背景颜色</span></span><br><span class="line">        padding=<span class="string">&quot;8dp&quot;</span>;<span class="comment">--布局填充</span></span><br><span class="line">        textSize=<span class="string">&quot;15sp&quot;</span>;<span class="comment">--文字大小</span></span><br><span class="line">        TextColor=<span class="string">&quot;#ffeeeeee&quot;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">        gravity=<span class="string">&quot;center&quot;</span>;<span class="comment">--布局居中</span></span><br><span class="line">        id=<span class="string">&quot;wenzi&quot;</span>;<span class="comment">--控件ID</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">local</span> toast=Toast.makeText(activity,<span class="string">&quot;文本&quot;</span>,Toast.LENGTH_SHORT).setView(loadlayout(tcxx))</span><br><span class="line">  toast.setGravity(Gravity.BOTTOM,<span class="number">0</span>,<span class="number">120</span>)</span><br><span class="line">  wenzi.Text=<span class="built_in">tostring</span>(<span class="string">&quot;&quot;</span>..文本..<span class="string">&quot;&quot;</span>)</span><br><span class="line">  toast.show()</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">下载弹窗=</span><br><span class="line">&#123;<span class="comment">--布局</span></span><br><span class="line">  LinearLayout;</span><br><span class="line">  orientation=<span class="string">&quot;vertical&quot;</span>;</span><br><span class="line">  Focusable=<span class="literal">true</span>,</span><br><span class="line">  FocusableInTouchMode=<span class="literal">true</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    TextView;<span class="comment">--文本控件</span></span><br><span class="line">    gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">    <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;40dp&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">    textColor=<span class="string">&#x27;#ff51acf6&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">    text=<span class="string">&#x27;下载文件&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">    textSize=<span class="string">&#x27;20&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">    layout_weight=<span class="string">&quot;1.0&quot;</span>;</span><br><span class="line">    layout_marginTop=<span class="string">&quot;fill&quot;</span>;<span class="comment">--边顶</span></span><br><span class="line">  &#125;;</span><br><span class="line">  &#123;</span><br><span class="line">    LinearLayout,<span class="comment">--线性布局</span></span><br><span class="line">    orientation=<span class="string">&#x27;vertical&#x27;</span>,<span class="comment">--方向</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>,<span class="comment">--宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;wrap&#x27;</span>,<span class="comment">--高度</span></span><br><span class="line">    background=<span class="string">&#x27;#00FFFFFF&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">    &#123;</span><br><span class="line">      LinearLayout;</span><br><span class="line">      orientation=<span class="string">&#x27;horizontal&#x27;</span>;<span class="comment">--重力属性</span></span><br><span class="line">      layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;50dp&#x27;</span>;<span class="comment">--布局高度</span></span><br><span class="line">      gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--默认居中</span></span><br><span class="line">      backgroundColor=<span class="string">&quot;#FFFFFFFF&quot;</span>;<span class="comment">--背景色</span></span><br><span class="line">      &#123;</span><br><span class="line">        CardView;<span class="comment">--卡片控件</span></span><br><span class="line">        layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">        layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">        <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">        elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">        layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;12%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">        radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">        &#123;</span><br><span class="line">          CardView;<span class="comment">--卡片控件</span></span><br><span class="line">          layout_margin=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">          layout_gravity=<span class="string">&#x27;center|left&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">          <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">          elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">          layout_width=<span class="string">&#x27;65%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">          layout_height=<span class="string">&#x27;12%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">          CardBackgroundColor=<span class="string">&#x27;#2a000000&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">          radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">          &#123;</span><br><span class="line">            EditText;<span class="comment">--编辑框控件</span></span><br><span class="line">            id=<span class="string">&quot;edit_name&quot;</span>;</span><br><span class="line">            singleLine=<span class="literal">true</span>,<span class="comment">--设置单行输入</span></span><br><span class="line">            layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--编辑框宽度</span></span><br><span class="line">            layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--编辑框高度</span></span><br><span class="line">            textSize=<span class="string">&#x27;12sp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">            hintTextColor=<span class="string">&#x27;#FF7D7D7D&#x27;</span>;<span class="comment">--提示文字颜色</span></span><br><span class="line">            textColor=<span class="string">&#x27;#FF000000&#x27;</span>;<span class="comment">--输入文字的颜色</span></span><br><span class="line">            Hint=<span class="string">&#x27;名称&#x27;</span>;<span class="comment">--设置编辑框为空时的提示文字</span></span><br><span class="line">            background=<span class="string">&#x27;#ffefefef&#x27;</span>;</span><br><span class="line">            layout_marginLeft=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--布局左距</span></span><br><span class="line">            layout_marginRight=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--布局右距</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">    &#123;<span class="comment">--名称</span></span><br><span class="line">      LinearLayout;</span><br><span class="line">      orientation=<span class="string">&#x27;horizontal&#x27;</span>;<span class="comment">--重力属性</span></span><br><span class="line">      layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">      layout_height=<span class="string">&#x27;wrap&#x27;</span>;<span class="comment">--布局高度</span></span><br><span class="line">      gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--默认居中</span></span><br><span class="line">      backgroundColor=<span class="string">&quot;#FFFFFFFF&quot;</span>;<span class="comment">--背景色</span></span><br><span class="line">      &#123;</span><br><span class="line">        CardView;<span class="comment">--卡片控件</span></span><br><span class="line">        layout_marginTop=<span class="string">&#x27;15dp&#x27;</span>;<span class="comment">--顶距</span></span><br><span class="line">        layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">        layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">        <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">        elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">        layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">        layout_height=<span class="string">&#x27;12%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">        CardBackgroundColor=<span class="string">&#x27;0&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">        radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">        &#123;</span><br><span class="line">          CardView;<span class="comment">--卡片控件</span></span><br><span class="line">          layout_margin=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">          layout_gravity=<span class="string">&#x27;center|left&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">          <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">          elevation=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">          layout_width=<span class="string">&#x27;65%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">          layout_height=<span class="string">&#x27;12%w&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">          CardBackgroundColor=<span class="string">&#x27;#2a000000&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">          radius=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">          &#123;</span><br><span class="line">            EditText;<span class="comment">--编辑框控件</span></span><br><span class="line">            id=<span class="string">&quot;edit&quot;</span>;</span><br><span class="line">            singleLine=<span class="literal">true</span>,<span class="comment">--设置单行输入</span></span><br><span class="line">            layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--编辑框宽度</span></span><br><span class="line">            layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--编辑框高度</span></span><br><span class="line">            textSize=<span class="string">&#x27;12sp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">            hintTextColor=<span class="string">&#x27;#FF7D7D7D&#x27;</span>;<span class="comment">--提示文字颜色</span></span><br><span class="line">            textColor=<span class="string">&#x27;#FF000000&#x27;</span>;<span class="comment">--输入文字的颜色</span></span><br><span class="line">            Hint=<span class="string">&#x27;输入完整链接&#x27;</span>;<span class="comment">--设置编辑框为空时的提示文字</span></span><br><span class="line">            background=<span class="string">&#x27;#ffefefef&#x27;</span>;</span><br><span class="line">            layout_marginLeft=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--布局左距</span></span><br><span class="line">            layout_marginRight=<span class="string">&#x27;0dp&#x27;</span>;<span class="comment">--布局右距</span></span><br><span class="line">          &#125;;</span><br><span class="line">        &#125;;</span><br><span class="line">        &#123;</span><br><span class="line">          TextView;<span class="comment">--文本控件</span></span><br><span class="line">          gravity=<span class="string">&#x27;center|right&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">          <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">          layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">          layout_marginRight=<span class="string">&#x27;5%w&#x27;</span>;<span class="comment">--右距</span></span><br><span class="line">          layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">          textColor=<span class="string">&#x27;#eb000000&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">          text=<span class="string">&#x27;http&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">          textSize=<span class="string">&#x27;17dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">          <span class="comment">-- textIsSelectable=true--长按复制</span></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  &#123;</span><br><span class="line">    CardView;<span class="comment">--卡片控件</span></span><br><span class="line">    layout_marginRight=<span class="string">&#x27;6dp&#x27;</span>;<span class="comment">--右距</span></span><br><span class="line">    layout_margin=<span class="string">&#x27;8dp&#x27;</span>;<span class="comment">--边距</span></span><br><span class="line">    elevation=<span class="string">&#x27;1dp&#x27;</span>;<span class="comment">--阴影</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;3dp&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">    CardBackgroundColor=<span class="string">&#x27;#FFDFDFDF&#x27;</span>;<span class="comment">--颜色</span></span><br><span class="line">    radius=<span class="string">&#x27;5dp&#x27;</span>;<span class="comment">--圆角</span></span><br><span class="line">    id=<span class="string">&quot;button&quot;</span>;</span><br><span class="line">    &#123;</span><br><span class="line">      TextView;<span class="comment">--文本控件</span></span><br><span class="line">      <span class="comment">--gravity=&#x27;center&#x27;;--重力</span></span><br><span class="line">      layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--高度</span></span><br><span class="line">      background=<span class="string">&#x27;#FF5B81FE&#x27;</span>,<span class="comment">--背景颜色或图片路径</span></span><br><span class="line">      text=<span class="string">&#x27;&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">      id=<span class="string">&quot;jv&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  &#123;</span><br><span class="line">    LinearLayout;</span><br><span class="line">    orientation=<span class="string">&#x27;horizontal&#x27;</span>;<span class="comment">--重力属性</span></span><br><span class="line">    layout_width=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局宽度</span></span><br><span class="line">    layout_height=<span class="string">&#x27;fill&#x27;</span>;<span class="comment">--布局高度</span></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">      TextView;<span class="comment">--文本控件</span></span><br><span class="line"></span><br><span class="line">      gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">      layout_width=<span class="string">&#x27;43.5%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      textColor=<span class="string">&#x27;#ff51acf6&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">      text=<span class="string">&#x27;取消&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">      textSize=<span class="string">&#x27;15dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">      style=<span class="string">&quot;?android:attr/borderlessButtonStyle&quot;</span>;</span><br><span class="line">      onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        弹窗.dismiss()</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    &#125;;</span><br><span class="line">    &#123;</span><br><span class="line">      TextView;<span class="comment">--文本控件</span></span><br><span class="line">      layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">      layout_width=<span class="string">&#x27;43.5%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      textColor=<span class="string">&#x27;#ff51acf6&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">      text=<span class="string">&#x27;下载&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">      textSize=<span class="string">&#x27;15dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">      style=<span class="string">&quot;?android:attr/borderlessButtonStyle&quot;</span>;</span><br><span class="line">      id=<span class="string">&quot;xuanz2&quot;</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    &#123;</span><br><span class="line">      TextView;<span class="comment">--文本控件</span></span><br><span class="line">      layout_gravity=<span class="string">&#x27;center&#x27;</span>;<span class="comment">--重力</span></span><br><span class="line">      <span class="comment">--左:left 右:right 中:center 顶:top 底:bottom</span></span><br><span class="line">      layout_width=<span class="string">&#x27;43.5%w&#x27;</span>;<span class="comment">--宽度</span></span><br><span class="line">      textColor=<span class="string">&#x27;#ff51acf6&#x27;</span>;<span class="comment">--文字颜色</span></span><br><span class="line">      text=<span class="string">&#x27;完成&#x27;</span>;<span class="comment">--显示文字</span></span><br><span class="line">      textSize=<span class="string">&#x27;15dp&#x27;</span>;<span class="comment">--文字大小</span></span><br><span class="line">      style=<span class="string">&quot;?android:attr/borderlessButtonStyle&quot;</span>;</span><br><span class="line">      id=<span class="string">&quot;wc&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line">弹窗=AlertDialog.Builder(this).setView(loadlayout(下载弹窗)).show()</span><br><span class="line">wc.setVisibility(View.GONE)</span><br><span class="line">loop_tab=&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">down_stop</span><span class="params">(c)</span></span><span class="comment">--总长度</span></span><br><span class="line">  弹出消息(<span class="string">&#x27;文件已保存在/DCIM/meizT/批量下载/下！&#x27;</span>)</span><br><span class="line">  <span class="comment">--dialog1.dismiss()--关闭对话框</span></span><br><span class="line">  xuanz2.setVisibility(View.GONE)</span><br><span class="line">  wc.setVisibility(View.VISIBLE)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">wc.onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--点击事件</span></span><br><span class="line">  弹窗.dismiss()</span><br><span class="line">  wc.setVisibility(View.GONE)</span><br><span class="line">  xuanz2.setVisibility(View.VISIBLE)</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">down_img</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">for</span> s=<span class="number">1</span>,#loop_tab <span class="keyword">do</span></span><br><span class="line">    task(<span class="number">1000</span>,<span class="function"><span class="keyword">function</span><span class="params">()</span></span><span class="comment">--1000毫秒=1秒</span></span><br><span class="line">      xuanz2.setText(s..<span class="string">&quot;/&quot;</span>..#loop_tab)</span><br><span class="line">      <span class="built_in">path</span>=<span class="built_in">tostring</span>(loop_tab[s])</span><br><span class="line">      <span class="comment">--弹出消息(path)</span></span><br><span class="line">      Http.download(<span class="built_in">path</span>,<span class="string">&quot;/sdcard/DCIM/meizT/批量下载/&quot;</span>..edit_name.Text..<span class="string">&quot;/&quot;</span>..<span class="string">&#x27;meizT-&#x27;</span>..s..<span class="string">&quot;.jpg&quot;</span>,<span class="function"><span class="keyword">function</span><span class="params">(a)</span></span></span><br><span class="line">      <span class="keyword">end</span>)</span><br><span class="line">      jv.Width=s/#loop_tab*<span class="number">965</span></span><br><span class="line">      <span class="keyword">if</span> s==#loop_tab <span class="keyword">then</span></span><br><span class="line">        down_stop()</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">down_url</span><span class="params">(url)</span></span></span><br><span class="line">  <span class="comment">--local headers=&#123;[&quot;User-Agent&quot;]=&quot;Mozilla/5.0 (Linux; Android 7.0; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/48.0.2564.116 Mobile Safari/537.36 T7/10.3 SearchCraft/2.6.2 (Baidu; P1 7.0)&quot;&#125;</span></span><br><span class="line">  Http.get(url_d,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="literal">nil</span>,<span class="function"><span class="keyword">function</span><span class="params">(code,content,headers)</span></span></span><br><span class="line">    <span class="keyword">if</span> code==<span class="number">200</span> <span class="keyword">then</span></span><br><span class="line">      import<span class="string">&quot;java.io.File&quot;</span></span><br><span class="line">      <span class="keyword">if</span> File(<span class="string">&quot;/sdcard/DCIM/meizT/批量下载/&quot;</span>..edit_name.Text).exists()</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">        <span class="comment">--文件存在事件</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">        File(<span class="string">&quot;/sdcard/DCIM/meizT/批量下载/&quot;</span>..edit_name.Text).mkdir()<span class="comment">--不存在 则创建</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      loop=content:<span class="built_in">gmatch</span>(<span class="string">[[&lt;img.-src=&quot;(.-)&quot;]]</span>) <span class="comment">--图片截取规则</span></span><br><span class="line">      <span class="keyword">for</span> i <span class="keyword">in</span> loop <span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">string</span>.<span class="built_in">sub</span>(i,<span class="number">0</span>,<span class="number">4</span>)!=<span class="string">&quot;http&quot;</span> <span class="keyword">then</span></span><br><span class="line">          <span class="comment">--string.gsub(i,&quot;http&quot;,&quot;https&quot;)</span></span><br><span class="line">          <span class="built_in">table</span>.<span class="built_in">insert</span>(loop_tab,<span class="string">&quot;http:&quot;</span>..i)</span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">          <span class="built_in">table</span>.<span class="built_in">insert</span>(loop_tab,i)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">      <span class="comment">--弹出消息(#loop_tab)</span></span><br><span class="line">      down_img()</span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">      弹出消息(<span class="string">&quot;链接网站响应失败\n&quot;</span>..url..code)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">xuanz2.onClick=<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">  <span class="keyword">if</span> edit_name.Text!=<span class="literal">nil</span> <span class="keyword">and</span> edit_name.Text!=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">and</span> edit.Text!=<span class="literal">nil</span> <span class="keyword">and</span> edit.Text!=<span class="string">&quot;&quot;</span> <span class="keyword">then</span></span><br><span class="line">    url_d=edit.Text</span><br><span class="line">    down_url(url_d)</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">    弹出消息(<span class="string">&quot;名称不能为空！&quot;</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>              </div>            </details><hr><h2 id="开源文件"><a href="#开源文件" class="headerlink" title="开源文件"></a>开源文件</h2><p>好了，我相信我的朋友一定学废了吧！</p><p>在这里贴出完整的开源项目及APK文件和效果图片</p><p>首页<br><img src="https://tuchuangs.com/imgs/2022/02/f8351c874d810cbf.jpg" alt=""></p><p>加载页及单图下载（有动画）<br><img src="https://tuchuangs.com/imgs/2022/02/251bd0a7fea8a32a.jpg" alt=""></p><p>下载<br><img src="https://tuchuangs.com/imgs/2022/02/bf6ec88d4cc06c21.jpg" alt=""></p><div class="note purple no-icon flat"><p><a href="https://nrhs.lanzoul.com/ikhuMzxngxa">开源文件.alp</a></p></div>]]></content>
    
    
    <summary type="html">我有一个朋友，他非常好学。于是我大喊了一声“拿瓦！”帮他实现了梦想&lt;( ￣^￣)不准色色！</summary>
    
    
    
    <category term="食用指南" scheme="https://nrhs-space.github.io/categories/%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    
    
    <category term="自动化" scheme="https://nrhs-space.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    <category term="lua" scheme="https://nrhs-space.github.io/tags/lua/"/>
    
  </entry>
  
  <entry>
    <title>我的二十</title>
    <link href="https://nrhs-space.github.io/2022/01/28/Ever-Growth/"/>
    <id>https://nrhs-space.github.io/2022/01/28/Ever-Growth/</id>
    <published>2022-01-28T15:13:49.000Z</published>
    <updated>2022-02-22T09:19:32.217Z</updated>
    
    <content type="html"><![CDATA[<p>我二十岁了。</p><p>不可想象但又不可否认，我已经走完了20年，7300天，人生五分之一的旅程。</p><p>我很想写一点文字来告慰我这20年的路程，但又不知从何谈起。</p><p>这20年我同大部分人一样规规矩矩的走完。同所有好孩子一般，没有犯过什么大的错误，当然也没有干出过什么傲人的成绩。</p><p>我同所有母亲的孩子一样，是母亲的骄傲，父亲的无奈。我记得小时候似乎一二三年级的楼梯永远爬不完。但那个时候的我还没有料到过加速的人生即将来临。</p><p>母亲头上的青丝日渐白斑，我才发现我这20年的前18年我都过着千篇一律的生活。直到我的父亲病倒，我生活的幻影才轰然倒塌。</p><p>我一直很敬佩两个人。</p><p>一个是我的母亲，一个是我的爷爷。</p><p>我的母亲常常告诉我她年轻的时候爷爷对她和父亲有多么苛刻，我的爷爷也常告诉我他年轻时母亲如何如何奸诈……但这些都无从考证，同中国大多数的婆媳关系一样，我的母亲和我的爷爷中间存在着不可调和但又深藏不露的隔阂。</p><p>从我记事起，我的爷爷对于我就是疼爱有加，但这被解析成重男轻女可能更加恰当。因为我的姐姐与我的待遇截然不同，但我不可改变。</p><p>和大多数留守儿童一样，我跟随我的爷爷从小学生活到大学，他耗尽了他的后半辈子终于将我送入大学。他是我最值得感恩的人。</p><p>对于我的母亲我最大的印象就是节俭，以近乎苛刻的条件节俭。如果她肯连同我一起节俭，我倒也心安理得，但我的母亲却将所有的偏爱与溺爱集中于我，但对自己与姐姐苛刻的节俭。我难以接受。</p><p>我不能心安理得的享受母亲的溺爱，但还好，我与母亲的见面几乎只集中在寒暑假，我可以尽快的逃离爱的漩涡。</p><p>我很少提起我的父亲，对于我来说，他就像一个模糊的幻影。</p><p>2019年，我的父亲急诊入院。</p><p>出院后他变成了一个连他最为溺爱与恨铁不成钢的儿子都不认识的人。</p><p>当我终于从高三的手掌中找出一点时间回去时，父亲茫然的从我与母亲的身旁走过。他指着我问母亲我是谁。</p><p>在那一刻，我才发现母亲的白发已经遮不住了，爷爷的腰也弯了下去。我习惯在数学下藏手机，在英语下面藏杂志，我甚至练就了一个从步伐判断谁回家来了的绝技……</p><p>但当我终于肯往真题册中撇一眼时，我才发现，我大多已经看不懂了。</p><p>我是一个差生。侥幸考入高中，便在高中的深渊里越陷越深。</p><p>在高考结束后，父亲恢复得比较好了，他又恢复了以往的精神，只是语言能力受到了不可逆转的损伤，他再也不能准确的描述我了。但没关系，母亲总能准确的猜到他的意思。我也在最后的一年里从332分拉到了437分。虽然仍然是专科，但我已知足了。</p><p>似乎一切事物都在向着美好的方向发展，但也发现，意外和明天你永远不知道谁先到来。</p><p>大一暑假，我父亲再次病倒。我在四个医院签了三份病危通知书。</p><p>往往是在一个更糟的处境时，才会觉得以往的逆境不值一提。我又想起《落难的王子》，其实厄运无论落到谁的头上，谁都得受着，且受得了。</p><p>我很难描述我的父亲究竟改变了我什么。</p><p>从一方面讲，他是我最为烦恼的人。我讨厌他的粗暴，讨厌他的没文化，讨厌他天天念叨我读书读书……似乎他在我前18年充当的就是一个粗暴的复读机。</p><p>如果可以，我最想离开的就是他。</p><p>但从另一方面，他是我人生最大的分歧口。很多事情，必须经历才能学会。</p><p>最后辗转到一个医院时，医生的话里话外都暗示着准备后事的意思。</p><p>我曾一度认为我在经过高三那段医院的通宵学习后已经长大，但事实证明那个长大不值一提。我又开始重新在生活中寻找长大。我疯疯癫癫的父亲终于回到了他的家，他冲着我与母亲大打出手，将家里打砸一空。</p><p>母亲从来不在我们几个孩子面前哭泣。不管是在父亲病危之际还是在每天一万的医药费时，母亲都没有哭泣过，她不停的告诉我，她来想办法。</p><p>我的爷爷还是告诉我，母亲在挂断我的电话后打电话给他，哭着问他怎么办……</p><p>母亲对于我们来说，她是大人，她不能哭。她要承担这一切。而对于爷爷，她是个孩子，在面对如此沉重的事情时，她也难以承受。而爷爷，他只能独自承担了……</p><p>父辈永远是我们的依靠。我想，成长的意义大概就是成为他人依靠的对象吧。</p><p>我们总是许愿说要快乐，但快乐到底是什么呢？我这迷茫又焦虑的二十岁啊。</p><p>我还在寻找自己的路上。唯一值得庆幸的是，时间会抚平所有痛苦与快乐。而我，在窥见了一丝生活的黑暗后还有机会去改变。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;我二十岁了。&lt;/p&gt;
&lt;p&gt;不可想象但又不可否认，我已经走完了20年，7300天，人生五分之一的旅程。&lt;/p&gt;
&lt;p&gt;我很想写一点文字来告慰我这20年的路程，但又不知从何谈起。&lt;/p&gt;
&lt;p&gt;这20年我同大部分人一样规规矩矩的走完。同所有好孩子一般，没有犯过什么大的错误，当</summary>
      
    
    
    
    <category term="城南旧事" scheme="https://nrhs-space.github.io/categories/%E5%9F%8E%E5%8D%97%E6%97%A7%E4%BA%8B/"/>
    
    
    <category term="城南旧事" scheme="https://nrhs-space.github.io/tags/%E5%9F%8E%E5%8D%97%E6%97%A7%E4%BA%8B/"/>
    
  </entry>
  
  <entry>
    <title>三体...嘿嘿❤我的三体</title>
    <link href="https://nrhs-space.github.io/2022/01/24/ETO-threebody/"/>
    <id>https://nrhs-space.github.io/2022/01/24/ETO-threebody/</id>
    <published>2022-01-24T06:52:47.000Z</published>
    <updated>2022-01-24T06:52:54.000Z</updated>
    
    <content type="html"><![CDATA[<iframe src="//player.bilibili.com/player.html?aid=2910036&bvid=BV1qs41117Po&cid=4549722&page=1" scrolling="no" border="0" width="100%" height=500 frameborder="no" framespacing="0" allowfullscreen="true"> </iframe><hr><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img" src='https://s4.ax1x.com/2022/01/24/7osSPI.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">三体PV</div>  <p>听说快鸽好了，艺画开天质量真不错</p>  <a href='https://www.bilibili.com/bangumi/play/ss26257/?from=search&seid=8655174147407567938&spm_id_from=333.337.0.0'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img" src='https://img2.baidu.com/it/u=1357792673,1440116125&fm=253&fmt=auto&app=120&f=JPEG' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">我的三体</div>  <p>神游八方才是真正的业界标杆！</p>  <a href='https://space.bilibili.com/614801/?spm_id_from=666.25.b_6d656469615f6d6f64756c65.5'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img" src='https://img2.baidu.com/it/u=88135980,4235227397&fm=253&fmt=auto&app=138&f=JPEG?w=440&h=241' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">三体广播剧</div>  <p>喜马拉雅出品，最震撼的一个版本</p>  <a href='http://www.yedushu.com/yefm/ting/30816438'></a>  </figcaption>  </figure>    <figure class="gallery-group">  <img class="gallery-group-img" src='https://s4.ax1x.com/2022/01/24/7ogifs.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">三体-热爱</div>  <p>无意中输入了一个网址，居然发现了这个三体迷制作的网站</p>  <a href='https://threebody.space/'></a>  </figcaption>  </figure>  </div><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="100%" height=86 src="//music.163.com/outchain/player?type=2&id=1431292823&auto=0&height=66"></iframe><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>三体舰队抵达地球进度</p></div></div>]]></content>
    
    
    <summary type="html">消灭人类暴政，世界属于三体！</summary>
    
    
    
    <category term="三体" scheme="https://nrhs-space.github.io/categories/%E4%B8%89%E4%BD%93/"/>
    
    
    <category term="ETO" scheme="https://nrhs-space.github.io/tags/ETO/"/>
    
    <category term="三体" scheme="https://nrhs-space.github.io/tags/%E4%B8%89%E4%BD%93/"/>
    
  </entry>
  
  <entry>
    <title>基于Selenium实现python浏览器自动化</title>
    <link href="https://nrhs-space.github.io/2022/01/23/EG-webdriver_py/"/>
    <id>https://nrhs-space.github.io/2022/01/23/EG-webdriver_py/</id>
    <published>2022-01-23T02:35:51.000Z</published>
    <updated>2022-01-23T02:35:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>一个活动非得让我拉几百人个人填表单，无奈。</p><p>找了一半天脚本找不到，想通过油猴来完成这个浏览器操作。但是却发现表单限制，记录浏览器记录，只能填一次:-)</p><p>于是决定通过python的<code>Selenium</code>库来实现浏览器操作，同时模拟出500个用户信息。</p><h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><details class="folding-tag" cyan><summary> 环境已配置好请忽略 </summary>              <div class='content'>              <p>关于Selenium库的安装及环境配置请参照<a href="https://blog.csdn.net/weixin_36279318/article/details/79475388">Python Selenium库的使用</a>文章</p><p>需要注意一下几点<del>坑了我好久</del>:</p><ol><li><p>下载Selenium驱动程序时请在:<a href="https://chromedriver.storage.googleapis.com/index.html">这里</a>下载与你<code>Chromium</code>内核<u>版本一致</u>的驱动程序。</p><ul><li>若你是其他浏览器或者系统，请参照<a href="https://github.com/SeleniumHQ/selenium">官方Github仓库</a>，<a href="http://www.selenium.org.cn/">Selenium官网</a>。</li></ul></li><li><p>下载的驱动程序包需要放置在你的浏览器exe文件<u>同一目录</u>下</p></li><li><p>配置环境变量时名称应填<code>chromedriver</code>，值应填写到该目录下。</p><ul><li>也可python中指定<code>chromedriver</code>路径，只有当py中没有指定路径时才会去环境变量中去搜<code>Chromium</code>的路径。</li></ul></li></ol><p><div class="note no-icon flat"><p>测试配置</p></div><br>在配置完成后python执行:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome(<span class="string">&quot;&quot;</span>)<span class="comment"># 指定chromedriver路径，例如我的&quot;D:\Desktop\web\chromedriver.exe&quot;</span></span><br><span class="line">driver.get(<span class="string">&quot;https://nrhs-space.github.io/&quot;</span>)  <span class="comment"># 地址栏里输入网址</span></span><br></pre></td></tr></table></figure></p><p>不出意外的话会打开一个新窗口，打开我的博客页面。</p><p><div class="note no-icon flat"><p>测试操作</p></div><br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">driver = webdriver.Chrome(<span class="string">&quot;&quot;</span>)<span class="comment"># 指定chromedriver路径，例如我的&quot;D:\Desktop\web\chromedriver.exe&quot;</span></span><br><span class="line">driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)  <span class="comment"># 地址栏里输入网址</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>).send_keys(<span class="string">&quot;三体&quot;</span>)  <span class="comment"># 搜索框输入三体</span></span><br><span class="line">driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;su&quot;]&#x27;</span>).click()  <span class="comment"># 点击百度一下按钮</span></span><br></pre></td></tr></table></figure></p><p>不出意外的话会打开一个新浏览器窗口，并且打开百度搜索”三体”。</p><blockquote><p>到这里一切正常就代表成功搭建了环境。</p></blockquote>              </div>            </details><h1 id="执行操作"><a href="#执行操作" class="headerlink" title="执行操作"></a>执行操作</h1><p>打开页面，使用开发者工具定位到选项标签。复制<code>Xpath</code>下来。<br><img src="https://s4.ax1x.com/2022/01/23/74NRhQ.jpg" alt=""></p><p>selenium有多种定位的方法，详情见<a href="https://blog.csdn.net/weixin_36279318/article/details/79475388">CDSDN博客</a>。</p><p>一般我们使用的就是<kbd>find_element_by_xpath</kbd>或者<kbd>find_element_by_name</kbd>,<kbd>find_element_by_id</kbd></p><p>即通过路径表达式，name和id</p><p>在这里我们使用xpath找到标签，进行点击操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">Brower = webdriver.Chrome(<span class="string">&quot;D:\Desktop\web\chromedriver.exe&quot;</span>)</span><br><span class="line">Brower.get(<span class="string">&#x27;url...&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>) <span class="comment"># 延时</span></span><br><span class="line">Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[4]/div/div/div[2]/div[1]/div/span/div/div[1]/div/div/label&#x27;</span>).click()</span><br></pre></td></tr></table></figure><p>运行代码，不出意外的话就会自动点击了</p><details class="folding-tag" cyan><summary> 不出意外的话就会出意外 </summary>              <div class='content'>              <p>有时候你会发现get出了页面，但没有点击操作。这个时候或许可以:</p><ol><li>检查xpath是否正确，可以尝试定位到该元素的父标签上</li><li>chromedriver驱动程序版本是否与你内核版本一致。</li><li>尝试x+1次</li></ol>              </div>            </details><p>有5道题目，我们对其进行5次点击操作</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">Brower = webdriver.Chrome(<span class="string">&quot;D:\Desktop\web\chromedriver.exe&quot;</span>)</span><br><span class="line"></span><br><span class="line">Brower.get(<span class="string">&#x27;...&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[4]/div/div/div[2]/div[1]/div/span/div/div[1]/div/div/label&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[6]/div/div/div[2]/div[1]/div/span/div/div[2]/div/div/label&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[8]/div/div/div[2]/div[1]/div/span/div/div[3]/div/div/label&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[10]/div/div/div[2]/div[1]/div/span/div/div[1]/div/div/label&#x27;</span>).click()</span><br><span class="line"></span><br><span class="line">Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[12]/div/div/div[2]/div[1]/div/span/div/div[1]/div/div/label&#x27;</span>).click()</span><br></pre></td></tr></table></figure><p><img src="https://s4.ax1x.com/2022/01/23/74aRQs.jpg" alt=""></p><p>可以看见其中的<kbd>[]</kbd>内容控制了选项与题目。不出意外的话你的5道题目应该已经选好了。</p><p>使用<code>name</code>定位点击下一页</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brower.find_element_by_class_name(<span class="string">&#x27;published-form__footer&#x27;</span>).click()</span><br></pre></td></tr></table></figure><blockquote><p>填充文本</p></blockquote><p><img src="https://s4.ax1x.com/2022/01/23/74dX9g.jpg" alt=""></p><p>在<code>input</code>中需要我们填写姓名，学校，电话等内容</p><p>这里使用<code>name</code>获取到<code>input</code>后<code>send_keys</code>填充内容</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brower.find_element_by_name(<span class="string">&#x27;field_16&#x27;</span>).send_keys(<span class="string">&quot;霍格沃茨&quot;</span>)</span><br></pre></td></tr></table></figure><p>然后我们用点击<kbd>下一页</kbd>的方法点击提交即可</p><blockquote><p>关闭浏览器</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brower.close()</span><br></pre></td></tr></table></figure><p>最后贴一下我简单的代码<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># post提交，生成500个姓名</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;xing&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;xinglength&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;minglength&#x27;</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;sex&#x27;</span>: <span class="string">&#x27;all&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dic&#x27;</span>: <span class="string">&#x27;gudai&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;num&#x27;</span>: <span class="string">&#x27;500&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line">xm = requests.post(<span class="string">&quot;https://www.qmsjmfb.com/&quot;</span>, data)</span><br><span class="line">data2 = re.findall(<span class="string">r&#x27;&lt;li&gt;(.+?)&lt;/li&gt;&#x27;</span>, xm.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机数生成500个电话号码</span></span><br><span class="line">list_1 = [<span class="string">&quot;134&quot;</span>, <span class="string">&quot;135&quot;</span>, <span class="string">&quot;136&quot;</span>, <span class="string">&quot;137&quot;</span>, <span class="string">&quot;138&quot;</span>, <span class="string">&quot;139&quot;</span>, <span class="string">&quot;147&quot;</span>, <span class="string">&quot;150&quot;</span>, <span class="string">&quot;151&quot;</span>, <span class="string">&quot;152&quot;</span>, <span class="string">&quot;157&quot;</span>, <span class="string">&quot;158&quot;</span>, <span class="string">&quot;159&quot;</span>, <span class="string">&quot;172&quot;</span>, <span class="string">&quot;178&quot;</span>,</span><br><span class="line">          <span class="string">&quot;182&quot;</span>, <span class="string">&quot;183&quot;</span>, <span class="string">&quot;184&quot;</span>, <span class="string">&quot;187&quot;</span>, <span class="string">&quot;188&quot;</span>, <span class="string">&quot;198&quot;</span>]  <span class="comment"># 中国移动号码段</span></span><br><span class="line">list_2 = [<span class="string">&quot;130&quot;</span>, <span class="string">&quot;131&quot;</span>, <span class="string">&quot;132&quot;</span>, <span class="string">&quot;145&quot;</span>, <span class="string">&quot;155&quot;</span>, <span class="string">&quot;156&quot;</span>, <span class="string">&quot;166&quot;</span>, <span class="string">&quot;171&quot;</span>, <span class="string">&quot;175&quot;</span>, <span class="string">&quot;176&quot;</span>, <span class="string">&quot;185&quot;</span>, <span class="string">&quot;186&quot;</span>]  <span class="comment"># 中国联通号码段</span></span><br><span class="line">list_3 = [<span class="string">&quot;133&quot;</span>, <span class="string">&quot;149&quot;</span>, <span class="string">&quot;153&quot;</span>, <span class="string">&quot;173&quot;</span>, <span class="string">&quot;177&quot;</span>, <span class="string">&quot;180&quot;</span>, <span class="string">&quot;181&quot;</span>, <span class="string">&quot;189&quot;</span>, <span class="string">&quot;191&quot;</span>, <span class="string">&quot;199&quot;</span>, <span class="string">&quot;193&quot;</span>]  <span class="comment"># 中国电信号码段</span></span><br><span class="line">num = [<span class="string">&quot;0&quot;</span>, <span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>, <span class="string">&quot;4&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;6&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;8&quot;</span>, <span class="string">&quot;9&quot;</span>]  <span class="comment"># 存放0-9数字，号码的4-11位从这里取</span></span><br><span class="line"></span><br><span class="line">phone_all = <span class="built_in">list</span>()  <span class="comment"># 存放所有生成的电话号码</span></span><br><span class="line"></span><br><span class="line">phone_output = <span class="built_in">list</span>() <span class="comment"># 存放去重后的电话号码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_phone</span>(<span class="params">count, choice</span>): <span class="comment"># 参数1为生成号码的个数，参数2为运营商选择</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        phone = random.choice(choice) + <span class="string">&quot;&quot;</span>.join(random.choice(num) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>))  <span class="comment">#使用random函数生成电话号码</span></span><br><span class="line">        <span class="keyword">if</span> phone <span class="keyword">not</span> <span class="keyword">in</span> phone_all:  <span class="comment"># 判断该电话号码是不是出现过</span></span><br><span class="line">            phone_output.append(phone)  <span class="comment"># 没出现则放到phone_output</span></span><br><span class="line">        phone_all.append(phone) <span class="comment"># 把生成的每个号码都存起来，用去去重比对</span></span><br><span class="line">    <span class="built_in">print</span>(phone_output)  <span class="comment"># 打印去重后的电话</span></span><br><span class="line">    </span><br><span class="line">create_phone(<span class="number">500</span>, list_3) <span class="comment">#调用函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取学校名单txt文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;002.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    xx=f.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环提交</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">      Brower = webdriver.Chrome(<span class="string">&quot;D:\Desktop\web\chromedriver.exe&quot;</span>)</span><br><span class="line">      Brower.get(<span class="string">&#x27;url...&#x27;</span>)</span><br><span class="line">      time.sleep(<span class="number">3</span>) <span class="comment"># 延时操作</span></span><br><span class="line">      Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[4]/div/div/div[2]/div[1]/div/span/div/div[&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1</span>,<span class="number">3</span>))+<span class="string">&#x27;]/div/div/label&#x27;</span>).click() <span class="comment"># 随机选择一个选项</span></span><br><span class="line">      Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[6]/div/div/div[2]/div[1]/div/span/div/div[&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1</span>,<span class="number">3</span>))+<span class="string">&#x27;]/div/div/label&#x27;</span>).click()</span><br><span class="line">      Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[8]/div/div/div[2]/div[1]/div/span/div/div[&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1</span>,<span class="number">3</span>))+<span class="string">&#x27;]/div/div/label&#x27;</span>).click()</span><br><span class="line">      Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[10]/div/div/div[2]/div[1]/div/span/div/div[&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1</span>,<span class="number">3</span>))+<span class="string">&#x27;]/div/div/label&#x27;</span>).click()</span><br><span class="line">      Brower.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;root&quot;]/div/form/div[3]/div/div[12]/div/div/div[2]/div[1]/div/span/div/div[&#x27;</span>+<span class="built_in">str</span>(random.randint(<span class="number">1</span>,<span class="number">3</span>))+<span class="string">&#x27;]/div/div/label&#x27;</span>).click()</span><br><span class="line">      time.sleep(random.randint(<span class="number">3</span>,<span class="number">6</span>)) <span class="comment"># 随机延时几秒</span></span><br><span class="line">      Brower.find_element_by_class_name(<span class="string">&#x27;published-form__footer&#x27;</span>).click()</span><br><span class="line">      <span class="comment">#------------------------------</span></span><br><span class="line">      time.sleep(random.randint(<span class="number">6</span>,<span class="number">10</span>))<span class="comment"># 随机延时几秒</span></span><br><span class="line">      Brower.find_element_by_name(<span class="string">&#x27;field_15&#x27;</span>).send_keys(data2[<span class="number">200</span>+i])<span class="comment">#xm</span></span><br><span class="line">      Brower.find_element_by_name(<span class="string">&#x27;field_16&#x27;</span>).send_keys(xx[i])<span class="comment">#xx</span></span><br><span class="line">      Brower.find_element_by_name(<span class="string">&#x27;field_17&#x27;</span>).send_keys(phone_output[i])<span class="comment">#dh</span></span><br><span class="line">      Brower.find_element_by_class_name(<span class="string">&#x27;published-form__submit&#x27;</span>).click()</span><br><span class="line">      Brower.close() <span class="comment"># 关闭浏览器</span></span><br><span class="line">      <span class="built_in">print</span>(<span class="string">&quot;已完成:&quot;</span>, i, <span class="string">&quot;次&quot;</span>)</span><br></pre></td></tr></table></figure></p><p><img src="https://s4.ax1x.com/2022/01/23/74hF1I.jpg" alt=""></p><div class="tip ban"><p>此为学习自动化操作笔记，完成一些不重要的指标要求。谴责恶意刷题行为！</p></div>]]></content>
    
    
    <summary type="html">什么？学校活动要让我拉500个人填表单？看我py大法——叮~你已经邀请，500人~</summary>
    
    
    
    <category term="食用指南" scheme="https://nrhs-space.github.io/categories/%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    
    
    <category term="自动化" scheme="https://nrhs-space.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
    
    <category term="Python" scheme="https://nrhs-space.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>记录一次被迫参赛CTF</title>
    <link href="https://nrhs-space.github.io/2022/01/21/CTF-encode/"/>
    <id>https://nrhs-space.github.io/2022/01/21/CTF-encode/</id>
    <published>2022-01-21T04:29:39.000Z</published>
    <updated>2022-01-23T09:35:15.460Z</updated>
    
    <content type="html"><![CDATA[<p>在<a href="https://bbs.tampermonkey.net.cn/">油猴中文网</a>白嫖时发现了一个帖子:<a href="https://bbs.tampermonkey.net.cn/forum.php?mod=viewthread&amp;tid=1574&amp;highlight=Vue">超赞的Vue模板</a></p><p>正好这段时间在学习Vue这个框架。看看了预览，很好康，但是购买需要<span class='p red'>$40</span>。</p><p>我们肯定要<del>支持正版</del>，先上车再买票[滑稽]。而楼主也贴心的为我们这些白嫖怪附上了网盘下载链接。</p><p>但是，楼主对它设了密码。</p><div class="note no-icon flat"><p>楼主的提示</p></div><p><img src="https://s4.ax1x.com/2022/01/20/7g9BjJ.jpg" alt=""></p><p>楼主贴心的告诉了我们一个神秘密码</p><div class="tip key"><p>==DCbTWQ</p></div><p>同时告诉我们加密过程:</p><ol><li>对原密码进行编码</li><li>对编码后的密码进行了一个<u>关于顺序</u>的加密</li><li>对<u>关于顺序</u>的加密后进行了一个<u>关于ASCII码</u>的加密</li></ol><p>最后就得出了<kbd>==DCbTWQ</kbd></p><p>且原密码是一个<kbd>3位数字</kbd>+<kbd>1个字母</kbd></p><hr><div class="tabs" id="test"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test-1">MISC选手的自我修养</button></li><li class="tab"><button type="button" data-href="#test-2">Web选手的自我修养</button></li><li class="tab"><button type="button" data-href="#test-3">拿来主义</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test-1"><p>分析一下，加密步骤我们已明确。那么我们解密就应该逆序操作:</p><div class="note warning no-icon flat"><p>还原<u>关于ASCII码</u>的加密</p></div><p>关于ASCII的加密很多，包括Unicode=&gt;ASCII,UTF=&gt;ASCII等等…</p><p>我们利用<a href="http://www.hiencode.com/cencode.html">ASCII在线转换</a>可以粗略的看看有哪些常见加密<br><img src="https://s4.ax1x.com/2022/01/21/72lcRg.jpg" alt=""><br>可能<code>==DCbTWQ</code>是由以上编码转换而来的。我们分别尝试解码上述编码，你会发现，答案有很多，但没有一个是对的。</p><p>这里<u>关于ASCII码</u>的加密指的是<a href="https://baike.baidu.com/item/%E6%81%BA%E6%92%92%E5%AF%86%E7%A0%81/4905284?fr=aladdin">凯撒加密</a>。我们将<code>==DCbTWQ</code>进行凯撒解密</p><details class="folding-tag" cyan><summary> 原因猜测 </summary>              <div class='content'>              <p>至于为什么不是Unicode这些而是凯撒加密，凯撒加密可以去搜一下。它其实是将加密的每一个字符都推移了x位，而这个和ASCII码也有这千丝万缕的联系。</p><p>其实更重要的是，从题目的两个<kbd>==</kbd>号来看，几乎可以肯定使用了base64编码。而base64编码过后，进行了一个<u>逆序</u>加密后再进行一次加密后的字符居然还跟base64编码长得非常相似。</p><p>而凯撒加密只是偏移了每个字符的位数，添加到ASCII码上，跟原数据非常相似。</p>              </div>            </details><p>解密会得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">凯撒Caesar解码:</span><br><span class="line">key #0: ==DCbTWQ</span><br><span class="line">key #1: ==CBaSVP</span><br><span class="line">key #2: ==BAzRUO</span><br><span class="line">key #3: ==AZyQTN</span><br><span class="line">key #4: ==ZYxPSM</span><br><span class="line">key #5: ==YXwORL</span><br><span class="line">key #6: ==XWvNQK</span><br><span class="line">key #7: ==WVuMPJ</span><br><span class="line">key #8: ==VUtLOI</span><br><span class="line">key #9: ==UTsKNH</span><br><span class="line">key #10: ==TSrJMG</span><br><span class="line">key #11: ==SRqILF</span><br><span class="line">key #12: ==RQpHKE</span><br><span class="line">key #13: ==QPoGJD</span><br><span class="line">key #14: ==POnFIC</span><br><span class="line">key #15: ==ONmEHB</span><br><span class="line">key #16: ==NMlDGA</span><br><span class="line">key #17: ==MLkCFZ</span><br><span class="line">key #18: ==LKjBEY</span><br><span class="line">key #19: ==KJiADX</span><br><span class="line">key #20: ==JIhZCW</span><br><span class="line">key #21: ==IHgYBV</span><br><span class="line">key #22: ==HGfXAU</span><br><span class="line">key #23: ==GFeWZT</span><br><span class="line">key #24: ==FEdVYS</span><br><span class="line">key #25: ==EDcUXR</span><br></pre></td></tr></table></figure><p>有很多，我们暂且不管，我们来看看<u>关于顺序</u>的加密。</p><p>我原来一直认为<u>关于顺序</u>的加密是凯撒加密，但是很好奇为什么两个<kbd>==</kbd>号会在最前面。</p><p>只有两个<kbd>==</kbd>号在字符串后时才能解码出有意义的内容。我们<del>尝试x+1次后</del>猜测它的<u>关于顺序</u>的加密其实就是逆序输出了</p><div class="note warning no-icon flat"><p>还原<u>关于顺序</u>的加密</p></div><p>写一个小python脚本，在解码base64前先逆序过来：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> xlrd <span class="keyword">as</span> xd</span><br><span class="line">data =xd.open_workbook (<span class="string">&quot;D:\Desktop\mi.xls&quot;</span>) <span class="comment">#读取excel表</span></span><br><span class="line">sheet = data.sheet_by_name(<span class="string">&#x27;Sheet1&#x27;</span>)  <span class="comment">#读取表单一数据</span></span><br><span class="line">body = []</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(sheet.nrows): <span class="comment">#开始遍历每一行数据</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(sheet.ncols):</span><br><span class="line">        tab=sheet.cell_value(r,c)</span><br><span class="line">    body.append(tab) <span class="comment">#添加到待解密列表</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n已读取&quot;</span>, <span class="built_in">list</span>(body)[<span class="number">0</span>],<span class="string">&quot;等&quot;</span>, <span class="built_in">len</span>(body), <span class="string">&quot;参数&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逆序输出函数：</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">strReverse</span>(<span class="params">strDemo</span>):</span><br><span class="line">    <span class="keyword">return</span> strDemo[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逆序解码所有base64编码：</span></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(body)):</span><br><span class="line">    f=strReverse(body[v])</span><br><span class="line">    de64=base64.b64decode(f+<span class="string">&quot;==&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;【&quot;</span>,de64,<span class="string">&quot;】&quot;</span>) <span class="comment">#输出解码结果</span></span><br></pre></td></tr></table></figure><p>这里我是将所有凯撒解密的结果去掉==后放在了mi.xls文件第一列中，python遍历逆序解码它们。</p><p><img src="https://s4.ax1x.com/2022/01/21/72BACd.jpg" alt=""></p><p>在这里我们就发现了符合<kbd>3数字+1字母</kbd>的解密结果，即为访问密码。</p><p>看文章很快，很轻松。可是，我在里面的尝试，花了一下午。其中走了很多弯路，还是我想得太多。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test-2"><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/From-%E6%9E%97%E5%A4%95-orange?logo=&color=orange&link=&"></object><p>告诉了我们密码长度以及组合，爆破手准备！</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">1000</span>):</span><br><span class="line">    a=<span class="string">&quot;%03d&quot;</span> % i <span class="comment"># 位数填充</span></span><br><span class="line">    <span class="keyword">for</span> q <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">        d=<span class="built_in">chr</span>(q+<span class="number">97</span>)</span><br><span class="line">        data = &#123;</span><br><span class="line">          <span class="string">&#x27;action&#x27;</span>: <span class="string">&#x27;downprocess&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;sign&#x27;</span>: <span class="string">&#x27;...&#x27;</span>,</span><br><span class="line">          <span class="string">&#x27;p&#x27;</span>: a+d</span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.post(<span class="string">&#x27;https://taozhiyu.lanzouq.com/ajaxm.php&#x27;</span>, headers=headers, data=data)</span><br><span class="line">        <span class="comment">#print(response.text,a+d)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(response.content)==<span class="number">95</span>: <span class="comment">#密码错误时长度可能有变，请依据自己的更改</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;密码错误&#x27;</span>,a+d)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(response.text,a+d)</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><div class="tip error"><p>我们不建议使用这种方法，这可能对蓝奏云造成不必要的请求，只是表明有这个思路。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test-3"><p><img src="https://s4.ax1x.com/2022/01/21/72wx0S.jpg" alt=""></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>应楼主要求，也是不能直接把答案告诉你呢~</p><p>不过我几乎已经告诉你密码怎么来了。好了，慢慢玩趴~</p>]]></content>
    
    
    <summary type="html">在油猴中文网白嫖时发现了超赞的Vue模板，购买需要40美刀。楼主贴心为我们准备了白嫖资源，同时贴心的为它加了密...</summary>
    
    
    
    <category term="CTF" scheme="https://nrhs-space.github.io/categories/CTF/"/>
    
    
    <category term="CTF" scheme="https://nrhs-space.github.io/tags/CTF/"/>
    
    <category term="蓝色空间" scheme="https://nrhs-space.github.io/tags/%E8%93%9D%E8%89%B2%E7%A9%BA%E9%97%B4/"/>
    
  </entry>
  
</feed>
